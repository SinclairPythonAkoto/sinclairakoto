define("Models/Component",[],function(){return function(){this.componentConfig=null,this.type=null,this.elementId=null,this.element=null,this.useComponentTemplate=!1,this.data=null,this.state=void 0,this.setComponentConfig=function(e){this.componentConfig=void 0!==e?e:null},this.setType=function(e){this.type=void 0!==e?e:null},this.setElementId=function(e){this.elementId=void 0!==e?e:this.type,this.element=document.getElementById(this.elementId)},this.setUseComponentTemplate=function(e){e=void 0===e?!0:e,this.useComponentTemplate="boolean"==typeof e?e:!0},this.setData=function(e){this.data=void 0!==e?e:null},this.setState=function(e){this.state=void 0!==e?e:this.state},this.getComponentPath=function(){return null!==this.type?"Components/"+this.type+"/"+this.type:null},this.getElement=function(){return this.element},this.getDictionary=function(){if(!this.element||!this.element.hasAttribute("dictionary"))return null;try{return JSON.parse(this.element.getAttribute("dictionary"))}catch(e){return null}},this.getComponentConfig=function(){return!this.useComponentTemplate&&this.element&&(this.componentConfig.template={element:this.element}),this.componentConfig}}}),define("ProductUtils/ComponentLoader",["ko","Models/Component"],function(e,t){return function(){this.register=function(i,n,r){var s=new t;return s.setType(i.type),s.setElementId(i.elementId),s.setData(n),s.setState(r),s.setUseComponentTemplate(i.useComponentTemplate),require([s.getComponentPath()],function(t){s.setComponentConfig(t),e.components.register(i.name,s.getComponentConfig()),(null!==s.getElement()||s.getElement()!=={})&&e.applyBindingsToNode(s.getElement(),{component:{name:i.name,params:{dictionary:s.getDictionary(),data:s.data,state:s.state}}})}),s},this.unregister=function(t){t&&0!==t.length&&e.components.isRegistered(t)&&e.components.unregister(t)}}}),define("videoPlayerView",[],function(){return'<div class="asos-media-players">\n    <div class="amp-video-player amp-relative">\n        <video class="amp-page amp-video-element" data-bind="foreach: sources" controls="controls" muted>\n            <source data-bind="attr: { type: type, src: src }" />\n        </video>\n        <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.errorHeaderText"></h2>\n                    <p data-bind="html: messages.errorMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n        <div class="amp-page amp-page-message amp-unsupported-page" data-bind="visible: isUnsupportedPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.unsupportedHeaderText"></h2>\n                    <p data-bind="html: messages.unsupportedMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.closeButtonText, click: closeButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'}),define("utils/scene7.config",[],function(){"use strict";return function(e,t){this.jsonpCallback="s7jsonResponse",this.jsonpErrorCallback="s7jsonError",this.scene7imageServer=e,this.scene7videoServer=t,this.spinsetManifestFileUrlPattern=this.scene7imageServer+"/products/test-desc/[productID]-spinset",this.imageUrlPattern=this.scene7imageServer+"/products/[assetID]",this.maxImageSize={width:4e3,height:4e3},this.imageMinPartitionFactors={horizontal:3,vertical:4}}}),define("utils/scene7.DataProvider",["$"],function(e){"use strict";var t=function(e){this.scene7config=e,this.manifestCache={}};return t.prototype.ABSOLUTE_URL_REGEX=/^https?:\/\/|^\/\//i,t.requests=[],t.prototype.getJson=function(i,n,r){Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpErrorCallback)||(window[this.scene7config.jsonpErrorCallback]=function(e,i){var n=t.requests[i];"function"==typeof n.onError&&n.onError()}),Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpCallback)||(window[this.scene7config.jsonpCallback]=function(e,i){var n=t.requests[i];"function"==typeof n.onSuccess&&n.onSuccess(e)}),t.requests.push({onSuccess:n,onError:r}),e.ajax({url:i.replace("[requestID]",t.requests.length-1),jsonp:"true",dataType:"jsonp",success:function(e){n(e)},error:r})},t.prototype.getManifestData=function(t){this.ABSOLUTE_URL_REGEX.test(t)||(t="//"+t);var i=new e.Deferred;if(!this.manifestCache[t]){var n=t+(-1===t.indexOf("?")?"?":"&")+"req=set,json&id=[requestID]";return this.getJson(n,function(n){this.manifestCache[t]=n,i.resolve(e.extend(!0,{},n))}.bind(this),function(){i.reject()}),i.promise()}return i.resolve(e.extend(!0,{},this.manifestCache[t])),i.promise()},t}),define("videoPlayer/DataMapper",[],function(){"use strict";var e=function(e){this.scene7config=e};return e.prototype.VIDEO_FILE_URL_PATTERN="/products/[assetID]",e.prototype.VIDEO_TYPE_FORMAT={m3u8:"application/x-mpegurl",mp4:"video/mp4"},e.prototype.map=function(e){return e.set.item.map(this.getAssetFromServerItem.bind(this))},e.prototype.getAssetFromServerItem=function(e){return{bitrate:parseInt(e.v.bitrate,10),width:parseInt(e.v.dx,10),height:parseInt(e.v.dy,10),src:this.scene7config.scene7videoServer+this.VIDEO_FILE_URL_PATTERN.replace("[assetID]",e.v.path),format:e.v.suffix,type:this.VIDEO_TYPE_FORMAT[e.v.suffix],fps:e.userdata&&e.userdata[0]&&e.userdata[0].Video_Frame_Rate?parseFloat(e.userdata[0].Video_Frame_Rate):null}},e}),define("utils/deviceHelper",[],function(){"use strict";var e=function(){return this};return e.prototype.getScreenProperties=function(e){return{width:e.screen.width,height:e.screen.height}},e.prototype.isPhysicalSizeGreaterThanLogicalSize=function(e){return e&&void 0!==e.systemXDPI&&void 0!==e.logicalXDPI&&e.systemXDPI>e.logicalXDPI},e.prototype.getDevicePixelRatio=function(e){var t=1;return this.isPhysicalSizeGreaterThanLogicalSize(e.screen)?t=e.screen.systemXDPI/e.screen.logicalXDPI:void 0!==e.devicePixelRatio&&(t=e.devicePixelRatio),t},e.prototype.getWidthInPhysicalPixels=function(e){return this.getScreenProperties(e).width*this.getDevicePixelRatio(e)},e.prototype.getHeightInPhysicalPixels=function(e){return this.getScreenProperties(e).height*this.getDevicePixelRatio(e)},new e}),define("videoPlayer/AssetsProvider",["$","utils/deviceHelper"],function(e,t){"use strict";var i=function(e,t,i){this.scene7config=e,this.dataProvider=t,this.dataMapper=i};return i.prototype.MANIFEST_PATH_PATTERN="/products/test-desc/[productID]-catwalk-AVS",i.prototype.DEFAULT_FPS=50,i.prototype.DEFAULT_BITRATES={480:800,720:1200,1080:2500},i.prototype.getAssetsByFormat=function(e,t){return e.filter(function(e){return e.format===t})},i.prototype.isBetterWidthDifference=function(e,t){return 0===e||e>0&&0>t||!(0>e&&t>0)&&Math.abs(e)<=Math.abs(t)},i.prototype.getBestAssetsByWidth=function(e){var i=t.getWidthInPhysicalPixels(window),n=e[0].width,r=e[0].width-i,s=r;return e.forEach(function(e){s=e.width-i,this.isBetterWidthDifference(s,r)&&(n=e.width,r=s)}.bind(this)),e.filter(function(e){return e.width===n})},i.prototype.getPreferredBitrateForDevice=function(e){e=e||this.DEFAULT_BITRATES;var i=Object.keys(e).map(function(e){return parseInt(e,10)}),n=t.getWidthInPhysicalPixels(window),r=i[0],s=i[0]-n,o=s;return i.forEach(function(e){o=e-n,Math.abs(o)<=Math.abs(s)&&(r=e,s=o)}),1e3*e[r]},i.prototype.getBestAssetsByBitrate=function(e,t){var i=this.getPreferredBitrateForDevice(t),n=e[0].bitrate,r=e[0].bitrate-i,s=r;return e.forEach(function(e){s=e.bitrate-i,Math.abs(s)<=Math.abs(r)&&(n=e.bitrate,r=s)}.bind(this)),e.filter(function(e){return e.bitrate===n})},i.prototype.getBestAssetsByFPS=function(e,t){var i=e[0].fps,n=e[0].fps-t,r=n;return e.forEach(function(e){r=e.fps-t,Math.abs(r)<=Math.abs(n)&&(i=e.fps,n=r)}.bind(this)),e.filter(function(e){return e.fps===i})},i.prototype.getBestAsset=function(e,t,i){if(e&&e.length){i=i||this.DEFAULT_FPS;var n=this.getBestAssetsByWidth(e);if(n.length<=1)return n[0];var r=this.getBestAssetsByBitrate(n,t);if(r.length<=1)return r[0];var s=this.getBestAssetsByFPS(r,i);return s[0]}},i.prototype.getBestAssets=function(e,t,i){var n=this.getBestAssetsFromManifest(t,i);return-1!==i.formats.indexOf("m3u8")&&this.addM3U8Asset(e,n),n},i.prototype.getBestAssetsFromManifest=function(e,t){var i=[];return t.formats.forEach(function(n){var r=this.getBestAsset(this.getAssetsByFormat(e,n),t.preferredBitrates,t.preferredFPS);r&&i.push(r)}.bind(this)),i},i.prototype.addM3U8Asset=function(e,t){t.push({src:e+".m3u8",format:"m3u8",type:this.dataMapper.VIDEO_TYPE_FORMAT.m3u8})},i.prototype.getAssets=function(e,t,i,n){return isNaN(parseInt(e,10))||(e=this.scene7config.scene7videoServer+this.MANIFEST_PATH_PATTERN.replace("[productID]",e)),this.dataProvider.getManifestData(e).then(function(n){var r=this.dataMapper.map(n),s=this.getBestAssets(e,r,t);return s.sort(function(e,i){return t.formats.indexOf(e.format)-t.formats.indexOf(i.format)}),"function"==typeof i&&i(s),s}.bind(this)).fail(function(){"function"==typeof n&&n()})},i}),define("videoPlayer/ViewModel",["ko"],function(e){function t(t,i){this.events=t,this.sources=e.observableArray(),this.messages=i,this.isErrorPageVisible=e.observable(!1),this.isUnsupportedPageVisible=e.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}return t}),define("utils/fullScreenHelper",["$"],function(e){"use strict";var t=function(e,t){this.events=e,this.fullscreenLauncherName=this.getFullscreenLauncherName(t),this.fullscreenElementName=this.getFullscreenElementName(t),this.fullscreenCancelName=this.getFullscreenCancelName(t),this.elementStyle={position:null,top:null,left:null,width:null,height:null,backgroundColor:null,zIndex:null},this.setEventListeners(t)};return t.prototype.getFullscreenLauncherName=function(e){return e.body.requestFullscreen?"requestFullscreen":e.body.mozRequestFullScreen?"mozRequestFullScreen":e.body.webkitRequestFullscreen?"webkitRequestFullscreen":e.body.msRequestFullscreen?"msRequestFullscreen":null},t.prototype.getFullscreenCancelName=function(e){return e.exitFullscreen?"exitFullscreen":e.mozCancelFullScreen?"mozCancelFullScreen":e.webkitExitFullscreen?"webkitExitFullscreen":null},t.prototype.getFullscreenElementName=function(e){return"fullscreenElement"in e?"fullscreenElement":"webkitFullscreenElement"in e?"webkitFullscreenElement":"msFullscreenElement"in e?"msFullscreenElement":"mozFullScreenElement"in e?"mozFullScreenElement":null},t.prototype.getNativeFullScreenElement=function(e){return this.fullscreenElementName?e[this.fullscreenElementName]:void 0},t.prototype.getFullScreenElement=function(e){return this.fullscreenElement?this.fullscreenElement:this.getNativeFullScreenElement(e)},t.prototype.launchIntoFullscreen=function(e,t){if(!this.getFullScreenElement(e)){if(this.fullscreenLauncherName)return void t[this.fullscreenLauncherName]();this.fullscreenElement=t,this.onFullScreenChange(e)}},t.prototype.exitFullScreen=function(e,t){if(!t||!this.getNativeFullScreenElement(e)||this.getNativeFullScreenElement(e)===t){if(this.fullscreenCancelName)return void(this.getNativeFullScreenElement(e)&&e[this.fullscreenCancelName]());if(this.fullscreenElement)try{var i=this.fullscreenElement.parentNode,n=this.fullscreenElement.nextSibling;i.removeChild(this.fullscreenElement),i.insertBefore(this.fullscreenElement,n)}catch(r){}finally{this.onFullScreenChange(e)}}},t.prototype.onFullScreenChange=function(e){return this.getFullScreenElement(e)?void this.events.trigger("fullScreenEntered"):void this.events.trigger("fullScreenExited")},t.prototype.setEventListeners=function(t){e(t).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.onFullScreenChange.bind(this,t))},new t(e({}),document)}),define("videoPlayer/Controller",["$","utils/fullScreenHelper"],function(e,t){"use strict";var i=function(t,i,n,r,s){this.loadedAssets=null,this.loadedSources=void 0,this.progressEvents={0:!1,25:!1,50:!1,75:!1,100:!1},this.assetsProvider=t,this.events=r,this.viewModel=n,this.videoElement=s,this.params={},this.isError=!1,e.extend(!0,this.params,i),this.setEventListeners()};return i.prototype.setEventListeners=function(){var i=e(this.videoElement);i.on("timeupdate",function(){this.onVideoTimeUpdated(),this.videoElement.ended&&this.onVideoPlaybackEnded()}.bind(this)),i.on("webkitendfullscreen",function(){this.onFullScreenExited()}.bind(this)),i.on("error",function(e){var t=e.target;if(t===this.videoElement)this.onVideoError();else if("SOURCE"===t.tagName){var i=Array.prototype.indexOf.call(this.videoElement.querySelectorAll("source"),t);this.onVideoSourceError(i)}}.bind(this)),i.on("canplay",function(){this.isError=!1}.bind(this)),this.viewModel.events.on("videoSourceError",function(e){this.onVideoSourceError(e.detail.sourceIndex)}.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.onRefreshButtonClicked()}.bind(this)),this.viewModel.events.on("closeButtonClicked",function(){this.onCloseButtonClicked()}.bind(this)),t.events.on("fullScreenExited",function(){this.onFullScreenExited()}.bind(this)),t.events.on("fullScreenEntered fullScreenExited",function(){this.onFullScreenChanged()}.bind(this))},i.prototype.onVideoPlaybackEnded=function(){--this.remainingLoopCount>0?(this.videoElement.currentTime=0,this.resetProgressEvents(),this.videoElement.play(),this.events.trigger("loopEnded")):(this.stop(),this.events.trigger("allLoopsEnded"))},i.prototype.onVideoTimeUpdated=function(){var e=100*this.videoElement.currentTime/this.videoElement.duration;for(var i in this.progressEvents){var n=parseInt(i,10);!this.progressEvents[i]&&e>=n&&(this.progressEvents[i]=!0,this.events.trigger("progress",{detail:{src:this.videoElement.currentSrc,value:n,isFullScreen:t.getFullScreenElement(document)===this.videoElement}}))}},i.prototype.onVideoError=function(){this.isError=!0,this.viewModel.isErrorPageVisible(!0),this.events.trigger("playbackError")},i.prototype.onVideoSourceError=function(e){e===this.viewModel.sources().length-1&&this.onVideoError()},i.prototype.onRefreshButtonClicked=function(){this.videoElement.load(),this.start()},i.prototype.onCloseButtonClicked=function(){this.events.trigger("playerExitRequested")},i.prototype.onFullScreenExited=function(){this.params.closeOnFullScreenExited&&this.events.trigger("playerExitRequested")},i.prototype.onFullScreenChanged=function(){if(!this.params.closeOnFullScreenExited&&4===this.videoElement.readyState){var e=function(){this.videoElement.currentTime<1?(this.videoElement.currentTime+=1,this.videoElement.currentTime-=1):(this.videoElement.currentTime-=1,this.videoElement.currentTime+=1)}.bind(this);this.videoElement.paused?(this.videoElement.play(),e(),this.videoElement.pause()):(e(),this.videoElement.pause(),this.videoElement.play())}},i.prototype.hideInfoPages=function(){this.viewModel.isErrorPageVisible(!1)},i.prototype.start=function(e){this.hideInfoPages(),this.resetProgressEvents(),this.play(this.params.initialLoopCount||1,this.params.startInFullScreen,e)},i.prototype.play=function(e,i,n){n&&this.setAssets(n),this.videoElement&&this.videoElement.play&&this.loadedAssets&&!this.viewModel.isUnsupportedPageVisible()&&((this.isError||JSON.stringify(this.loadedAssets)!==JSON.stringify(this.viewModel.sources()))&&(this.viewModel.sources(this.loadedAssets),this.videoElement.load()),this.remainingLoopCount=e,this.videoElement.readyState>0&&(this.videoElement.currentTime=0),i&&t.launchIntoFullscreen(document,this.videoElement,!0),this.videoElement.play())},i.prototype.stop=function(){this.videoElement&&this.videoElement.pause&&(t.exitFullScreen(document,this.videoElement,!0),this.videoElement.pause(),this.videoElement.readyState>0&&(this.videoElement.currentTime=0))},i.prototype.resetProgressEvents=function(){for(var e in this.progressEvents)this.progressEvents[e]=!1},i.prototype.hasSupportedAssets=function(e){var t=document.createElement("video");if(!e||!t.canPlayType)return!1;var i=e.filter(function(e){return""!==t.canPlayType(e.type)});return i.length>0},i.prototype.setAssets=function(e){this.loadedAssets=e,this.viewModel.isUnsupportedPageVisible(!this.hasSupportedAssets(this.loadedAssets))},i.prototype.loadAssets=function(e,t,i,n){this.loadedAssets=null,this.assetsProvider.getAssets(e,t,function(e){e&&e.length>0?(this.setAssets(e),"function"==typeof i&&i()):"function"==typeof n&&n()}.bind(this),function(){"function"==typeof n&&n()})},i}),define("videoPlayer/component",["ko","$","videoPlayerView","utils/scene7.config","utils/scene7.DataProvider","videoPlayer/DataMapper","videoPlayer/AssetsProvider","videoPlayer/ViewModel","videoPlayer/Controller"],function(e,t,i,n,r,s,o,a,c){"use strict";return{viewModel:{createViewModel:function(e,i){var l=t({}),d=t({}),u=i.element.querySelector(".asos-media-players .amp-video-player .amp-video-element");e.messages&&e.messages.unsupportedHeaderText&&(e.messages.unsupportedHeaderText=e.messages.unsupportedHeaderText.replace("[BrowserName]","Your browser"));var h=new a(l,e.messages),p=new n(e.scene7.imageServer,e.scene7.videoServer),m=new r(p),f=new s(p),v=new o(p,m,f),g=new c(v,e.player,h,d,u),b={start:g.start.bind(g),stop:g.stop.bind(g),loadAssets:g.loadAssets.bind(g),events:g.events};return e.api(b),h}},template:i,synchronous:!0}}),define("spinViewerView",[],function(){return'<div class="asos-media-players amp-relative">\n    <div class="amp-spin-viewer amp-relative" data-bind=\'css: { "pannable": isPannable() }\'>\n        <div class="amp-spinner amp-relative">\n            <div class="amp-page amp-spin">\n                <div class="amp-page amp-hint" data-bind="fadeVisible: isHintVisible">\n                    <div class="amp-hint-container">\n                        <div class="amp-hint-gesture amp-first">\n                            <div class="amp-hint-gesture-img sprite drag"></div>\n                        </div>\n                        <div class="amp-clear"></div>\n                        <div class="amp-hint-gesture amp-first">\n                            <span data-bind="text: messages.hintDragText"></span>\n                        </div>\n                        <div class="amp-clear"></div>\n                    </div>\n                </div>\n                <div class="amp-page amp-overlay"></div>\n                <div class="amp-page amp-images"></div>\n            </div>\n            <div class="amp-page amp-loading" data-bind="visible: isLoadingPageVisible">\n                <div class="amp-loading-img"></div>\n                <span data-bind="text: loadingPercentage() + \'%\'"></span>\n            </div>\n            <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n                <div class="amp-message-container">\n                    <div class="amp-message-box">\n                        <h2 data-bind="html: messages.errorHeaderText"></h2>\n                        <p data-bind="html: messages.spinsetErrorMessageText"></p>\n                        <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="amp-controls">\n            <div class="amp-button amp-wrapper" data-bind="visible: isCloseButtonVisible, click: closeButtonClicked">\n                <div class="sprite close"></div>\n            </div>\n        </div>\n    </div>\n</div>                '}),define("utils/sizeHelper",[],function(){"use strict";function e(){}return e.prototype.getProportionalSize=function(e,t){var i={width:e.width,height:e.height},n=t.width/t.height,r=e.width/e.height;return r>n?i.width=i.height*n:n>r&&(i.height=i.width/n),i.width=Math.round(i.width),i.height=Math.round(i.height),i},e.prototype.resizeCanvas=function(e,t){var i=document.createElement("canvas");i.width=t.width,i.height=t.height,i.getContext("2d").drawImage(e,0,0,t.width,t.height),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(i,0,0)},new e}),define("utils/imageProvider",["$"],function(e){"use strict";var t=function(){};return t.prototype.setImage=function(t,i,n,r,s,o){if(s&&e.support.cors)return i.onload=n,e.ajax(t,{success:function(e){i.src=t},error:r,cache:!o});if(o)t+="&"+(new Date).getTime();else if(i.complete&&i.src===t)return"function"==typeof n&&n(),null;return i.onload=n,i.onerror=r,i.src=t,null},new t}),define("utils/scene7.ImageLoader",["$","utils/sizeHelper","utils/imageProvider"],function(e,t,i){"use strict";var n=function(e,t){this.urlQueryStringPattern="wid=[width]&hei=[height]&size=[width],[height]&rect=[startH],[startW],[lengthH],[lengthW]&qlt=[qlt]",this.scene7Config=e,this.canUseCanvas=document.createElement("canvas").getContext,this.useCors=t,this.loadRequests=[]};return n.prototype.getPartitionFactors=function(e,t){return{horizontal:Math.max(Math.ceil(e.width/this.scene7Config.maxImageSize.width),t?this.scene7Config.imageMinPartitionFactors.horizontal:1),vertical:Math.max(Math.ceil(e.height/this.scene7Config.maxImageSize.height),t?this.scene7Config.imageMinPartitionFactors.vertical:1)}},n.prototype.getTile=function(e,t,n,r,s,o,a,c,l){var d=new Image,u=this.getTileUrl(t,n,r,s,o,a),h=i.setImage(u,d,function(){d.onload=null,this.loadRequests[e].isActive&&"function"==typeof c&&c(d)}.bind(this),function(){d.onload=null,this.loadRequests[e].isActive&&"function"==typeof l&&l()}.bind(this),this.useCors);return{xhr:h,image:d}},n.prototype.addTile=function(e,t,i,n,r,s,o,a,c,l,d){this.loadRequests[e].isActive&&this.loadRequests[e].tiles.push(this.getTile(e,i,n,s,o,a,c,function(i){if(this.loadRequests[e].isActive){var n=(this.getTileBox(r,s,o,a),t.querySelector('.tile[data-tile-hp="'+s+'" ][data-tile-vp="'+o+'"]')),c=n.querySelector("img");c||(c=new Image,c.style.width="100%",c.style.height="100%",n.appendChild(c)),c.src=i.src,"function"==typeof l&&l()}}.bind(this),d))},n.prototype.addTiles=function(e,t,i,n,r,s,o,a,c,l){var d=e.length,u=function(){d--,0===d&&"function"==typeof c&&c()};0===d&&"function"==typeof c&&c();for(var h=0;h<e.length;h++)this.addTile(t,i,n,r,s,e[h].horizontal,e[h].vertical,o,a,u,l)},n.prototype.loadFullImage=function(e,n,r,s,o,a,c,l,d){(s.width>this.scene7Config.maxImageSize.width||s.height>this.scene7Config.maxImageSize.height)&&(s=t.getProportionalSize(this.scene7Config.maxImageSize,s));var u=r.querySelector(".fullImageContainer"),h=r.querySelector(".partitionedImageContainer"),p=r.querySelector(".fullImageContainer img"),m=!1;u||(u=document.createElement("div"),u.className="fullImageContainer",r.insertBefore(u,r.firstChild)),p?m=!p.complete:(p=new Image,p.className="img",p.style.width="100%",p.style.height="100%",u.appendChild(p)),u.style.width=Math.floor(o.width)+"px",u.style.height=Math.floor(o.height)+"px",c&&(u.style.position=c.position,u.style.top=c.top,u.style.left=c.left),u.setAttribute("data-url",n),u.setAttribute("data-target-qlt",a),u.setAttribute("data-target-width",Math.floor(s.width)),u.setAttribute("data-target-height",Math.floor(s.height)),u.setAttribute("data-output-width",Math.floor(o.width)),u.setAttribute("data-output-height",Math.floor(o.height));var f=this.getTileUrl(n,s,0,0,{vertical:1,horizontal:1},a),v=i.setImage(f,p,function(){if(p.onload=null,this.loadRequests[e].isActive){if(h)for(;h.lastChild;)h.removeChild(h.lastChild);"function"==typeof l&&l()}}.bind(this),function(){p.onload=null,this.loadRequests[e].isActive&&"function"==typeof d&&d()}.bind(this),this.useCors,m);this.loadRequests[e].tiles.push({image:p,xhr:v})},n.prototype.loadImageToContainer=function(e,t,i,n,r,s,o,a,c,l,d){o=o||{x:i.width/2,y:i.height/2},l=l||"";var u,h,p=this.getPartitionFactors(i,c),m=(p.horizontal*p.vertical,{topLeft:{x:0,y:0},bottomRight:{x:n.width-1,y:n.height-1}}),f=this.getTileDataForPoint(o,n,p),v=this.loadRequests.push({isActive:!0,tiles:[]})-1,g=function(){this.addTiles([f],v,b,e,i,n,p,l,function(){return!!this.loadRequests[v].isActive&&void this.addTiles(u,v,b,e,i,n,p,l,function(){return!!this.loadRequests[v].isActive&&void this.addTiles(h,v,b,e,i,n,p,l,function(){this.loadRequests[v].isActive=!1,"function"==typeof r&&r()}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this);if(a=a||m,a.topLeft.x=Math.max(Math.min(a.topLeft.x,m.bottomRight.x),m.topLeft.x),a.topLeft.y=Math.max(Math.min(a.topLeft.y,m.bottomRight.y),m.topLeft.y),a.bottomRight.x=Math.max(Math.min(a.bottomRight.x,m.bottomRight.x),a.topLeft.x),a.bottomRight.y=Math.max(Math.min(a.bottomRight.y,m.bottomRight.y),a.topLeft.y),u=this.getTilesDataForArea(a,n,[f],f,p),h=this.getTilesDataForArea(m,n,[f].concat(u),f,p),!this.canUseCanvas||1===p.vertical&&1===p.horizontal)this.loadFullImage(v,e,t,i,n,l,d,r,s);else{var b=t.querySelector(".partitionedImageContainer");if(!b){b=document.createElement("div"),b.className="partitionedImageContainer",b.style.width=n.width+"px",b.style.height=n.height+"px",d&&(b.style.position=d.position,b.style.top=d.top,b.style.left=d.left);for(var y=0;y<p.vertical;y++)for(var S=0;S<p.horizontal;S++){var w=document.createElement("div");w.className="tile",w.style["float"]="left",w.style.width=100/p.horizontal+"%",w.style.height=100/p.vertical+"%",w.setAttribute("data-tile-hp",S),w.setAttribute("data-tile-vp",y),b.appendChild(w)}t.appendChild(b)}g()}return v},n.prototype.getTilesDataForArea=function(e,t,i,n,r){i=i||[],n=n||{horizontal:0,vertical:0};for(var s=this.getTileDataForPoint(e.topLeft,t,r),o=this.getTileDataForPoint(e.bottomRight,t,r),a=[],c=function(e){return e.horizontal===l&&e.vertical===d},l=s.horizontal;l<=o.horizontal;l++)for(var d=s.vertical;d<=o.vertical;d++)0===i.filter(c).length&&a.push({horizontal:l,vertical:d});return a.sort(function(e,t){var i=Math.sqrt(Math.pow(e.horizontal-n.horizontal,2)+Math.pow(e.vertical-n.vertical)),r=Math.sqrt(Math.pow(t.horizontal-n.horizontal,2)+Math.pow(t.vertical-n.vertical));return i>r?1:-1}),a},n.prototype.getTileDataForPoint=function(e,t,i){for(var n,r={horizontal:null,vertical:null},s=0;s<i.horizontal&&null===r.horizontal;s++)n=this.getTileBox(t,s,0,i),e.x>=n.left&&e.x<n.left+n.width&&(r.horizontal=s);for(var o=0;o<i.vertical&&null===r.vertical;o++)n=this.getTileBox(t,0,o,i),e.y>=n.top&&e.y<n.top+n.height&&(r.vertical=o);return r},n.prototype.getTileBox=function(e,t,i,n){var r=this.getPartPosition(t,e.width,n.horizontal),s=this.getPartPosition(i,e.height,n.vertical),o=this.getPartPosition(t+1,e.width,n.horizontal),a=this.getPartPosition(i+1,e.height,n.vertical);return{left:r,top:s,width:o-r,height:a-s}},n.prototype.getPartPosition=function(e,t,i){return Math.floor(t*e/i)},n.prototype.getTileUrl=function(e,t,i,n,r,s){var o=this.getTileBox(t,i,n,r),a=e.indexOf("?")>-1?"&":"?",c=e+a+this.urlQueryStringPattern,l=c.replace(/\[width\]/g,Math.floor(t.width)).replace(/\[height\]/g,Math.floor(t.height)).replace("[startH]",Math.floor(o.left)).replace("[startW]",Math.floor(o.top)).replace("[lengthH]",Math.floor(o.width)).replace("[lengthW]",Math.floor(o.height)).replace("[qlt]",s);return l},n.prototype.cancelAllLoadRequests=function(){for(var e=0;e<this.loadRequests.length;e++)this.cancelLoadRequest(e)},n.prototype.cancelLoadRequest=function(e){if("number"==typeof e&&e<this.loadRequests.length&&this.loadRequests[e].isActive){var t=this.loadRequests[e];if(t.isActive=!1,t.tiles.length)for(var i=t.tiles[0].image.src,n=t.tiles.pop();n;)n.xhr?n.xhr.abort():(n.image.onload=null,n.image.src=i),n=t.tiles.pop()}},n}),define("spinViewer/DataProvider",[],function(){"use strict";var e=function(e,t){this.scene7config=e,this.scene7dataProvider=t};return e.prototype.mapManifestData=function(e){var t={frameUrls:[],maxSize:{width:0,height:0}};if(e.set.item.length>0){var i=e.set.item[0].set?e.set.item.length:1;if(1===i)t.frameUrls[0]=e.set.item.map(function(e){return this.scene7config.imageUrlPattern.replace("[assetID]",e.i.n)}.bind(this)),t.maxSize.width=parseInt(e.set.item[0].dx,10),t.maxSize.height=parseInt(e.set.item[0].dy,10);else{e.set.item[0].set.item.length>0&&(t.maxSize.width=parseInt(e.set.item[0].set.item[0].dx,10),t.maxSize.height=parseInt(e.set.item[0].set.item[0].dy,10));for(var n=0;i>n;n++)t.frameUrls[n]=e.set.item[n].set.item.map(function(e){return this.scene7config.imageUrlPattern.replace("[assetID]",e.i.n)}.bind(this))}}return t},e.prototype.getSpinsetDataForImageUrls=function(e,t,i){for(var n,r="[baseUrl]?imageset={[imageSet]}&req=set,json",s=[],o=0;o<e.length;o++)n=e[o].split("?").shift(),r=r.replace("[baseUrl]",n),s.push(n.split("/").pop());return r=r.replace("[imageSet]",s.join(",")),this.scene7dataProvider.getManifestData(r).then(function(e){var i=[];for(Array.isArray(e.set.item)||(e.set.item=[e.set.item]),o=0;o<e.set.item.length;o++)i.push(this.mapManifestData({set:{item:[e.set.item[o]]}}));return"function"==typeof t&&t(i),i}.bind(this)).fail(function(){"function"==typeof i&&i()})},e.prototype.getSpinsetDataForImageUrl=function(e,t,i){e=e.split("?").shift();var n=e+"?req=set,json";return this.scene7dataProvider.getManifestData(n).then(function(e){return e.set.item=[e.set.item],"function"==typeof t&&t(e),e}.bind(this)).fail(function(){"function"==typeof i&&i()})},e.prototype.getSpinsetDataForProduct=function(e,t,i){var n=this.scene7config.spinsetManifestFileUrlPattern.replace("[productID]",e);return this.scene7dataProvider.getManifestData(n).then(function(e){var i=this.mapManifestData(e);return"function"==typeof t&&t(i),i}.bind(this)).fail(function(){"function"==typeof i&&i()})},e}),define("spinViewer/AssetsProvider",[],function(){"use strict";var e=function(e){this.dataProvider=e};return e.prototype.getAssets=function(e,t,i){Array.isArray(e)?this.dataProvider.getSpinsetDataForImageUrls(e,t,i):isNaN(e)?this.dataProvider.getSpinsetDataForImageUrl(e,t,i):this.dataProvider.getSpinsetDataForProduct(e,t,i)},e}),define("spinViewer/ViewModel",["ko"],function(e){function t(t,i){this.events=t,this.messages=i,this.isCloseButtonVisible=e.observable(!1),this.isPannable=e.observable(!1),this.isLoadingPageVisible=e.observable(!1),this.loadingPercentage=e.observable(0),this.isErrorPageVisible=e.observable(!1),this.isHintVisible=e.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}return t}),define("utils/ImageScaler",["$"],function(e){"use strict";var t=function(t){this.options={},e.extend(!0,this.options,t)};return t.prototype.getScaledImageSize=function(e){var t=this.getScaledImageLength(this.options.baseSize.width,this.options.maxSize.width,e),i=this.getScaledImageLength(this.options.baseSize.height,this.options.maxSize.height,e);return{width:t,height:i}},t.prototype.getScaledImageLength=function(e,t,i){return i?Math.pow(Math.pow(e,1/i)*t/e,i):e},t}),define("utils/ImageZoomer",["ko","$","utils/sizeHelper"],function(e,t,i){"use strict";var n=function(i,n,r,s){this.events=t({}),this.imageLoader=i,this.inputImageScaler=n,this.outputImageScaler=r,this.currentLevel=e.observable(0),this.options={},t.extend(!0,this.options,s),this.options.zoomFactors=[0].concat(this.options.zoomFactors),this.updateCanZoomDummy=e.observable(!1),this.currLoadRequestId=null,this.currentPosition={x:0,y:0},this.currentSize={width:0,height:0},this.canZoomIn=e.computed(this.canZoomIn,this),this.canZoomOut=e.computed(this.canZoomOut,this),this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded;
};return n.prototype.FULL_IMAGE_STATUS={NotLoaded:0,Loaded:2},n.prototype.init=function(){var e=t(this.options.container);this.containerSize={width:this.options.containerSize?this.options.containerSize.width:e.width(),height:this.options.containerSize?this.options.containerSize.height:e.height()},this.currentSize=this.getOutputImageSize(this.currentLevel()),this.currentPosition=this.getSanitizedPosition(this.currentPosition,this.currentSize),this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy())},n.prototype.getNextClosestLevel=function(e){for(var t=0,i=0;i<=this.options.zoomFactors.length;){var n=this.currentSize,r=this.getOutputImageSize(i);if(e&&(n.width===r.width||n.height===r.height)){t=i;break}if(n.width<r.width||n.height<r.height){t=i;break}i++}return t},n.prototype.resize=function(e,t,i){var n=this.getNextClosestLevel(!0);this.options.containerSize=t.containerSize,this.options.outputBaseSize=t.outputBaseSize,this.outputImageScaler.options.baseSize=t.imageScalersOptions.outputImageScalerOptions.baseSize,this.outputImageScaler.options.maxSize=t.imageScalersOptions.outputImageScalerOptions.maxSize,this.init(),e&&this.zoom(function(){return n},null,i)},n.prototype.canZoomIn=function(){this.updateCanZoomDummy();var e=this.currentSize,t=this.getOutputImageSize(this.options.zoomFactors.length-1);return e.width<t.width||e.height<t.height},n.prototype.canZoomOut=function(){this.updateCanZoomDummy();var e=this.getOutputImageSize(0),t=this.currentSize;return e.width<t.width||e.height<t.height},n.prototype.zoomIn=function(e,t,i){return this.canZoomIn()?void this.zoom(this.getNextClosestLevel.bind(this,!1),t,i):e?void this.zoomReset(i):void("function"==typeof i&&i())},n.prototype.zoomOut=function(e,t){return this.canZoomOut()?void this.zoom(function(){return this.currentLevel()-1}.bind(this),e,t):void("function"==typeof t&&t())},n.prototype.zoomReset=function(e,t){if(t){var i=0,n=this.getOutputImageSize(i),r=this.getZoomedImageBox(this.currentSize,this.currentPosition,n);return this.currentSize=r.size,this.currentPosition=r.position,this.applyPosition(!0),this.currentLevel(i),void("function"==typeof e&&setTimeout(e,0))}this.zoom(function(){return 0}.bind(this),void 0,e)},n.prototype.loadImage=function(e,t,i,n,r,s,o,a,c,l,d){e&&(this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.currLoadRequestId=this.imageLoader.loadImageToContainer(e,t,i,n,function(){this.currLoadRequestId=null,"function"==typeof r&&setTimeout(r,0)}.bind(this),s,o,a,c,l,d))},n.prototype.zoom=function(e,t,i,n){this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.fullImageStatus!==this.FULL_IMAGE_STATUS.Loaded&&(this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded);var r=e(),s=(this.getInputImageSize(r),this.getOutputImageSize(r)),o=this.getZoomedImageBox(this.currentSize,this.currentPosition,s,t),a=r>0;this.currentSize=o.size,this.currentPosition=o.position,this.applyPosition(!0),this.fullImageStatus===this.FULL_IMAGE_STATUS.NotLoaded&&a&&(this.loadImage(this.options.baseUrl,this.options.container,this.getInputImageSize(this.options.zoomFactors.length-1),this.currentSize,function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.Loaded,this.applyPosition(),"function"==typeof i&&i()}.bind(this),function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded,"function"==typeof n&&n()}.bind(this),o.focalPointOnSourceImage,this.getVisibleArea(o.position),!0,this.options.zoomJpgQlt,{position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px"}),this.applyPosition(!0)),this.currentLevel(r),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.getVisibleArea=function(e){return{topLeft:{x:-e.x,y:-e.y},bottomRight:{x:this.containerSize.width-e.x,y:this.containerSize.height-e.y}}},n.prototype.getZoomedImageBox=function(e,t,i,n){n||(n={x:this.containerSize.width/2,y:this.containerSize.height/2}),n=this.getSanitizedPointOnImage(n,e);var r=this.getPointOnOutputImageFromContainer(n,e),s={width:i.width-e.width,height:i.height-e.height},o=i.width/e.width,a={x:r.x*o,y:r.y*o},c={x:r.x/e.width,y:r.y/e.height},l={x:s.width*c.x,y:s.height*c.y},d=this.getSanitizedPosition({x:t.x-l.x,y:t.y-l.y},i);return{size:i,position:d,focalPointOnSourceImage:a}},n.prototype.moveBy=function(e){this.canZoomOut()&&(e.x||e.y)&&(this.currentPosition=this.getSanitizedPosition({x:this.currentPosition.x+e.x,y:this.currentPosition.y+e.y},this.currentSize),this.applyPosition())},n.prototype.applyPosition=function(e){var i=t(this.options.container),n=Math.floor(this.currentSize.width),r=Math.floor(this.currentSize.height),s=i.find(".fullImageContainer, .partitionedImageContainer");s.css({position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px",width:n+"px",height:r+"px"}),s.attr({"data-output-width":n,"data-output-height":r})},n.prototype.getInputImageSize=function(e){var t=this.options.zoomFactors[e],i=this.inputImageScaler.getScaledImageSize(t);return i.width<this.options.outputBaseSize.width||i.height<this.options.outputBaseSize.height?this.options.outputBaseSize:i},n.prototype.getOutputImageSize=function(e){if(0===e)return this.options.outputBaseSize;var t=this.options.zoomFactors[e],i=this.outputImageScaler.getScaledImageSize(t);return i.width<this.options.outputBaseSize.width||i.height<this.options.outputBaseSize.height?this.options.outputBaseSize:i},n.prototype.setPlaceholderImage=function(e){var i=0,n=(this.getInputImageSize(i),this.getOutputImageSize(i)),r=this.getZoomedImageBox(this.currentSize,this.currentPosition,n);this.currentSize=r.size,this.currentPosition=r.position;var s=t(this.options.container).children(),o=document.createElement("div");o.className="fullImageContainer",e.className="img",e.style.width="100%",e.style.height="100%",o.appendChild(e),this.options.container.appendChild(o),this.applyPosition(!0),s.remove()},n.prototype.getBezel=function(e){return{horizontal:Math.max(this.containerSize.width-Math.floor(e.width),0)/2,vertical:Math.max(this.containerSize.height-Math.floor(e.height),0)/2}},n.prototype.getSanitizedPosition=function(e,t){var i=this.getBezel(t),n={x:Math.floor(e.x),y:Math.floor(e.y)};return n.x=Math.min(n.x,i.horizontal),n.y=Math.min(n.y,i.vertical),n.x=Math.max(n.x,this.containerSize.width-Math.floor(t.width)-i.horizontal),n.y=Math.max(n.y,this.containerSize.height-Math.floor(t.height)-i.vertical),n},n.prototype.getSanitizedPointOnImage=function(e,t){var i=this.getBezel(t),n={x:e.x,y:e.y};return n.x=Math.max(n.x,i.horizontal),n.y=Math.max(n.y,i.vertical),n.x=Math.min(n.x,this.containerSize.width-i.horizontal),n.y=Math.min(n.y,this.containerSize.height-i.vertical),n},n.prototype.getPointOnOutputImageFromContainer=function(e){return{x:e.x-this.currentPosition.x,y:e.y-this.currentPosition.y}},n.prototype.getCurrentImageDisplaySize=function(){return this.currentSize},n.prototype.scale=function(e,t,i,n){i||(i={x:0,y:0});var r={width:Math.max(e.width*t,this.options.outputBaseSize.width),height:Math.max(e.height*t,this.options.outputBaseSize.height)};if(!n){var s=this.getOutputImageSize(this.options.zoomFactors.length-1);r.width=Math.min(s.width,r.width),r.height=Math.min(s.height,r.height)}var o=this.getZoomedImageBox(this.currentSize,this.currentPosition,r,i);this.currentPosition=o.position,this.currentSize=o.size,this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.setPartitionedImageVisibility=function(){var e=this.options.container.querySelector(".partitionedImageContainer");return e?this.currentSize.width===this.options.outputBaseSize.width?void(this.options.container.querySelector(".partitionedImageContainer").style.display="none"):void(this.options.container.querySelector(".partitionedImageContainer").style.display="block"):void 0},n}),function(e,t,i,n){"use strict";function r(e,t,i){return setTimeout(l(e,i),t)}function s(e,t,i){return!!Array.isArray(e)&&(o(e,i[t],i),!0)}function o(e,t,i){var r;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==n)for(r=0;r<e.length;)t.call(i,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(i,e[r],r,e)}function a(t,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,r,n),t.apply(this,arguments)}}function c(e,t,i){var n,r=t.prototype;n=e.prototype=Object.create(r),n.constructor=e,n._super=r,i&&ue(n,i)}function l(e,t){return function(){return e.apply(t,arguments)}}function d(e,t){return typeof e==me?e.apply(t?t[0]||n:n,t):e}function u(e,t){return e===n?t:e}function h(e,t,i){o(v(t),function(t){e.addEventListener(t,i,!1)})}function p(e,t,i){o(v(t),function(t){e.removeEventListener(t,i,!1)})}function m(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function f(e,t){return e.indexOf(t)>-1}function v(e){return e.trim().split(/\s+/g)}function g(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function b(e){return Array.prototype.slice.call(e,0)}function y(e,t,i){for(var n=[],r=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];g(r,o)<0&&n.push(e[s]),r[s]=o,s++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function S(e,t){for(var i,r,s=t[0].toUpperCase()+t.slice(1),o=0;o<he.length;){if(i=he[o],r=i?i+s:t,r in e)return r;o++}return n}function w(){return Se++}function k(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}function _(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){d(e.options.enable,[e])&&i.handler(t)},this.init()}function I(e){var t,i=e.options.inputClass;return new(t=i?i:_e?U:Ie?B:ke?W:O)(e,C)}function C(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=t&ze&&n-r===0,o=t&(Me|Le)&&n-r===0;i.isFirst=!!s,i.isFinal=!!o,s&&(e.session={}),i.eventType=t,P(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function P(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=A(t)),r>1&&!i.firstMultiple?i.firstMultiple=A(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,a=o?o.center:s.center,c=t.center=z(n);t.timeStamp=ge(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=V(a,c),t.distance=L(a,c),x(i,t),t.offsetDirection=M(t.deltaX,t.deltaY);var l=E(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=ve(l.x)>ve(l.y)?l.x:l.y,t.scale=o?R(o.pointers,n):1,t.rotation=o?D(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,T(i,t);var d=e.element;m(t.srcEvent.target,d)&&(d=t.srcEvent.target),t.target=d}function x(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};t.eventType!==ze&&s.eventType!==Me||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}function T(e,t){var i,r,s,o,a=e.lastInterval||t,c=t.timeStamp-a.timeStamp;if(t.eventType!=Le&&(c>Ae||a.velocity===n)){var l=t.deltaX-a.deltaX,d=t.deltaY-a.deltaY,u=E(c,l,d);r=u.x,s=u.y,i=ve(u.x)>ve(u.y)?u.x:u.y,o=M(l,d),e.lastInterval=t}else i=a.velocity,r=a.velocityX,s=a.velocityY,o=a.direction;t.velocity=i,t.velocityX=r,t.velocityY=s,t.direction=o}function A(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:fe(e.pointers[i].clientX),clientY:fe(e.pointers[i].clientY)},i++;return{timeStamp:ge(),pointers:t,center:z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function z(e){var t=e.length;if(1===t)return{x:fe(e[0].clientX),y:fe(e[0].clientY)};for(var i=0,n=0,r=0;t>r;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:fe(i/t),y:fe(n/t)}}function E(e,t,i){return{x:t/e||0,y:i/e||0}}function M(e,t){return e===t?Ve:ve(e)>=ve(t)?0>e?De:Re:0>t?Oe:Ue}function L(e,t,i){i||(i=$e);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function V(e,t,i){i||(i=$e);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}function D(e,t){return V(t[1],t[0],We)+V(e[1],e[0],We)}function R(e,t){return L(t[0],t[1],We)/L(e[0],e[1],We)}function O(){this.evEl=qe,this.evWin=He,this.pressed=!1,_.apply(this,arguments)}function U(){this.evEl=Ye,this.evWin=Xe,_.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function F(){this.evTarget=Ke,this.evWin=Qe,this.started=!1,_.apply(this,arguments)}function N(e,t){var i=b(e.touches),n=b(e.changedTouches);return t&(Me|Le)&&(i=y(i.concat(n),"identifier",!0)),[i,n]}function B(){this.evTarget=tt,this.targetIds={},_.apply(this,arguments)}function $(e,t){var i=b(e.touches),n=this.targetIds;if(t&(ze|Ee)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=b(e.changedTouches),a=[],c=this.target;if(s=i.filter(function(e){return m(e.target,c)}),t===ze)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),t&(Me|Le)&&delete n[o[r].identifier],r++;return a.length?[y(s.concat(a),"identifier",!0),a]:void 0}function W(){_.apply(this,arguments);var e=l(this.handler,this);this.touch=new B(this.manager,e),this.mouse=new O(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function G(e,t){e&ze?(this.primaryTouch=t.changedPointers[0].identifier,q.call(this,t)):e&(Me|Le)&&q.call(this,t)}function q(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches,r=function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)};setTimeout(r,it)}}function H(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),o=Math.abs(i-r.y);if(nt>=s&&nt>=o)return!0}return!1}function j(e,t){this.manager=e,this.set(t)}function Z(e){if(f(e,lt))return lt;var t=f(e,dt),i=f(e,ut);return t&&i?lt:t||i?t?dt:ut:f(e,ct)?ct:at}function Y(){if(!st)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!i||e.CSS.supports("touch-action",n)}),t}function X(e){this.options=ue({},this.defaults,e||{}),this.id=w(),this.manager=null,this.options.enable=u(this.options.enable,!0),this.state=pt,this.simultaneous={},this.requireFail=[]}function J(e){return e&bt?"cancel":e&vt?"end":e&ft?"move":e&mt?"start":""}function K(e){return e==Ue?"down":e==Oe?"up":e==De?"left":e==Re?"right":""}function Q(e,t){var i=t.manager;return i?i.get(e):e}function ee(){X.apply(this,arguments)}function te(){ee.apply(this,arguments),this.pX=null,this.pY=null}function ie(){ee.apply(this,arguments)}function ne(){X.apply(this,arguments),this._timer=null,this._input=null}function re(){ee.apply(this,arguments)}function se(){ee.apply(this,arguments)}function oe(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ae(e,t){return t=t||{},t.recognizers=u(t.recognizers,ae.defaults.preset),new ce(e,t)}function ce(e,t){this.options=ue({},ae.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=I(this),this.touchAction=new j(this,this.options.touchAction),le(this,!0),o(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function le(e,t){var i=e.element;if(i.style){var n;o(e.options.cssProps,function(r,s){n=S(i.style,s),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={})}}function de(e,i){var n=t.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var ue,he=["","webkit","Moz","MS","ms","o"],pe=t.createElement("div"),me="function",fe=Math.round,ve=Math.abs,ge=Date.now;ue="function"!=typeof Object.assign?function(e){if(e===n||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(r!==n&&null!==r)for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])}return t}:Object.assign;var be=a(function(e,t,i){for(var r=Object.keys(t),s=0;s<r.length;)(!i||i&&e[r[s]]===n)&&(e[r[s]]=t[r[s]]),s++;return e},"extend","Use `assign`."),ye=a(function(e,t){return be(e,t,!0)},"merge","Use `assign`."),Se=1,we=/mobile|tablet|ip(ad|hone|od)|android/i,ke="ontouchstart"in e,_e=S(e,"PointerEvent")!==n,Ie=ke&&we.test(navigator.userAgent),Ce="touch",Pe="pen",xe="mouse",Te="kinect",Ae=25,ze=1,Ee=2,Me=4,Le=8,Ve=1,De=2,Re=4,Oe=8,Ue=16,Fe=De|Re,Ne=Oe|Ue,Be=Fe|Ne,$e=["x","y"],We=["clientX","clientY"];_.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(k(this.element),this.evWin,this.domHandler)}};var Ge={mousedown:ze,mousemove:Ee,mouseup:Me},qe="mousedown",He="mousemove mouseup";c(O,_,{handler:function(e){var t=Ge[e.type];t&ze&&0===e.button&&(this.pressed=!0),t&Ee&&1!==e.which&&(t=Me),this.pressed&&(t&Me&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:xe,srcEvent:e}))}});var je={pointerdown:ze,pointermove:Ee,pointerup:Me,pointercancel:Le,pointerout:Le},Ze={2:Ce,3:Pe,4:xe,5:Te},Ye="pointerdown",Xe="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ye="MSPointerDown",Xe="MSPointerMove MSPointerUp MSPointerCancel"),c(U,_,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=je[n],s=Ze[e.pointerType]||e.pointerType,o=s==Ce,a=g(t,e.pointerId,"pointerId");r&ze&&(0===e.button||o)?0>a&&(t.push(e),a=t.length-1):r&(Me|Le)&&(i=!0),0>a||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(a,1))}});var Je={touchstart:ze,touchmove:Ee,touchend:Me,touchcancel:Le},Ke="touchstart",Qe="touchstart touchmove touchend touchcancel";c(F,_,{handler:function(e){var t=Je[e.type];if(t===ze&&(this.started=!0),this.started){var i=N.call(this,e,t);t&(Me|Le)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:Ce,srcEvent:e})}}});var et={touchstart:ze,touchmove:Ee,touchend:Me,touchcancel:Le},tt="touchstart touchmove touchend touchcancel";c(B,_,{handler:function(e){var t=et[e.type],i=$.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:Ce,srcEvent:e})}});var it=2500,nt=25;c(W,_,{handler:function(e,t,i){var n=i.pointerType==Ce,r=i.pointerType==xe;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)G.call(this,t,i);else if(r&&H.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var rt=S(pe.style,"touchAction"),st=rt!==n,ot="compute",at="auto",ct="manipulation",lt="none",dt="pan-x",ut="pan-y",ht=Y();j.prototype={set:function(e){e==ot&&(e=this.compute()),st&&this.manager.element.style&&ht[e]&&(this.manager.element.style[rt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return o(this.manager.recognizers,function(t){d(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Z(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,r=f(n,lt)&&!ht[lt],s=f(n,ut)&&!ht[ut],o=f(n,dt)&&!ht[dt];if(r){var a=1===e.pointers.length,c=e.distance<2,l=e.deltaTime<250;if(a&&c&&l)return}return o&&s?void 0:r||s&&i&Fe||o&&i&Ne?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var pt=1,mt=2,ft=4,vt=8,gt=vt,bt=16,yt=32;X.prototype={defaults:{},set:function(e){return ue(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(s(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Q(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return s(e,"dropRecognizeWith",this)?this:(e=Q(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(s(e,"requireFailure",this))return this;var t=this.requireFail;return e=Q(e,this),-1===g(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(s(e,"dropRequireFailure",this))return this;e=Q(e,this);var t=g(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(t,e)}var i=this,n=this.state;vt>n&&t(i.options.event+J(n)),t(i.options.event),e.additionalEvent&&t(e.additionalEvent),n>=vt&&t(i.options.event+J(n))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=yt)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(yt|pt)))return!1;e++}return!0},recognize:function(e){var t=ue({},e);return d(this.options.enable,[this,t])?(this.state&(gt|bt|yt)&&(this.state=pt),this.state=this.process(t),void(this.state&(mt|ft|vt|bt)&&this.tryEmit(t))):(this.reset(),void(this.state=yt))},process:function(e){},getTouchAction:function(){},reset:function(){}},c(ee,X,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(mt|ft),r=this.attrTest(e);return n&&(i&Le||!r)?t|bt:n||r?i&Me?t|vt:t&mt?t|ft:mt:yt}}),c(te,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:Be},getTouchAction:function(){var e=this.options.direction,t=[];return e&Fe&&t.push(ut),e&Ne&&t.push(dt),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&Fe?(r=0===s?Ve:0>s?De:Re,i=s!=this.pX,n=Math.abs(e.deltaX)):(r=0===o?Ve:0>o?Oe:Ue,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return ee.prototype.attrTest.call(this,e)&&(this.state&mt||!(this.state&mt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=K(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),c(ie,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[lt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&mt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),c(ne,X,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[at]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,s=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(Me|Le)&&!s)this.reset();else if(e.eventType&ze)this.reset(),this._timer=r(function(){this.state=gt,this.tryEmit()},t.time,this);else if(e.eventType&Me)return gt;return yt},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===gt&&(e&&e.eventType&Me?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ge(),this.manager.emit(this.options.event,this._input)))}}),c(re,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[lt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&mt)}}),c(se,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Fe|Ne,pointers:1},getTouchAction:function(){return te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(Fe|Ne)?t=e.overallVelocity:i&Fe?t=e.overallVelocityX:i&Ne&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&ve(t)>this.options.velocity&&e.eventType&Me},emit:function(e){var t=K(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),c(oe,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ct]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&ze&&0===this.count)return this.failTimeout();if(n&&s&&i){if(e.eventType!=Me)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||L(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e;var c=this.count%t.taps;if(0===c)return this.hasRequireFailures()?(this._timer=r(function(){this.state=gt,this.tryEmit()},t.interval,this),mt):gt}return yt},failTimeout:function(){return this._timer=r(function(){this.state=yt},this.options.interval,this),yt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ae.VERSION="2.0.7",ae.defaults={domEvents:!1,touchAction:ot,enable:!0,inputTarget:null,inputClass:null,preset:[[re,{enable:!1}],[ie,{enable:!1},["rotate"]],[se,{direction:Fe}],[te,{direction:Fe},["swipe"]],[oe],[oe,{event:"doubletap",taps:2},["tap"]],[ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var St=1,wt=2;ce.prototype={set:function(e){return ue(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?wt:St},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&gt)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],t.stopped===wt||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&i.state&(mt|ft|vt)&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof X)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(s(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(s(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=g(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==n&&t!==n){var i=this.handlers;return o(v(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==n){var i=this.handlers;return o(v(e),function(e){t?i[e]&&i[e].splice(g(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&de(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&le(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ue(ae,{INPUT_START:ze,INPUT_MOVE:Ee,INPUT_END:Me,INPUT_CANCEL:Le,STATE_POSSIBLE:pt,STATE_BEGAN:mt,STATE_CHANGED:ft,STATE_ENDED:vt,STATE_RECOGNIZED:gt,STATE_CANCELLED:bt,STATE_FAILED:yt,DIRECTION_NONE:Ve,DIRECTION_LEFT:De,DIRECTION_RIGHT:Re,DIRECTION_UP:Oe,DIRECTION_DOWN:Ue,DIRECTION_HORIZONTAL:Fe,DIRECTION_VERTICAL:Ne,DIRECTION_ALL:Be,Manager:ce,Input:_,TouchAction:j,TouchInput:B,MouseInput:O,PointerEventInput:U,TouchMouseInput:W,SingleTouchInput:F,Recognizer:X,AttrRecognizer:ee,Tap:oe,Pan:te,Swipe:se,Pinch:ie,Rotate:re,Press:ne,on:h,off:p,each:o,merge:ye,extend:be,assign:ue,inherit:c,bindFn:l,prefixed:S});var kt="undefined"!=typeof e?e:"undefined"!=typeof self?self:{};kt.Hammer=ae,"function"==typeof define&&define.amd?define("hammer",[],function(){return ae}):"undefined"!=typeof module&&module.exports?module.exports=ae:e[i]=ae}(window,document,"Hammer"),define("spinViewer/Controller",["ko","$","utils/deviceHelper","utils/sizeHelper","utils/ImageScaler","utils/ImageZoomer","hammer"],function(e,t,i,n,r,s,o){"use strict";var a=function(n,r,s,o,a,c){this.assetsProvider=n,this.imageLoader=r,this.loadedAssets=null,this.events=c,this.containers=a,this.params={showCloseButton:!1,showHint:!1,spinSpeed:1,maxPixelRatio:1.5,hintDisplayTime:3e3,preloadingTimeout:0,handleLoadingErrors:!0,framesCachingQueueInterval:35,useInitialAnimation:!1,animationFramesCount:-1,animationIntervalStart:40,animationIntervalPeak:5},this.viewModel=o,this.updateZoomerDummy=e.observable(!1),this.initState=this.INIT_STATE.NotInitialized,this.frames=[[]],this.lastInitArguments=null,this.currentRowIndex=e.observable(0),this.currentFrameIndex=e.observable(),t.extend(!0,this.params,s),this.params.devicePixelRatio=Math.min(i.getDevicePixelRatio(this.containers.window),this.params.maxPixelRatio),this.isPannable=e.computed(this.isPannable,this),this.hasError=e.observable(!1),this.getCurrentZoomer=e.computed(this.getCurrentZoomer,this),this.setEventListeners(),this.viewModel.isPannable(this.isPannable()),this.viewModel.isCloseButtonVisible(this.params.showCloseButton)};return a.prototype.MIN_GESTURE_RECOGNIZE_DISTANCE=10,a.prototype.INIT_STATE={NotInitialized:0,Initializing:1,Initialized:2},a.prototype.init=function(e,t){return this.initState!==this.INIT_STATE.Initializing?(t&&t.initImage&&(t=t.initImage.image),this.lastInitArguments=arguments,this.updateSpinContainerSize(),this.targetSize=this.getContainerInitialTargetSize(),t?(this.setInitialImage(t),this.initState=this.INIT_STATE.Initialized,void this.showFrame(0,0,!0)):this.initState!==this.INIT_STATE.Initialized?(this.initState=this.INIT_STATE.Initializing,void this.preloadImages(0,0)):void this.resize(function(){this.showFrame(0,0,!0)}.bind(this))):void 0},a.prototype.isVisible=function(){return"none"!==window.getComputedStyle(this.containers.spin).display},a.prototype.setInitialImage=function(e){var t=this.getZoomer(0,0);t.options.baseUrl=this.loadedAssets.frameUrls[0][0],t.zoomReset(null,!0),e.className="img",t.setPlaceholderImage(e)},a.prototype.updateSpinContainerSize=function(){this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.spinContainerSize={width:this.spinContainerRect.width,height:this.spinContainerRect.height}},a.prototype.isPannable=function(){var e=this.getCurrentZoomer();return e&&e.canZoomOut()},a.prototype.close=function(){this.zoomReset(),this.events.trigger("playerExitRequested")},a.prototype.zoomIn=function(e,t,i){var n=this.getCurrentZoomer();return n&&(e||n.canZoomIn())?(this.events.trigger("zoomedIn"),this.imageLoader.cancelAllLoadRequests(),void n.zoomIn(e,t,i)):void("function"==typeof i&&i())},a.prototype.zoomReset=function(e){var t=this.getCurrentZoomer();return t?(this.imageLoader.cancelAllLoadRequests(),void t.zoomReset(e)):void("function"==typeof e&&e())},a.prototype.zoomOut=function(e,t){var i=this.getCurrentZoomer();return i&&i.canZoomOut()?(this.imageLoader.cancelAllLoadRequests(),void i.zoomOut(focalPointInContainer,t)):void("function"==typeof t&&t())},a.prototype.getEventPositionRelativeToTarget=function(e,t){return{x:(e.center?e.center.x:e.clientX)-t.left,y:(e.center?e.center.y:e.clientY)-t.top}},a.prototype.resize=function(e){if(this.isVisible()){var t,i=this.frames.length*this.frames[0].length,n=function(){i--,i||"function"==typeof e&&e()};if(this.updateSpinContainerSize(),!i)return void("function"==typeof e&&e());for(var r=0;r<this.frames.length;r++)for(var s=0;s<this.frames[r].length;s++){
var o=this.getOutputBaseSize();t=this.frames[r][s],t.resize(!0,{containerSize:this.spinContainerSize,outputBaseSize:o,imageScalersOptions:this.getImageScalersOptions(o)},n)}}},a.prototype.animationIntervalEasing=function(e,t){var i=this.params.animationIntervalPeak-this.params.animationIntervalStart,n=(Math.sin(2*Math.PI*e/t-Math.PI/2)+1)/2;return this.params.animationIntervalStart+n*i},a.prototype.refresh=function(){this.init.apply(this,this.lastInitArguments)},a.prototype.animateSpin=function(e,t,i,n){var r=e,s=0,o=t>e?t-e:this.frames[this.currentRowIndex()].length+t-e,a=function(){return this.showFrame(this.currentRowIndex(),r,!0),r===t?void("function"==typeof n&&n()):(r++,s++,r>=this.frames[this.currentRowIndex()].length&&(r=0),void setTimeout(a,i(s,o)))}.bind(this);a()},a.prototype.getZoomer=function(e,t){var i,n=this.getOutputBaseSize(),r=this.getImageScalersOptions(n);return this.frames[e]=this.frames[e]||[],i=this.frames[e][t],i||(i=this.createZoomer(),this.frames[e][t]=i,this.updateZoomerDummy(!this.updateZoomerDummy())),i.inputImageScaler.options.baseSize=r.inputImageScalerOptions.baseSize,i.inputImageScaler.options.maxSize=r.inputImageScalerOptions.maxSize,i.resize(!1,{containerSize:this.spinContainerSize,outputBaseSize:n,imageScalersOptions:r}),i},a.prototype.getImageScalersOptions=function(e){var t={width:this.loadedAssets.maxSize.width,height:this.loadedAssets.maxSize.height},i={width:Math.min(this.loadedAssets.maxSize.width,this.targetSize.width*this.params.devicePixelRatio),height:Math.min(this.loadedAssets.maxSize.height,this.targetSize.height*this.params.devicePixelRatio)},n=e,r={width:Math.max(e.width,this.loadedAssets.maxSize.width/this.params.devicePixelRatio),height:Math.max(e.height,this.loadedAssets.maxSize.height/this.params.devicePixelRatio)};return{inputImageScalerOptions:{baseSize:i,maxSize:t},outputImageScalerOptions:{baseSize:n,maxSize:r}}},a.prototype.createZoomer=function(e){var t=document.createElement("div"),i=this.getOutputBaseSize(),n=this.getImageScalersOptions(i),o=new r(n.inputImageScalerOptions),a=new r(n.outputImageScalerOptions);t.className="amp-frame";var c=new s(this.imageLoader,o,a,{baseUrl:e,zoomFactors:this.params.zoomFactors,container:t,containerSize:this.spinContainerSize,outputBaseSize:i,devicePixelRatio:this.params.devicePixelRatio,baseJpgQlt:this.params.baseJpgQlt,zoomJpgQlt:this.params.zoomJpgQlt});return c},a.prototype.getContainerInitialTargetSize=function(){var e=n.getProportionalSize({width:this.spinContainerSize.width,height:this.spinContainerSize.height},this.loadedAssets.maxSize);return this.params.initialSize&&(e.width=this.params.initialSize.width,e.height=this.loadedAssets.maxSize.height*e.width/this.loadedAssets.maxSize.width),e},a.prototype.getOutputBaseSize=function(){return n.getProportionalSize(this.spinContainerSize,this.loadedAssets.maxSize)},a.prototype.preloadImages=function(e,t,i){this.viewModel.loadingPercentage(0),this.hasError(!1);var n,r=null,s=!1,o=[],a=null,c=function(e){var t=o.pop();return t?(this.showFrame(t.rowIndex,t.frameIndex,!0),m--,void this.viewModel.loadingPercentage(Math.floor(100*(n-m)/n))):void(p||(clearInterval(a),a=null,"function"==typeof e&&e()))},l=function(){s=!0,p--,m--,p||(clearTimeout(r),r=null,clearInterval(a),a=null,this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized)},d=function(){if(clearTimeout(r),r=null,this.hasError(s),s)return this.events.trigger("allImagesLoaded",!1),void(this.initState=this.INIT_STATE.NotInitialized);this.events.trigger("allImagesLoaded",!0);var i=this.frames[e].length,n=t,o=(i+t-1)%i;return!this.params.showHint||window.sessionStorage&&window.sessionStorage.getItem("spinViewerHintDisplayed")||(this.viewModel.isHintVisible(!0),setTimeout(function(){this.viewModel.isHintVisible(!1),window.sessionStorage&&window.sessionStorage.setItem("spinViewerHintDisplayed",!0)}.bind(this),this.params.hintDisplayTime)),this.params.useInitialAnimation?(n=(i+t-this.params.animationFramesCount)%i,o=t,this.showFrame(e,n,!0),this.viewModel.isLoadingPageVisible(!1),void this.animateSpin(n,o,this.animationIntervalEasing.bind(this),function(){this.initState=this.INIT_STATE.Initialized,this.showFrame(e,t,!0)}.bind(this))):(this.viewModel.isLoadingPageVisible(!1),this.initState=this.INIT_STATE.Initialized,void this.showFrame(e,t,!0))},u=function(e,t,i){i.applyPosition(),p--,n>1&&o.push({rowIndex:e,frameIndex:t})},h=function(e,t,i){i.loadImage(this.loadedAssets.frameUrls[e][t],i.options.container,i.inputImageScaler.options.baseSize,i.options.outputBaseSize,u.bind(this,e,t,i),this.params.handleLoadingErrors?l.bind(this):u.bind(this,e,t,i),null,null,1===n,this.params.baseJpgQlt)};n=this.loadedAssets.frameUrls.length*this.loadedAssets.frameUrls[0].length;var p=n,m=n;n>1&&this.viewModel.isLoadingPageVisible(!0),a=setInterval(c.bind(this,d.bind(this)),this.params.framesCachingQueueInterval),this.imageLoader.cancelAllLoadRequests(),this.params.handleLoadingErrors&&this.params.preloadingTimeout&&(r=setTimeout(function(){clearInterval(a),a=null,this.imageLoader.cancelAllLoadRequests(),this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized}.bind(this),this.params.preloadingTimeout));for(var f=0;f<this.loadedAssets.frameUrls.length;f++)for(var v=0;v<this.loadedAssets.frameUrls[f].length;v++){var g=this.getZoomer(f,v);g.options.baseUrl=this.loadedAssets.frameUrls[f][v],h.call(this,f,v,g)}},a.prototype.getCurrentZoomer=function(){return this.updateZoomerDummy(),this.currentRowIndex()<this.frames.length&&this.frames[this.currentRowIndex()]&&this.currentFrameIndex()<this.frames[this.currentRowIndex()].length?this.frames[this.currentRowIndex()][this.currentFrameIndex()]:null},a.prototype.getCurrentFrame=function(){return{rowIndex:this.currentRowIndex(),frameIndex:this.currentFrameIndex(),zoomer:this.getCurrentZoomer()}},a.prototype.showFrame=function(e,t,i){if((i||this.initState===this.INIT_STATE.Initialized)&&(e!=this.currentRowIndex()||t!=this.currentFrameIndex())){this.currentRowIndex(e),this.currentFrameIndex(t);for(var n=this.getCurrentFrame();this.containers.images.lastChild;)this.containers.images.removeChild(this.containers.images.lastChild);this.containers.images.appendChild(n.zoomer.options.container),this.events.trigger("frameShown",n)}},a.prototype.loadFullImage=function(e,t){e.fullImageStatus=e.FULL_IMAGE_STATUS.Loading;var i=(e.getCurrentImageDisplaySize(),e.getOutputImageSize(e.options.zoomFactors.length-1)),n=e.getZoomedImageBox(e.currentSize,e.currentPosition,i,t);e.loadImage(this.loadedAssets.frameUrls[this.currentRowIndex()][this.currentFrameIndex()],e.options.container,e.getInputImageSize(e.options.zoomFactors.length-1),i,function(){e.applyPosition(),e.fullImageStatus=e.FULL_IMAGE_STATUS.Loaded},function(){e.fullImageStatus!==e.FULL_IMAGE_STATUS.Loaded&&(e.fullImageStatus=e.FULL_IMAGE_STATUS.NotLoaded)},n.focalPointOnSourceImage,null,!0,this.params.zoomJpgQlt)},a.prototype.setEventListeners=function(){this.viewModel.events.on("closeButtonClicked",this.close.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.refresh(),this.events.trigger("refreshButtonClicked")}.bind(this)),t(window).resize(function(){if(this.initState===this.INIT_STATE.Initialized){var e=this.containers.spin.getBoundingClientRect();e.width===this.spinContainerRect.width&&e.height===this.spinContainerRect.height||this.resize()}}.bind(this));var e,i,n,r,s=new o(this.containers.root),a=s.get("pinch"),c=s.get("pan"),l=s.get("doubletap"),d=null,u=!1,h=function(e,t){var r=this.getCurrentZoomer();if(r.canZoomOut())return void r.moveBy(t);if(this.frames.length>1||this.frames[this.currentRowIndex()].length>1){var s=this.getRemoteRowIndex(i,this.getMatrixShift(this.params.reverseVerticalDirection,e.y,this.frames.length,this.spinContainerSize.height)),o=this.getRemoteFrameIndex(n,this.getMatrixShift(this.params.reverseHorizontalDirection,e.x,this.frames[0].length,this.spinContainerSize.width));s===this.currentRowIndex()&&o===this.currentFrameIndex()||(this.events.trigger("spun"),this.showFrame(s,o))}}.bind(this),p=function(){c.set({threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE}),c.set({direction:this.isPannable()?o.DIRECTION_ALL:o.DIRECTION_HORIZONTAL}),c.set({enable:this.isPannable()||this.frames[this.currentRowIndex()].length>1})}.bind(this),m=function(t){if(this.initState===this.INIT_STATE.Initialized){t.preventDefault(),t.stopPropagation();var i=this.getCurrentZoomer(),n=t.detail<0||t.wheelDelta>0?1:-1,r=1+.1*n;this.spinContainerRect=this.containers.spin.getBoundingClientRect(),i.fullImageStatus===i.FULL_IMAGE_STATUS.NotLoaded&&this.loadFullImage.call(this,i,this.getEventPositionRelativeToTarget(t,this.spinContainerRect)),e=i.getCurrentImageDisplaySize(),i.scale(e,r,this.getEventPositionRelativeToTarget(t,this.spinContainerRect),u)}}.bind(this);p(),l.set({interval:500,time:500,threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE,posThreshold:100}),this.isPannable.subscribe(function(e){this.viewModel.isPannable(e),p()}.bind(this)),s.on("hammer.input",function(e){return e.distance<this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(d=null),null===d&&e.distance>=this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(d=!this.isPannable()&&1===e.pointers.length&&(e.direction&o.DIRECTION_VERTICAL)>0),d?void s.stop():void a.set({enable:e.pointers.length>1})}.bind(this)),s.on("tap",function(e){this.initState===this.INIT_STATE.Initialized&&"mouse"===e.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(e,this.spinContainerRect)))}.bind(this)),s.on("doubletap",function(e){e.preventDefault(),e.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&"mouse"!==e.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(e,this.spinContainerRect)))}.bind(this)),s.on("panstart",function(e){r=e,n=this.currentFrameIndex(),i=this.currentRowIndex()}.bind(this)),s.on("pan",function(e){if(this.initState===this.INIT_STATE.Initialized){e.preventDefault(),e.srcEvent.stopPropagation(),n=n||this.currentFrameIndex(),i=i||this.currentRowIndex(),r=r||e;var t={x:e.deltaX-r.deltaX,y:e.deltaY-r.deltaY},s={x:e.deltaX,y:e.deltaY};r=e,h(s,t)}}.bind(this)),s.on("panend",function(e){r=e,n=this.currentFrameIndex(),i=this.currentRowIndex()}.bind(this)),s.on("pinchstart",function(t){if(this.initState===this.INIT_STATE.Initialized){var i=this.getCurrentZoomer();i.fullImageStatus===i.FULL_IMAGE_STATUS.NotLoaded&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.loadFullImage.call(this,i,this.getEventPositionRelativeToTarget(t,this.spinContainerRect))),e=i.getCurrentImageDisplaySize(),c.set({enable:!1})}}.bind(this)),s.on("pinch",function(t){t.preventDefault(),t.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&this.getCurrentZoomer().scale(e,t.scale,this.getEventPositionRelativeToTarget(t,this.spinContainerRect),u)}.bind(this)),s.on("pinchend",function(){this.initState===this.INIT_STATE.Initialized&&p()}.bind(this)),this.containers.spin.addEventListener("mousewheel",m),this.containers.spin.addEventListener("DOMMouseScroll",m),this.hasError.subscribe(function(e){this.viewModel.isErrorPageVisible(e)}.bind(this))},a.prototype.getMatrixShift=function(e,t,i,n){var r=(e?-1:1)*this.params.spinSpeed*t*i/n;return r>0?Math.floor(r):Math.ceil(r)},a.prototype.getRemoteFrameIndex=function(e,t){var i=(e+t)%this.frames[0].length;return 0>i&&(i=this.frames[0].length+i),i},a.prototype.getRemoteRowIndex=function(e,t){var i=(e+t)%this.frames.length;return 0>i&&(i=this.frames.length+i),i},a.prototype.loadAssets=function(e,t,i){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=null,this.assetsProvider.getAssets(e,function(e){return e.maxSize.width&&e.maxSize.height?(this.loadedAssets=e,void("function"==typeof t&&t(e))):void("function"==typeof i&&i())}.bind(this),i)},a.prototype.setAssets=function(e){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=e},a}),define("bindings/fadeVisible",["ko","$"],function(e,t){"use strict";function i(){}return i.prototype.init=function(i,n){var r=n();t(i).toggle(e.unwrap(r))},i.prototype.update=function(i,n){var r=n();e.unwrap(r)?t(i).fadeIn():t(i).fadeOut()},e.bindingHandlers.fadeVisible=new i,e.bindingHandlers.fadeVisible}),define("spinViewer/component",["$","spinViewerView","utils/scene7.config","utils/scene7.ImageLoader","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider","spinViewer/ViewModel","spinViewer/Controller","bindings/fadeVisible"],function(e,t,i,n,r,s,o,a,c){"use strict";return{viewModel:{createViewModel:function(t,l){var d=e({}),u=e({}),h={window:window,root:l.element,spin:l.element.querySelector(".amp-spin"),images:l.element.querySelector(".amp-spin .amp-images")},p=new i(t.scene7.imageServer,t.scene7.videoServer),m=new r(p),f=new s(p,m),v=new o(f),g=new n(p,t.viewer.useCors),b=new a(d,t.messages);t.viewer.zoomFactors.container&&(t.viewer.zoomFactors=t.viewer.zoomFactors.container);var y=new c(v,g,t.viewer,b,h,u),S={setAssets:y.setAssets.bind(y),loadAssets:y.loadAssets.bind(y),init:y.init.bind(y),zoomIn:y.zoomIn.bind(y),zoomOut:y.zoomOut.bind(y),zoomReset:y.zoomReset.bind(y),events:y.events};return t.api(S),b}},template:t,synchronous:!0}}),define("Asos.Utils.MediaPlayers",["videoPlayer/component","videoPlayer/DataMapper","videoPlayer/AssetsProvider","spinViewer/component","utils/scene7.config","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider"],function(e,t,i,n,r,s,o,a){"use strict";function c(){this.videoPlayer=e,this.spinViewer=n}return c.prototype.getSpinViewerAssetsProvider=function(e){var t=new r(e),i=new s(t),n=new o(t,i);return new a(n)},c.prototype.getVideoPlayerAssetsProvider=function(e){var n=new r(null,e),o=new s(n),a=new t(n);return new i(n,o,a)},new c}),define("ProductUtils/Cookies",["Utils"],function(e){return function(){this.getXSiteOrigin=function(){var t=e.Cookies.readCookie("x-site-origin",!0);return t?t:null}}}),define("ProductUtils/NewRelicLogger",["PageConfig"],function(e){var t=function(){var t;this.init=function(e){t=e},this.logError=function(i,n){window.newrelic&&(n.pageVersion=e.version,n.pageUrl=window.location.href,n.pageType=t,window.newrelic.addPageAction(i.message,n))}};return t.prototype.PAGE_TYPE={PRD:"ProductPage.SingleProduct",GRP:"ProductPage.MixAndMatch"},t.prototype.ERROR_TYPE={AjaxError:"Ajax Error",ParseError:"Parse Error",UserActionFailed:"User Action Failed",FitAssistantError:"Fit Assistant Error"},new t}),define("asos-web-seo-path",[],function(){"use strict";function e(e){return Object.values(e).map(function(e){var t=s.find(function(t){return t[0]===e});return t?t[1]:e}).join("")}function t(e){return Object.values(e.normalize("NFD")).map(function(e){return e.match(/[0-9A-Za-z \-\/.]/g)?e:void 0}).join("").normalize("NFC")}function i(e){return t(e.trim()).replace(/\//g,"-").replace(/\s/g,"-").replace(/-+/g,"-").replace(/\./g,"").replace(/^-/,"").replace(/-$/,"").toLowerCase()}function n(t,i,n){var r=t,s=i;return n&&"ru-ru"===n.toLowerCase()&&(r=e(t),s=e(i)),{romanProductName:r,romanBrandName:s}}function r(e){return function(t,r,s){if("function"!=typeof"".normalize)return"";if(!t)return e&&e.error("createSeoPath - productName was not passed in"),"";var o=n(t,r,s),a=o.romanProductName,c=o.romanBrandName,l=i(a),d=i(c);return"".concat(d,"/").concat(l)}}var s=[["А","A"],["а","a"],["Б","B"],["б","b"],["В","V"],["в","v"],["Г","G"],["г","g"],["Д","D"],["д","d"],["Е","E"],["е","e"],["Ё","Yo"],["ё","yo"],["Ж","Zh"],["ж","zh"],["З","Z"],["з","z"],["И","I"],["и","i"],["Й","J"],["й","j"],["К","K"],["к","k"],["Л","L"],["л","l"],["М","M"],["м","m"],["Н","N"],["н","n"],["О","O"],["о","o"],["П","P"],["п","p"],["Р","R"],["р","r"],["С","S"],["с","s"],["Т","T"],["т","t"],["У","U"],["у","u"],["Ф","F"],["ф","f"],["Х","H"],["х","h"],["Ц","Ts"],["ц","ts"],["Ч","Ch"],["ч","ch"],["Ш","Sh"],["ш","sh"],["Щ","Sch"],["щ","sch"],["Ъ",""],["ъ",""],["Ы","Y"],["ы","y"],["Ь",""],["ь",""],["Э","E"],["э","e"],["Ю","Yu"],["ю","yu"],["Я","Ya"],["я","ya"]];return r}),define("ProductUtils/Window",[],function(){return window}),define("ProductUtils/UrlUtils",["PageConfig","ProductUtils/NewRelicLogger","asos-web-seo-path","ProductUtils/Window"],function(e,t,i,n){return function(){var r=i();this.formatUrl=function(e){return e?"http"===e.substring(0,4)?e.replace("http:","https:"):"/"===e.substring(0,1)?e:"//"+e:e},this.getUrlParam=function(e,t){t||(t=n.location.href),e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+e+"=([^&#]*)",r=new RegExp(i,"i"),s=r.exec(t);return null===s?null:s[1]},this.getVariantFromUrl=function(e,t){var i=e.split("?")[0];if(i=void 0!==i&&null!==i?i.split("/prd/"):null,i.length>0&&(i=parseInt(i[1])),i||(i=parseInt(this.getUrlParam("iid",e))),!i)return null;for(var n=0;n<t.length;n++)if(t[n].variantId===i)return t[n];return null},this.getProductUrl=function(i,n,s){if(!s)return t.logError(new TypeError("ProductId was not provided")),e.siteDomain;var o="";return i&&n?o="/"+r(i,n,e.language):t.logError(new TypeError("missing brand name or product name, returning generic link"),{productId:s}),e.siteDomain+o+"/prd/"+s}}}),define("ProductUtils/Ajax",["$","uuid","ProductUtils/Cookies","ProductUtils/NewRelicLogger","ProductUtils/UrlUtils"],function(e,t,i,n,r){return function(){function s(e,t){if(!t)return e;var i="";return Object.keys(t).sort().forEach(function(n){var r=t[n];void 0!==r&&null!==r&&(e.indexOf(n+"=")>-1||(i+="&"+n+"="+r))}),-1===e.indexOf("?")&&(i="?"+i.slice(1)),e+i}this.execute=function(t){var o,a,c="ProductPage",l=new i,d=new r;t.callerContext?c+="."+t.callerContext:c=!1,a=void 0!==t.retryCount?t.retryCount:null,o=void 0!==t.authorization?t.authorization:null,void 0===t.cache&&(t.cache=!0);var u=s(t.url,t.storeParams),h={},p=d.getUrlParam("x-site-origin")||l.getXSiteOrigin();return p&&(h["x-site-origin"]=p),e.ajax({cache:t.cache,url:u,data:h,tryCount:0,retryLimit:a,dataType:t.dataType,jsonpCallback:t.jsonpCallback,beforeSend:function(e){this.addRequestHeaders(e,c,o)}.bind(this),success:function(e){this.successRequest(t.successCallback,e,t.callbackArgs)}.bind(this),error:function(i){return n.logError(new Error(n.ERROR_TYPE.AjaxError),{apiName:t.apiName,requestUrl:u,status:i.status,caller:t.callerContext,response:i.response,xSiteOrigin:p,requestHeaders:i.headers,responseHeaders:i.getAllResponseHeaders()}),null!==this.retryLimit&&this.tryCount<=this.retryLimit?(this.tryCount++,void e.ajax(this)):void this.errorRequest(t.errorCallback,i,t.callbackArgs)}.bind(this)})},this.addRequestHeaders=function(e,i,n){if(e.headers={},i!==!1){var r=t();e.setRequestHeader("asos-c-name",i),e.setRequestHeader("asos-cid",r),e.headers["asos-c-name"]=i,e.headers["asos-cid"]=r}null!==n&&(e.setRequestHeader("Authorization",n),e.headers.Authorization=n)},this.successRequest=function(e,t,i){e&&e(t,i)},this.errorRequest=function(e,t,i){e&&e(t,i)}}}),define("ProductUtils/StockPrice",["ProductUtils/Ajax","Product.Config","PageConfig"],function(e,t,i){return function(){this.ajax=new e,this.getStockPrice=function(e,t,i){if(void 0!==e&&null!==e){var n=window.asos&&window.asos.pdp.stockPrice;if(n)return void this.successRequest.call(this,n,{callback:t,products:e});var r=void 0===e.products?e.id:e.productIds;this.requestData(e,t,r,i)}},this.requestData=function(e,n,r,s){this.ajax.execute({storeParams:{store:i.storeCode,currency:i.currency,keyStoreDataversion:i.keyStoreDataversion},url:t.stockPriceUrl+r,apiName:"Product Catalogue",callerContext:"StockPrice",successCallback:this.successRequest.bind(this),errorCallback:s,retryCount:5,callbackArgs:{callback:n,products:e}})},this.successRequest=function(e,t){var i=this.combineData(t.products,e);t.callback(i)},this.combineData=function(e,t){var i,n=void 0!==e.products,r=this.createVariantMap(e,n);if(n){for(var s={},o=0;o<e.products.length;o++)s[e.products[o].id]=o;var a=[];a.length=t.length;for(var c=0;c<t.length;c++){var l=s[t[c].productId];a[l]=t[c]}for(var d=0;d<e.products.length;d++)e.products[d]=this.mergeJsons(e.products[d],a[d]);i=e;for(var u=[],h=0;h<e.products.length;h++)u.push(this.mapVariantData(e.products[h],i.products[h],r[e.products[h].productId]));return i.products=u,i}return r=r[e.id],i=this.mergeJsons(e,t[0]),this.mapVariantData(e,i,r)},this.mapVariantData=function(e,t,i){for(var n=!1,r=0;r<e.variants.length;r++)n||(n=t.variants[r].isInStock),t.variants[r].size=i[t.variants[r].id].size,t.variants[r].sizeOrder=i[t.variants[r].id].sizeOrder,t.variants[r].colour=i[t.variants[r].id].colour,t.variants[r].colourWayId=i[t.variants[r].id].colourWayId,t.variants[r].isPrimary=i[t.variants[r].id].isPrimary,t.variants[r].sizeId=i[t.variants[r].id].sizeId,t.variants[r].productImage=void 0!==e.productImage?e.productImage.url:"";return t.isInStock=n,t},this.createVariantMap=function(e,t){var i=[];if(t)for(var n=0;n<e.products.length;n++)i[e.products[n].id]=[],i=this.loopVariants(e.products[n],i);else i[e.id]=[],i=this.loopVariants(e,i);return i},this.loopVariants=function(e,t){for(var i=0;i<e.variants.length;i++){var n=e.variants[i].variantId;t[e.id][n]=e.variants[i]}return t},this.mergeJsons=function(e,t){var i=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(t));for(var r in n)try{i[r]=n[r]}catch(s){console.warn("couldn't merge JSONS: "+s)}return i}}}),define("Models/VariantDecorator",[],function(){function e(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return i}return function(){var t=this;t.getData=function(t,i){i=void 0===i?!1:i;var n=void 0!==t.productImage?[t.productImage]:t.images,r={};if(n)for(var s=0;s<n.length;s++){var o=n[s];if(o.colourWayId){var a=r[o.colourWayId];void 0===a&&(r[o.colourWayId]=o.colour)}}var c=t.variants;c.sort(function(e,t){var i=t.colour.localeCompare(e.colour);return 0===i?t.sizeOrder-e.sizeOrder:i});var l,d=t.productId?t.productId:t.id,u=c.length,h={},p={productId:d,colours:[],rrpPrice:void 0,maxPrevPrice:void 0,minPrice:void 0,isInStock:!1},m=0;for(c.length>0&&c[0].price.isOutletPrice&&(p.rrpPrice=c[0].price.rrp);u--;){var f=c[u];f.productId=d,void 0===p.hasDifferentPrices&&f.isInStock&&(void 0===l?l=f.price.current:f.price.current.value!==l.value&&(p.hasDifferentPrices=!0));var v=i||f.isInStock;v&&(void 0===p.minPrice||p.minPrice.value>f.price.current.value)&&(p.minPrice=f.price.current);var g=f.isInStock;f.colourName=r[f.colourWayId];var b=h[f.colour];void 0===b&&(p.colours.push({colour:f.colour,colourName:f.colourName,variants:[],colourWayId:f.colourWayId}),b=h[f.colour]={index:m,variantsInStock:0},m++),g&&(b.variantsInStock++,p.isInStock||(p.isInStock=!0));var y=p.colours[b.index];y.variants.push(f),(void 0===b.lowestPrice||b.lowestPrice.value>f.price.current.value)&&(b.lowestPrice=f.price.current),void 0===p.rrpPrice&&f.price.isMarkedDown&&(void 0===b.maxPreviousPrice||b.maxPreviousPrice.value<f.price.previous.value)&&(b.maxPreviousPrice=f.price.previous)}for(var S=Object.keys(h),w=S.length-1;w>=0;w--){var k=S[w],_=h[k],I=e(p.colours,function(e){return e.colour===k});i||0!==_.variantsInStock?(void 0!==_.maxPreviousPrice&&(void 0===p.maxPrevPrice||p.maxPrevPrice.value<_.maxPreviousPrice.value)&&(p.maxPrevPrice=_.maxPreviousPrice),p.colours[I].price=_.lowestPrice,p.colours[I].prevPrice=_.maxPreviousPrice):p.colours.splice(I,1)}return p}}}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!Components/product-image/product-image.html",[],function(){return'<div class="grid-row">\r\n    <img data-bind="attr: { src: imgUrl }"/>\r\n    <!-- ko if: !hideSaveButton -->\r\n        <div data-bind=\'component:{\r\n            name: "save-button",\r\n            params:{\r\n                productId: productId,\r\n                state: state,\r\n                productImage: imgUrl,\r\n                context: context,\r\n                productData: productData\r\n            }\r\n        }\'></div>\r\n    <!-- /ko -->\r\n</div>\r\n'}),define("ProductUtils/Analytics/Utils/Common",["ProductUtils/UrlUtils"],function(e){function t(){var e=decodeURI(o.getUrlParam("SearchQuery")),t=o.getUrlParam("cid");if(t)return t;if("null"!==e)return"search";var i=o.getUrlParam("ctaref");if(i){if(/bag/i.test(i))return"basket page";if(/saved items/i.test(i))return"saved items";if(/wishlists/i.test(i))return"wishlists"}return"product page"}function i(e){return e.map(function(e){return e.split("=")[0]})}function n(){return["eVar1","eVar6","eVar10","eVar15","eVar17","eVar18","eVar19","eVar20","eVar29","eVar30","eVar45","eVar47","eVar60","eVar61","eVar69","eVar112","eVar113"]}function r(e,t){return/;;;;evar/i.test(e)?e+"|"+t:e+";;;;"+t}function s(e){return{buythelook:"buy the look",youmightlike:"you might also like",oosproduct:"oos product page",main:"product page"}[e.toLowerCase()]}var o=new e;return{getChannel:t,getLinkTrackEvents:i,getGlobalEvars:n,addMerchEVarToProducts:r,getProductAreaAttribute:s}}),define("ProductUtils/Analytics/PageLoad",["PageConfig","ProductUtils/UrlUtils","ProductUtils/Analytics/Utils/Common"],function(e,t,i){function n(e){return e.reduce(function(e,t){return e[t.size]||e.push(t.size),e},[]).length}function r(e){return e.filter(function(e){return e.isInStock===!0}).length}function s(e){var t=[];if(!e)return"";for(var i=0;i<e.length;i++){var n=e[i];t.push("variantstockstatus:"+n.variantId+"_"+(n.isInStock?"1":"0"))}return t.join(",")}function o(){var e=window.innerHeight||"",t=window.innerWidth||"";return"number"==typeof t&&"number"==typeof e?t+":"+e:""}function a(e,t){return Math.floor(100-e/t*100).toString()}return function(c){var l=window.s,d=new t,u=e.storeCode.toLowerCase(),h=[],p=e.countryCode.toLowerCase(),m=e.currency.toLowerCase();if(l.pageName=e.platform+" "+u+"|"+c.pageType+"|"+e.pageTitle,l.channel=i.getChannel(),l.server=e.platform+" "+u,l.campaign=l.getCampaignID(),l.products=";"+c.productId,l.eVar1=l.getVisitNum(),l.eVar17=l.getNewRepeat(365),l.eVar19=o(),d.getUrlParam("SearchQuery")&&(l.eVar25=d.getUrlParam("SearchQuery")),"performance"in window){var f=window.performance.timing;l.eVar29=f.responseStart-f.navigationStart,l.eVar30=f.domContentLoadedEventEnd-f.navigationStart,h.push("event128="+l.eVar30)}else window.performance={now:function(){return 0}};if(l.eVar45=e.version,l.eVar70=l.getBagItems(),l.eVar112=p,l.eVar113=m,l.prop5=l.getCustomTimeDate(),d.getUrlParam("CTAref")&&(l.prop6=d.getUrlParam("CTAref").toLowerCase()),l.prop8="product page",l.prop10=l.getPreviousValue(l.pageName,"gpv_p10","").toLowerCase(),l.prop11=encodeURI(window.location.href.replace(/%20/gi,"+")),"product"===c.pageType){var v=s(c.product.variants),g=c.product.variants.length,b=r(c.product.variants),y=0===g?"0":(b/g*100).toFixed(2)+"%|",S=void 0!==c.product.productPrice?c.product.productPrice:c.product.price;if(l.eVar26=n(c.product.variants),l.eVar31=l.eVar36=g+"|"+b+"|"+y+"null|null|null|null|null|null",c.product.sellingFast&&(l.eVar152="selling fast"),c.product.shippingRestrictions&&c.product.shippingRestrictions.shippingRestrictionsVisible&&h.push("event217"),c.zeekitEnabled&&h.push("event243"),c.product.media&&c.product.media.catwalkUrl.length&&h.push("event245"),S.rrp.value?l.eVar161=a(S.current.value,S.rrp.value):l.eVar161=a(S.current.value,S.previous.value),c.isInStock?g===b?h.push("event43"):h.push("event44"):h.push("event45"),l.list1=v,c.product.hasPaymentPromotionAvailable){var w=Object.keys(c.product.paymentPromotions).filter(function(e){return S.current.value>=c.product.paymentPromotions[e][p][m].minimumTransactionAmount&&S.current.value<=c.product.paymentPromotions[e][p][m].maximumTransactionAmount});w&&(l.prop66=w.join(","))}}else{l.eVar181="mix & match",h.push("event15");var k="";for(var _ in c.mixAndMatch.productIds)k+=";"+c.mixAndMatch.productIds[_]+",";k=k.slice(0,-1),l.products=k,c.isInStock?h.push("event43"):h.push("event45")}h.push("prodView"),h.push("event1"),h.push("event35"),l.events=h.join(","),l.linkTrackEvents=i.getLinkTrackEvents(h).join(","),l.setContentHierarchy("product page",e.breadcrumb),l.t()}}),define("Providers/localFeaturesManifest",[],function(){return{features:{"pdp-fit-assistant-logging":{probability:0}},mvt:{"emf-64-web-zeekit-v2":{},"emf-86-web-klarna-us-desktop":{},"emf-56-web-klarna-us-mweb":{},"emf-85-web-klarna-clearpay-uk-desktop":{},"emf-80-web-klarna-clearpay-uk-mweb":{},"emf-109-pdp-expanded-details":{}}}}),define("Providers/SdkProvider",["Promise","Providers/localFeaturesManifest"],function(e,t){function i(t){return function(){return new e(function(e){var i=function(){e(window.asos.sdk[t])};window.asos.sdk&&window.asos.sdk[t]?i():window.asos.eventBus.once(t+"-sdk-ready",function(){i()})})}}function n(){var n=new e(function(e){i("features")().then(function(i){i.addManifest(t,{}),e(i)})});return function(){return n}}return{getSavedItems:i("savedItems"),getBag:i("bag"),getIdentity:i("identity"),getFeatures:n()}}),define("ProductUtils/Analytics/Utils/FitAnalytics",["Providers/SdkProvider","PageConfig"],function(e,t){function i(e){switch(e){case 1:return"first time interaction";case 2:return"partial recommendation";case 3:return"full recommendation";case 4:return"recommendation not in stock"}}function n(){return e.getIdentity()}function r(e){return e.customer.profile()}function s(e){return function(t){var n=t.isRecognised||t.isAuthenticated?c:l,r=i(e.recommendationType)?i(e.recommendationType):d,s=e.hasPreviousPurchaseData?u:h,o=e.bodyCategory?e.bodyCategory.toLowerCase():p;return n+"-"+r+"-"+s+"-"+o}}function o(e){return n().then(r).then(s(e))}function a(e){var i=e.recommendedSize?e.recommendedSize.toLowerCase():m;return t.storeCode.toLowerCase()+"|"+i}var c="signed in",l="not signed in",d="no state set",u="previous purchase data",h="no previous purchase data",p="no body category set",m="no recommended size set",f="no viewed screens set";return{getFitAnalyticsState:o,getFitAnalyticsSize:a,states:{SIGNED_IN:c,SIGNED_OUT:l,NO_RECOMMENDATION_STATE:d,PREVIOUS_PURCHASES:u,NO_PREVIOUS_PURCHASES:h,NO_BODY_CATEGORY:p,NO_RECOMMENDED_SIZE:m,NO_VIEWED_SCREENS:f}}}),define("ProductUtils/Analytics/Utils/Performance",[],function(){function e(){if(!window.performance.getEntriesByType)return[];var e=window.performance.getEntriesByType("measure");return e.filter(function(e){return t.indexOf(e.name)>-1}).map(function(e,t){var n=i[t];return{eVar:n.eVar,event:n.event,duration:Math.floor(e.duration)}})}var t=["pdp:start","pdp:hero_image_displayed","pdp:title_displayed","pdp:stock_api_returned","pdp:price_displayed","pdp:size_selector_interactive","pdp:add_to_bag_interactive","pdp:save_for_later_interactive"],i=[{eVar:"eVar163",event:"event233"},{eVar:"eVar164",event:"event234"},{eVar:"eVar165",event:"event235"},{eVar:"eVar166",event:"event236"},{eVar:"eVar167",event:"event237"},{eVar:"eVar168",event:"event238"},{eVar:"eVar169",event:"event239"},{eVar:"eVar170",event:"event240"}];return{performanceMetricsToGather:t,getPerformanceMetricsValues:e}}),define("ProductUtils/Analytics/FitAnalytics",["ProductUtils/Analytics/Utils/FitAnalytics","ProductUtils/Analytics/Utils/Common","ProductUtils/Analytics/Utils/Performance"],function(e,t,i){function n(e,t){if(e&&t){for(var i=e+"_"+t,n=0;n<o.length;n++)if(i.match(o[n]))return;var r=s[i];return r?r:e+":"+t}}function r(e){var t=[];if(e.widgetScreenEvents)for(var i=0;i<e.widgetScreenEvents.length;i++){var r=e.widgetScreenEvents[i],s=n(r.event,r.value);s&&t.push(s)}return t.join(",")}var s={entryScreen_landed:1,entryScreen_submit:2,entryScreen_tooltip:3,immediateRecommendation_upper:11,immediateRecommendation_lower:12,immediateRecommendation_shoes:13,bcScreen_landed:14,bcScreen_skip:15,bcScreen_submit:16,lbwBcScreen_landed:17,lbwBcScreen_skip:18,lbwBcScreen_submit:19,managePurchasesScreen_landed:20,managePurchasesScreen_submit:21,managePurchasesScreen_skip:22,lbwRiseScreen_landed:23,lbwRiseScreen_submit:24,lbwSizeSelectScreen_landed:25,lbwSizeSelectScreen_submit:26,lbwCategoryScreen_landed:27,lbwCategoryScreen_submit:28,lbwCategoryScreen_skip:29,
shapeSelectScreen_1_landed:30,shapeSelectScreen_1_skip:31,shapeSelectScreen_1_submit:32,shapeSelectScreen_1_tooltip:33,shapeSelectScreen_2_landed:34,shapeSelectScreen_2_skip:35,shapeSelectScreen_2_submit:36,shapeSelectScreen_2_tooltip:37,ageScreen_landed:38,ageScreen_skip:39,ageScreen_submit:40,braScreen_landed:41,braScreen_skip:42,braScreen_submit:43,resultsScreen_initial_landed:44,resultsScreen_final_landed:45,sizeRecommendation_returning_lower_results_sp:46,sizeRecommendation_returning_upper_results_sp:47,sizeRecommendation_upper_results_sp:48,sizeRecommendation_lower_results_sp:49,sizeRecommendation_out_of_scale:50,close_lower_results_sp:51,close_upper_results_sp:52,close_brand_compare:53,close_upper_form:54,close_lower_form:55,close_upper_out_of_scale:56,outOfScaleScreen_landed:57,loadingScreen_open:58,loadingScreen_close:59,loadingScreen_timeout:60,entryScreen_close:61,outOfScaleScreen_back:62,outOfScaleScreen_close:63,brandCompareScreen_landed:64,brandCompareScreen_back:65,brandCompareScreen_submit:66,brandCompareScreen_close:67,brandCompareScreen_skip:68,initialResultsScreen_landed:69,initialResultsScreen_close:70,initialResultsScreen_back:71,finalResultsScreen_landed:72,finalResultsScreen_close:73,finalResultsScreen_back:74,tummyShapeScreen_landed:75,tummyShapeScreen_back:76,tummyShapeScreen_submit:77,tummyShapeScreen_close:78,tummyShapeScreen_skip:79,hipShapeScreen_landed:80,hipShapeScreen_back:81,hipShapeScreen_submit:82,hipShapeScreen_close:83,hipShapeScreen_skip:84,ageScreen_back:86,ageScreen_close:88,braScreen_back:91,braScreen_close:93,managePurchasesScreen_back:96,managePurchasesScreen_close:98,lowerCategoryScreen_landed:100,lowerCategoryScreen_back:101,lowerCategoryScreen_submit:102,lowerCategoryScreen_close:103,lowerCategoryScreen_skip:104,fitPreferenceScreen_landed:105,fitPreferenceScreen_submit:106,genderScreen_landed:107,genderScreen_submit:108,immediateRecommendation_out_of_scale:109,lowerBrandScreen_landed:110,lowerBrandScreen_skip:111,lowerBrandScreen_submit:112,lowerModelScreen_landed:113,lowerSizeScreen_landed:114,lowerSizeScreen_submit:115,resultsScreen_returned_landed:116,resultsScreen_submitted_landed:117,shoesBrandScreen_landed:118,shoesBrandScreen_submit:119,shoesSizeScreen_landed:120,shoesSizeScreen_submit:121,shoesWidthScreen_landed:122,shoesWidthScreen_submit:123,"warningScreen_error: loading timeout":124,"warningScreen_error: no fit indicators for result screen":125,"warningScreen_warning: long loading time":126,chestShapeScreen_landed:127,chestShapeScreen_submit:128,close_age:129,close_body_mass:130,close_body_shape:131,close_bra:132,close_fit:133,close_gender:134,close_lower_brand:135,close_lower_size:136,close_lower_type_mobile:137,close_manage_purchases:138,close_out_of_scale:139,close_results:140,close_shoes_brand:141,close_shoes_size:142,close_shoes_type_mobile:143,close_shoes_width_mobile:144,close_warning:145,lowerRiseScreen_landed:146,shoesCategoryScreen_landed:147,shoesCategoryScreen_submit:148,shoesModelScreen_landed:149,shoesModelScreen_skip:150,shoesModelScreen_submit:151,sizeRecommendation_lower_results:152,sizeRecommendation_returning_lower_results:153,sizeRecommendation_returning_shoes_results:154,sizeRecommendation_returning_upper_results:155,sizeRecommendation_shoes_results:156,sizeRecommendation_upper_results:157},o=[/^(resultsScreen_close)$/,/^(shapeSelectScreen_close)$/,/^(shoes_type_close)$/,/^(suggestBrand).*/,/^(enterData).*/];return function(n){var s=window.s;return e.getFitAnalyticsState(n.faContext).then(function(o){var a={},c=n.faContext,l=n.commons,d=e.states.NO_VIEWED_SCREENS,u=[],h=n.context.toLowerCase(),p=r(c)?r(c):d;if("fit analytics impression"===h){var m=i.getPerformanceMetricsValues();m.forEach(function(e){s[e.eVar]=e.duration,u.push(e.event+"="+e.duration)}),u.push("event50"),u.push("event114")}else"launch widget"===h?(u.push("event51"),u.push("event124")):"close widget"===h&&(s.prop70=p,u.push("event124"));s.prop36=o,s.eVar50=e.getFitAnalyticsSize(c),s.events=u.join(","),a.linkTrackVars=l.setLinkTrackVars(["prop36","prop70","eVar50","eVar163","eVar164","eVar165","eVar166","eVar167","eVar168","eVar169","eVar170"].concat(t.getGlobalEvars())),a.linkTrackEvents=l.setLinkTrackEvents(t.getLinkTrackEvents(u)),s.tl(!0,"o",h,a)})}}),define("ProductUtils/Analytics/SaveForLater",["PageConfig","ProductUtils/Analytics/Utils/Common","ProductUtils/Analytics/Utils/FitAnalytics"],function(e,t,i){function n(e,t){e.tl(!0,"o","save for later click",t)}return function(r){var s=window.s,o={},a=[],c=r.commons,l=r.saveForLaterType.toLowerCase();s.products=";"+(r.product.variantId||r.product.productId);var d=t.getProductAreaAttribute(l);return s.eVar92=d,s.products=t.addMerchEVarToProducts(s.products,"eVar13="+d),"main"===l&&(r.sellingFast&&(s.products=t.addMerchEVarToProducts(s.products,"eVar151=selling fast")),"mix&match"===e.pageType&&(s.products=t.addMerchEVarToProducts(s.products,"eVar182=mix & match"))),a.push("event10"),s.prop32="save for later",s.events=a.join(","),o.linkTrackVars=c.setLinkTrackVars(["eVar66","eVar67","eVar92"].concat(t.getGlobalEvars())),o.linkTrackEvents=c.setLinkTrackEvents(t.getLinkTrackEvents(a)),r.faContext?i.getFitAnalyticsState(r.faContext).then(function(e){s.products=t.addMerchEVarToProducts(s.products,"eVar150="+e)}).then(function(){n(s,o)}):void n(s,o)}}),define("ProductUtils/Analytics/AddToBag",["PageConfig","ProductUtils/Analytics/Utils/FitAnalytics","ProductUtils/Analytics/Utils/Common"],function(e,t,i){function n(e){return e.reduce(function(e,t){var i=void 0===t.price.current?t.price:t.price.current.value;return e+i},0)}function r(e,t){return Math.round(100-e/t*100).toString()}function s(e,t,n,r,s,o){e.events=s.join(","),t.linkTrackVars=n.setLinkTrackVars(o),t.linkTrackEvents=n.setLinkTrackEvents(i.getLinkTrackEvents(s)),e.tl(!0,"o",r,t)}return function(o){function a(){s(c,l,d,h,m,f)}for(var c=window.s,l={},d=o.commons,u=o.context.toLowerCase(),h="add to bag",p=[],m=[],f=["prop38","eVar66","eVar67","prop75","eVar91","eVar92","eVar151","eVar152"].concat(i.getGlobalEvars()),v=0;v<o.variants.length;v++)p.push(o.variants[v].variantId);c.products=";"+p.join(",;");var g=i.getProductAreaAttribute(o.addToBagType);if(c.eVar92=g,c.products=i.addMerchEVarToProducts(c.products,"eVar13="+g),"main"===o.addToBagType&&"mix&match"===e.pageType&&(c.products=i.addMerchEVarToProducts(c.products,"eVar182=mix & match")),"addtobagerror"===u?(h="add to bag error",m.push("event149"),c.prop38=o.errorId+"|"+o.errorCode):(m.push("event150="+o.variants.length),m.push("event151="+n(o.variants)),m.push("scAdd"),m.push("scOpen")),"product page"===g){if(o.variants.length){if(o.variants[0].priceObj.rrp)var b=o.variants[0].priceObj.rrp.value;var y=o.variants[0].priceObj.current.value;if(b)c.eVar161=r(y,b);else{var S=o.variants[0].priceObj.previous.value;c.eVar161=r(y,S)}o.variants[0].zeekitEnabled&&(c.eVar67="zeekit modal impression"),o.variants[0].sellingFast&&(c.products=i.addMerchEVarToProducts(c.products,"eVar151=selling fast"))}if(f=f.concat(["prop36","eVar50","eVar51","eVar150","eVar161"]),o.faContext)return t.getFitAnalyticsState(o.faContext).then(function(e){c.prop36=c.eVar150=e,c.products=i.addMerchEVarToProducts(c.products,"eVar150="+e),c.eVar50=c.eVar51=t.getFitAnalyticsSize(o.faContext)}).then(function(){a()});a()}else a()}}),define("ProductUtils/Analytics/PageInteraction",["ProductUtils/Analytics/Utils/Common"],function(e){return function(t){function i(t){b.events=v.join(","),m.linkTrackVars=f.setLinkTrackVars(["prop15"].concat(e.getGlobalEvars())),m.linkTrackEvents=f.setLinkTrackEvents(e.getLinkTrackEvents(v)),b.tl(!0,"o",t,m)}function n(){var e="social share intent";t.eventData.socialPlatform&&(e=e.concat("|"+t.eventData.socialPlatform)),b.prop15=e,i("social share")}function r(){"undefined"==typeof window.trackingEventMore&&(window.trackingEventMore=1,b.prop15="show more",i("show more click"))}function s(){"undefined"==typeof window.trackingEventLess&&(window.trackingEventLess=1,b.prop15="show less",i("show less click"))}function o(){"undefined"==typeof window.trackingShippingRestrictionsClick&&(window.trackingShippingRestrictionsClick=1,b.prop15="shipping restrictions",i("shipping restrictions click"))}function a(){b.prop15="free delivery and returns",v.push("event95"),i("free delivery and returns click")}function c(){b.prop15="launch size guide",v.push("event103"),i("size guide click")}function l(){b.prop15="mix and match|open modal",i("mix and match modal click")}function d(){"undefined"==typeof window.trackingChangeThumbnail&&(window.trackingChangeThumbnail=1,b.prop15="product chevron click",i("product chevron click"))}function u(){b.prop15=g,i(g)}function h(){b.prop15="video progress "+t.eventData.videoEvent,i(g)}function p(){var e="zeekit modal click";b.prop15=e,i(e)}var m={},f=t.commons,v=[],g=t.eventData.context.toLowerCase(),b=window.s;t.eventData.productIID&&(b.products=";"+t.eventData.productIID),v.push("event18");var y={socialshare:n,launchsizeguide:c,freedeliveryandreturns:a,shippingrestrictions:o,showmore:r,showless:s,openmodal:l,chevronclick:d,"360launch":u,"360zoom":u,thumbnailclick:u,video:h,zeekitopened:p};y[g]()}}),define("ProductUtils/Analytics/Signal",["jquery","PageConfig","ProductUtils/UrlUtils"],function(e,t,i){function n(i,n){var r={keyStoreDataVersion:t.keyStoreDataversion,selectedCountry:t.countryCode,selectedCurrency:t.currency,selectedLanguage:t.language,selectedSizeSchema:t.sizeSchema,sitechromeTemplateVersion:t.siteChromeTemplateVersion};Object.keys(r).forEach(function(e){n[e]=r[e]}),e(window).trigger("tracking.productPage."+i,n)}function r(e){return e.filter(function(e){return e.isInStock===!0}).length}function s(e){return e.reduce(function(e,t){return e[t.size]||e.push(t.size),e},[]).length}function o(e){return e.map(function(e){return{variantId:e.variantId,variantSku:e.sku,stockStatus:e.isInStock?"in stock":"out of stock"}})}function a(e){var i=void 0!==e.productPrice?e.productPrice:e.price;window.Product={ProductIID:e.id,ProductCode:e.productCode,OriginalPrice:i.xrp,CurrentPrice:i.current,AvailbleSku:r(e.variants),AvailibleSizes:s(e.variants),ProductURL:document.querySelector("link[rel=canonical]").href,CID:u.getUrlParam("cid"),BreadCrumb:t.breadcrumb,Platform:t.platform,StoreID:t.storeId,PageType:"product",PageName:t.pageTitle,Channel:t.gender,ProductCategoryName:t.breadcrumb.split("/").splice(2).join(" | "),VariantStockStatus:o(e.variants)},n("pageLoad",window.Product)}function c(e){window.Product={ProductURL:document.querySelector("link[rel=canonical]").href,CID:u.getUrlParam("cid"),BreadCrumb:t.breadcrumb,AvailibleProducts:e.productIds,Platform:t.platform,PageType:"mix&match",PageName:t.pageTitle,Channel:t.gender,ProductCategoryName:t.breadcrumb.split("/").splice(2).join(" | ")},n("pageLoad",window.Product)}function l(e,t){var i=[],r=0;e=void 0===e.length?[e]:e;for(var s=0;s<e.length;s++){var o=void 0===e[s].price.current?e[s].price:e[s].price.current.value;r+=o,i.push({productIID:e[s].productId,variantIID:e[s].variantId,units:e.length,salePrice:o,sellingFast:e[s].sellingFast})}var a={context:"addToBag",totalValue:r,productsAdded:i.length,addToBagType:t,products:i};n("addToBag",a)}function d(e,t){t=void 0===t?"main":t;for(var i=0;e.length>i;i++)n("saveForLater",{context:"saveForLater",productIID:e[i].productId,variantIID:e[i].variantId,saveForLaterType:t,SellingFast:e[i].sellingFast})}var u=new i;return{singleProductPageLoad:a,mixAndMatchProductPageLoad:c,addToBag:l,saveForLater:d}}),define("ProductUtils/Analytics",["ProductUtils/Analytics/PageLoad","ProductUtils/Analytics/FitAnalytics","ProductUtils/Analytics/SaveForLater","ProductUtils/Analytics/AddToBag","ProductUtils/Analytics/PageInteraction","ProductUtils/Analytics/Signal"],function(e,t,i,n,r,s){var o=function(){var o;window.CommonAnalytics&&(o=new window.CommonAnalytics),this.firePageInteraction=function(e){r({eventData:e,commons:o})},this.normalizeError=function(e,t){var i=[{errorCode:null,errorMessage:t}];return e.message=Array.isArray(e.message)?e.message:i,e},this.addVariants=function(e,t,i,r){e=void 0===e.length?[e]:e,void 0===i&&(i="main"),t?n({context:"addToBagError",addToBagType:i,variants:e,errorCode:t.message[0].errorCode,errorId:t.message[0].errorMessage,faContext:r,commons:o}):(n({context:"addToBag",addToBagType:i,variants:e,faContext:r,commons:o}),s.addToBag(e,i))},this.saveVariants=function(e,t,n){var r;void 0===n&&(n="main",r=t.fitAnalyticsContext);for(var a=0;e.length>a;a++)i({product:e[a],saveForLaterType:n,commons:o,sellingFast:t.sellingFast,faContext:r}),s.saveForLater(e,n)},this.fireFitAnalyticsOpenWidgetEvent=function(e){t({context:"launch widget",commons:o,faContext:e})},this.fireFitAnalyticsOutOfScaleEvent=function(e){t({context:"out of scale",commons:o,faContext:e})},this.fireFitAnalyticsCloseWidgetEvent=function(e){t({context:"close widget",commons:o,faContext:e})},this.fireFitAnalyticsLoadEvent=function(e){t({context:"fit analytics impression",commons:o,faContext:e})},this.fireProductLoadEvent=function(t,i){e({pageType:"product",productId:t.id,isInStock:t.isInStock,product:t,zeekitEnabled:i.zeekitEnabled}),s.singleProductPageLoad(t)},this.fireMixMatchLoadEvent=function(t){e({pageType:"mix&match",productId:t.id,isInStock:this.mixMatchInStock(t.products),mixAndMatch:{productIds:t.productIds}}),s.mixAndMatchProductPageLoad(t)},this.mixMatchInStock=function(e){for(var t=!1,i=0;i<e.length;i++)e[i].isInStock&&(t=!0);return t}};return new o}),define("ProductUtils/Bag",["ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider"],function(e,t,i){return function(n,r){function s(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function o(e){return{productId:e.productId,colour:e.colourName,sizeId:e.sizeId,variantId:e.variantId,price:e.price.current.value,priceObj:e.price,sellingFast:n.state.sellingFast,zeekitEnabled:n.state.zeekitEnabled}}return this.error="",void 0!==n&&(this.error=n.state.resources.pdp_status_error_max_items),this.addItems=function(e,t){i.getBag().then(function(i){var n,s=e.length>1;if(s){var a=this.formatAddProducts(e);n=i.addVariants(a),this.watchPromise(n,t,a,r)}else{var c=void 0!==e[0]?e[0]:e;c.colourName=void 0===c.colourName?c.colour:c.colourName;var l=o(c);n=i.addVariant(l),this.watchPromise(n,t,l,r)}}.bind(this))},this.formatErrorMessage=function(e){var t=e.userMessage||"";return e.hasOwnProperty("messageContext")&&e.messageContext&&e.messageContext.length>0&&(t=t.replace(/{(\d)}/g,function(t,i){var n=e.messageContext[parseInt(i,10)];return n?n:"..."})),t},this.watchPromise=function(i,r,o,a){i.then(function(){return e.addVariants(o,!1,a,n.state.fitAnalyticsContext),r({success:!0,error:""})},function(i){i=e.normalizeError(i,n.state.resources.pdp_status_add_to_bag_failure),e.addVariants(o,i,a,n.state.fitAnalyticsContext);var c={action:"AddToBag"};c=s(c,o),c=s(c,i),c=s(c,i.message[0]),t.logError(new Error(t.ERROR_TYPE.UserActionFailed),c);var l;l="LegacyQuantityLimitReached"===i.message[0].errorCode?this.error:this.formatErrorMessage(i.message[0]),r({success:!1,error:l})}.bind(this))},this.formatAddProducts=function(e){for(var t=[],i=0;i<e.length;i++){var n=o(e[i]);n.colourName=void 0===n.colourName?n.colour:n.colourName,t.push(n)}return t},this}}),define("Components/product-image/product-image",["ko","text!./product-image.html","ProductUtils/Bag"],function(e,t,i){function n(t){this.imgUrl=t.imgUrl;var n=t.data,r=new i;this.state=t.state,this.productId=t.productId,this.saveForLaterCalled=e.observable(!1),this.context=t.context,this.productData=t.productData,this.saveForLater=function(){this.saveForLaterCalled()!==!0&&(r.saveProduct(n),this.saveForLaterCalled(!0))}.bind(this),this.hideSaveButton=t.hideSaveButton}return{viewModel:n,template:t}}),define("text!Components/product-price/product-price.html",[],function(){return'<div class="grid-row rendered" data-bind="attr: {\'aria-label\': getAriaLabel()}">\r\n  <span aria-hidden="true">\r\n    <span data-id="rrp-price" data-bind="text: rrpPriceText, visible: showRrpPrice" class="product-prev-price"> </span>\r\n    <span data-id="previous-price" data-bind="text: prevPriceText, visible: showPrevPrice" class="product-prev-price"></span>\r\n    <span data-id="from-price" data-bind="visible: showFromLabel, text: fromLabelText, css: { \'price-from-discounted\' : isDiscountedPrice }" class="price-from"></span>\r\n    <span class="current-price-container">\r\n        <span data-id="current-price" data-bind="text: priceText(), css: {\'product-price-discounted\' : isDiscountedPrice }, markAndMeasure: \'pdp:price_displayed\'" class="current-price"></span><span data-bind="text: discountText(), visible: isDiscountedPrice" class="product-discount-percent"></span>\r\n    </span>\r\n    <span data-id="german-vat-message" data-bind="text: i18n.pdp_misc_vat_message, visible: showGermanVatMessage" class="product-german-vat"></span>\r\n  </span>\r\n</div>\r\n<!-- ko if: showPrevPrice -->\r\n<div class="clear-element"></div>\r\n<!-- /ko -->'}),define("ProductUtils/Discount",["ko","Providers/SdkProvider"],function(e,t){function i(e,t){return"(-"+Math.floor(100-e/t*100).toString()+"%)"}function n(e,t,n){return r()?void e(i(t,n)):(s.push({observable:e,currentPrice:t,previousPrice:n}),e(""))}var r=e.observable(!1),s=[];return t.getFeatures().then(function(e){r(e.ifActive("plp-show-discount-label"))}),r.subscribe(function(e){e&&s.forEach(function(e){e.observable(i(e.currentPrice,e.previousPrice))})}),{getDiscountText:n}}),define("Components/product-price/product-price",["ko","text!./product-price.html","ProductUtils/Ajax","ProductUtils/Discount"],function(e,t,i,n){function r(t){var r=t.state,s=r.productData;this.i18n=r.resources,this.ajax=new i,this.showRrpPrice=void 0!==s.rrpPrice,this.rrpPriceText=this.showRrpPrice?this.i18n.pdp_price_rrp+" "+s.rrpPrice.text:"",this.showGermanVatMessage=t.showGermanVatMessage?!0:!1,this.prevPrice=e.computed(function(){return void 0===r.selectedColour()&&void 0!==s.maxPrevPrice?s.maxPrevPrice:void 0!==r.selectedColour()&&void 0!==r.selectedColour().prevPrice?r.selectedColour().prevPrice:void 0}.bind(this)),this.prevPriceText=e.computed(function(){return this.prevPrice()?this.prevPrice().text:""}.bind(this)),this.showPrevPrice=e.computed(function(){return""!==this.prevPriceText()}.bind(this)),this.showFromLabel=e.computed(function(){return void 0===s.hasDifferentPrices?!1:void 0!==r.selectedColour()?!1:!0}),this.fromLabelText=this.i18n.pdp_misc_from,this.isDiscountedPrice=e.computed(function(){return this.showPrevPrice()||this.showRrpPrice}.bind(this));var o;o=void 0===r.selectedColour()?s.minPrice:r.selectedColour().price,this.price=e.observable(o),t.isDisplayPrice&&this.price.subscribe(function(e){t.state.displayPrice(e.value)}.bind(this)),this.discountText=e.observable(""),this.showRrpPrice?this.price()&&s.rrpPrice&&n.getDiscountText(this.discountText,this.price().value,s.rrpPrice.value):this.price()&&this.prevPrice()&&n.getDiscountText(this.discountText,this.price().value,this.prevPrice().value),this.priceText=e.computed(function(){return void 0===this.price()?"":this.price().text}.bind(this)),this.getAriaLabel=e.computed(function(){var e="";this.showPrevPrice()&&(e=e.concat(this.i18n.pdp_price_was," ",this.prevPriceText())),this.showRrpPrice&&(e=e.concat(this.i18n.pdp_price_rrp_longform||this.i18n.pdp_price_rrp," ",s.rrpPrice.text));var t=this.isDiscountedPrice()?this.i18n.pdp_price_sale:this.i18n.generic_current_price;return e=e.concat(" "+t+" "+this.priceText()+" "+this.discountText()),this.showGermanVatMessage&&(e=e.concat(" ",this.i18n.pdp_misc_vat_message_longform||this.i18n.pdp_misc_vat_message)),e}.bind(this)),r.selectedColour.subscribe(function(e){e?this.price(e.price):this.price(s.minPrice)}.bind(this))}return{viewModel:r,template:t}}),define("text!Components/social-share/social-share.html",[],function(){return'<button\r\n    class="link social-share-icon"\r\n    id="social-share-button"\r\n    data-bind="click: toggleShareIcons, clickBubble: false, attr: { \'aria-expanded\': isVisible }"\r\n    aria-haspopup="true"\r\n    aria-controls="share-bar"\r\n>\r\n    <span class="product-share-icon" data-bind="attr: { \'aria-label\': state.resources.pdp_cta_social_share }"></span>\r\n    <span class="social-share-text" aria-hidden="true" data-bind="text: state.resources.pdp_cta_social_share"></span>\r\n</button>\r\n<div class="share-bar-wrap" data-bind="visible: isVisible">\r\n    <div class="triangle-up"></div>\r\n    <ul role="menu" id="share-bar" aria-labelledby="social-share-button">\r\n        <!-- ko if : isRussia -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: vkLink }, click: handleClick" data-id="vk" aria-label="vk" class="product-vk-icon"></a></li>\r\n        <!-- /ko -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: facebookLink }, click: handleClick" data-id="facebook" aria-label="facebook" class="product-facebook-icon"></a></li>\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: pinterestLink }, click: handleClick" data-id="pinterest" aria-label=pinterest" class="product-pinterest-icon"></a></li>\r\n        <!-- ko if : isMobile -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: whatsappLink }, click: handleClick" data-id="whatsapp" aria-label="whatsapp" class="product-whatsapp-icon"></a></li>\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: emailLink }, click: fireAnalytics" data-id="email" aria-label="email" class="product-email-icon"></a></li>\r\n        <!-- /ko -->\r\n    </ul>\r\n</div>\r\n'}),define("Components/social-share/social-share",["ko","text!./social-share.html","PageConfig","ProductUtils/Analytics","ProductUtils/NewRelicLogger"],function(e,t,i,n,r){function s(t){function s(e){for(var t=[],i=Object.keys(e),n=0;n<i.length;n++){var r=i[n];t.push(r+"="+encodeURIComponent(e[r]))}return t.join("&")}this.isVisible=e.observable(!1),this.isMobile="mobile"===i.platform,this.isRussia="ru"===i.storeCode.toLowerCase();var o,a,c,l=t.data,d=l.images[0].url,u=document.querySelector("link[rel=canonical]").href;this.facebookLink="https://www.facebook.com/sharer/sharer.php?"+s({u:u+"?ctaref=product_share_facebook"}),this.vkLink="http://vk.com/share.php?"+s({url:u+"?ctaref=product_share_vk"}),this.pinterestLink="https://pinterest.com/pin/create/button/?"+s({url:u+"?ctaref=product_share_pinterest",media:d,description:l.name}),this.whatsappLink="https://wa.me/?"+s({text:l.name+" "+u+"?ctaref=product_share_whatsapp"}),this.emailLink="mailto:?"+s({subject:l.name,body:l.name+" "+u+"?ctaref=product_share_email"}),this.setClickListener=function(e){document.addEventListener("click",o=function(t){-1===e.indexOf(t.target)&&(this.isVisible(!1),document.removeEventListener("click",o))}.bind(this))}.bind(this),this.setKeydownListener=function(e,t,i){document.addEventListener("keydown",a=function(n){27===n.keyCode&&(e.focus(),this.isVisible(!1),document.removeEventListener("keydown",a)),("Tab"===n.key||9===n.keyCode)&&(n.shiftKey?document.activeElement===t&&(i.focus(),n.preventDefault()):document.activeElement===i&&(t.focus(),n.preventDefault()))}.bind(this))}.bind(this),this.fireAnalytics=function(e,t){var i,r=l.id+"";return t&&(i=t.target.dataset.id),n.firePageInteraction({context:"socialShare",socialPlatform:i,productIID:r}),!0},this.handleClick=function(e,t){this.fireAnalytics(e,t),window.open(t.target.href,"SocialShareWindow","width=700,height=600,resizable,scrollbars=yes,status=1")},this.openSocialShare=function(){var e=document.activeElement,t=Array.prototype.slice.call(e.parentElement.querySelectorAll("#share-bar, #share-bar a")),i=t.slice(1),n=i[0],r=i[i.length-1];return this.isVisible()?(this.isVisible(!1),void e.focus()):(c||(c=!0,this.fireAnalytics()),this.setClickListener(t),this.setKeydownListener(e,n,r),this.isVisible(!0),void n.focus())}.bind(this),this.toggleShareIcons=function(){navigator.share&&this.isMobile?navigator.share({title:l.name,text:l.name,url:u+"?ctaref=product_share_native"}).then(function(){this.fireAnalytics()}.bind(this))["catch"](function(e){r.logError(e),this.openSocialShare()}.bind(this)):this.openSocialShare()}.bind(this)}return{viewModel:s,template:t}}),define("Components/content/content",[],function(){function e(e){this.state=e.state,this.product=e.data}return{viewModel:e}}),define("text!Components/out-of-stock/out-of-stock.html",[],function(){return'<!-- ko if: !inStock -->\r\n    <!-- ko if: productCode -->\r\n    <p class="product-code">\r\n        <span class="label" data-bind="text:productCodeLabel"></span>\r\n        <span data-bind="text:productCode"></span>\r\n    </p>\r\n    <!-- /ko -->\r\n    \r\n<div data-bind="visible: isMoreFromMessageVisible()"> \r\n    <div class="more-from">\r\n        <h2 data-bind="text:moreFromMessage"></h2>\r\n\r\n        <ul data-bind="foreach: moreFrom">\r\n            <li><a href="#" data-bind="attr: { href: $parent.getTrackedLinkUrl(linkUrl) }, text: friendlyName"></a></li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n<!-- /ko -->\r\n'}),define("Components/out-of-stock/out-of-stock",["ko","text!./out-of-stock.html"],function(e,t){function i(e){var t=e.state;if(this.inStock=t.productData.isInStock,this.inStock)return!1;this.moreFromMessage=t.resources.pdp_carousel_more_from_title,this.productCodeLabel=t.resources.pdp_description_product_code_title,this.productCode=e.data.productCode;var i=e.data;this.moreFrom=i.categories,this.isMoreFromMessageVisible=function(){return!1},this.getTrackedLinkUrl=function(e){return e+(-1===e.indexOf("?")?"?":"&")+"CTAref=More+From"}}return{viewModel:i,template:t}}),define("text!Components/size-guide/size-guide.html",[],function(){return'<!-- ko if: render() -->\r\n<div class="size-guide-button">\r\n    <!-- ko if: !isMobile -->\r\n        <button id="size-guide-button" class="link" data-bind="click : toggleSizeGuideVisibility, text : text"></button>\r\n    <!-- /ko -->\r\n    <!-- ko if: isMobile -->\r\n    <a href="#" target="_blank" data-bind="click: fireSizeGuideEvent, attr : { href : sizeGuideUrl }, text : text"></a>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<div id="size-guide-modal" data-bind="component: { name: \'side-modal\', params: { showModal: sizeGuideVisible, data: { sizeGuideUrl: sizeGuideUrl, closeSizeGuide: closeSizeGuide, closeSizeGuideLabel: closeSizeGuideLabel, ariaLabel: sizeGuideAriaLabel, tabHandler: tabHandler } } }">\r\n    <button class="size-guide-close" id="size-guide-close" data-bind="click : closeSizeGuide, attr: {\'aria-label\': closeSizeGuideLabel}, event: {keydown: tabHandler}"></button>\r\n    <iframe id="size-guide-iframe" frameborder="0" seamless="seamless" data-bind="attr: { src: sizeGuideUrl }"></iframe>\r\n</div>\r\n\r\n<!-- /ko -->\r\n'}),define("Components/size-guide/size-guide",["ko","text!./size-guide.html","PageConfig","ProductUtils/Analytics"],function(e,t,i,n){function r(t){this.text=t.dictionary.pdp_size_guide_link,this.sizeGuideUrl=t.url,this.sizeGuideAriaLabel=t.dictionary.pdp_size_guide_aria_label,this.closeSizeGuideLabel=t.dictionary.pdp_misc_close,this.isMobile="mobile"===i.platform,this.sizeGuideVisible=e.observable(!1),this.render=t.visible,this.deferFocus=function(e){setTimeout(function(){document.getElementById(e).focus()},100)}.bind(this),this.fireSizeGuideEvent=function(){return n.firePageInteraction({context:"launchSizeGuide",productIID:t.id}),!0},this.closeSizeGuide=function(){this.sizeGuideVisible(!1),this.deferFocus("size-guide-button")}.bind(this),this.toggleSizeGuideVisibility=function(){this.sizeGuideVisible(!this.sizeGuideVisible()),this.sizeGuideVisible()&&(this.fireSizeGuideEvent(),this.deferFocus("size-guide-close"))},this.tabHandler=function(e,t){return t.shiftKey&&9===t.keyCode?void document.getElementById("size-guide-iframe").contentWindow.postMessage("tabprev","*"):!0},window.addEventListener("message",function(e){"tabnext"===e.data&&document.getElementById("size-guide-close").focus()},!1)}return{viewModel:r,template:t}}),define("text!Components/might-like/might-like.html",[],function(){return'<section>\r\n    <div class="layout-width you-might-also-like" data-bind="visible: carousel.items().length > 0">\r\n        <div class="layout-module">\r\n            <h2 class="might-like-title" data-bind="text: title"></h2>\r\n            <div class="carousel">\r\n                <div class="row">\r\n                    <div class="arrows">\r\n                        <a class="arrow left-arrow" data-bind="click:carousel.moveLeft, css: {active : carousel.hasPreviousPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                    <div class="window" data-bind="swipe">\r\n                        <ul class="slide-panel" data-bind="foreach: carousel.visibleItems, style: { width: carousel.width(), marginLeft:carousel.slidePosition()},css: { suppressSlide : !carousel.animate() }">\r\n                            <li data-bind="style: { width: $parent.carousel.itemWidth()}">\r\n                                <a data-bind="attr: { href: $parent.getProductLink($data, $index())}">\r\n                                    <div class="product-tile">\r\n                                        <img data-bind="attr: { src: $parent.getImageSrc($data), \'aria-describedby\': \'product-tile-header\', alt: \'\'}" />\r\n                                        <div data-bind=\'component:{\r\n                                            name: "save-button",\r\n                                            params:{\r\n                                                colourWayId: $parent.getColourWayId($data),\r\n                                                productId: id,\r\n                                                productImage : $parent.getImageSrc($data),\r\n                                                context : "youMightLike",\r\n                                                productData: { name: name },\r\n                                                state: state\r\n                                            }\r\n                                           }\'></div>\r\n                                        <div class="tile-info">\r\n                                            <h1 id="product-tile-header" data-bind="text:$parent.formatTitle(name)"></h1>\r\n                                            <div class="price-container">\r\n                                                <span class="discounted-price" data-bind="visible: $parent.isPriceDiscounted(price), text:$parent.getDiscountedPriceText(price)"></span>\r\n                                                <span id="current-price-container">\r\n                                                    <span class="price" data-bind="text:$parent.getPriceText(price), css: { \'price-highlighted\' : $parent.isPriceDiscounted(price) }"></span>\r\n                                                    <span data-bind="text: $parent.discountText(price), visible: $parent.isPriceDiscounted(price)" class="discounted-percent"></span>\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </a>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="arrows">\r\n                        <a class="arrow right-arrow" data-bind="click:carousel.moveRight, css: {active : carousel.hasNextPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <ul class="nav" data-bind="foreach: carousel.panels, visible: carousel.hasOtherPanels">\r\n            <li data-bind="click: $parent.carousel.currentPanel.bind($data)">\r\n                <a data-bind="css:{active:$parent.carousel.currentPanel() == $data}" href="#"></a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</section>\r\n';
}),define("ProductUtils/debouncer",[],function(){return this.debounce=function(e,t,i){var n;return function(){var r=this,s=arguments,o=function(){n=null,i||e.apply(r,s)},a=i&&!n;clearTimeout(n),n=setTimeout(o,t),a&&e.apply(r,s)}},this}),define("Models/CarouselControl",["ko","jquery","PageConfig","ProductUtils/debouncer"],function(e,t,i,n){return function(){var r=this,s=e.observable(4),o=4,a=2,c=e.observable(0),l="slide",d=e.observable(0),u=e.observable(),h="desktop"===i.platform.toLowerCase()?1:2,p=document.querySelector("html");r.events=t({}),r.items=e.observableArray(),r.panels=e.observableArray(),r.loop=e.observable(!1),r.animate=e.observable(!0),r.setData=function(e){void 0!==e&&null!==e&&e instanceof Array?this.items(e):r.items.removeAll()},r.currentPanel=e.computed({read:function(){return c()},write:function(e,t){r.animate(void 0===t?!0:t),e>=-1&&e<r.panels().length&&c(e)}}),r.itemsInView=e.computed({read:function(){return s()},write:function(e){e&&e>0&&(s(e),o=e)}}),r.panels.subscribe(function(){if(c()>=r.panels().length){var e=0===r.panels().length?0:r.panels().length-1;c(e)}});var m=function(e){for(var t=Math.ceil(e.length/s()),i=r.panels().length,n=i;t>n;n++)r.panels.push(n);for(var o=t;i>o;o++)r.panels.pop()};s.subscribe(function(){m(r.items())}),r.items.subscribe(m),r.width=e.computed(function(){var e=r.items().length>s()?100*r.items().length/s():100;return e+"%"}),r.itemWidth=e.computed(function(){var e=r.items().length>=s()?100/r.items().length:100/s();return e===1/0&&(e=0),e+"%"}),r.slidePosition=e.computed(function(){return d(),"slide"===l?"-"+100*Math.max(0,c())+"%":d()+"px"}),r.moveLeft=function(){r.animate(!0);var e;c()>0?(e=c()-1,c(e)):r.loop()&&(e=r.panels().length-1,c(e))},r.moveRight=function(){r.animate(!0),c()<r.panels().length-1?c(c()+1):r.loop()&&c(0)},r.hasPreviousPanel=e.computed(function(){return r.loop()?r.panels().length>1:c()>0}),r.hasNextPanel=e.computed(function(){return r.loop()?r.panels().length>1:r.panels().length>0&&c()+1<r.panels().length}),r.hasOtherPanels=e.computed(function(){return r.hasNextPanel()||r.hasPreviousPanel()}),r.setAnimationType=function(e){l=e};var f=function(e){r.itemsInView(e),r.events.trigger("resize")};r.resize=function(e,t,i,n){if(r.landscapePanels=i,r.portraitPanels=n,"mobile"===e)return r.setAnimationType("move"),f(t.innerWidth>t.innerHeight?i:n);if(p.classList.contains("MasterLayout"))return r.events.trigger("resize");var s=o;return t.innerWidth<=568?(f(Math.ceil(a)),void(o=s)):t.innerWidth<=720?(f(Math.ceil((o+a)/2)),void(o=s)):f(Math.ceil(o))},c.subscribe(function(e){!u()&&e>0&&u(!0)}),r.visibleItems=e.computed(function(){return u()?r.items():r.items.slice(0,Math.ceil(r.itemsInView())*h)}),window.addEventListener("resize",n.debounce(function(){r.resize(i.platform,window,r.landscapePanels,r.portraitPanels)})),e.bindingHandlers.swipe={init:function(e){t(e).scroll(function(){u()||u(!0)})}}}}),define("Components/might-like/might-like",["ko","$","text!./might-like.html","Models/CarouselControl","PageConfig","Utils","ProductUtils/Ajax","Product.Config","Providers/SdkProvider","ProductUtils/UrlUtils","ProductUtils/Discount","events"],function(e,t,i,n,r,s,o,a,c,l,d,u){function h(t){var i=t.data,s=new l;this.state=t.state,this.resources=this.state.resources,this.features=this.state.features,this.ajax=new o,this.serviceUrl="",this.useRecs=this.features.recommendationsEnabledStores.indexOf(r.storeCode.toLowerCase())>-1,this.title=this.useRecs&&!this.state.productData.isInStock?this.state.resources.pdp_carousel_recommendations_out_of_stock:this.state.resources.pdp_carousel_recommendations_title,this.createFredHopperUrl=function(e,t){return a.ymalApiUrl+e+"?channel="+t.platform+"-web"},this.createRecsUrl=function(e){var t=a.recsApiUrl+"?";return"string"==typeof window.mvtMightLikeEndpoint&&window.mvtMightLikeEndpoint.length>0&&(t=window.mvtMightLikeEndpoint),t=t+this.getRecsApiStockSpecificQueryParams(this.state.productData.isInStock)+"&limit=16&ctx_productIds="+e},this.getRecsApiStockSpecificQueryParams=function(e){return e?"&ctx_origin=pdt":"&ctx_origin=oos"},this.serviceMapper=function(e){return this.useRecs?this.createRecsUrl(e):this.createFredHopperUrl(e,r)},this.serviceUrl=this.serviceMapper(i.id),this.carousel=new n,this.carousel.itemsInView(4),this.carousel.resize(r.platform,window,3.7,1.7),this.getImageSrc=function(e){return this.useRecs?s.formatUrl(e.images[0].url+"?$XL$&wid=200&fit=constrain"):s.formatUrl(e.imageUrl+"?$XL$&wid=200&fit=constrain")},this.getColourWayId=function(e){for(var t=0;t<e.images.length;t++)if(e.images[t].isPrimary===!0&&e.images[t].colourWayId)return e.images[t].colourWayId},this.getProductLink=function(e,t){var i=s.getProductUrl(e.name,e.brandName,e.id),n="?CTAref=We+Recommend+Carousel_"+(t+1)+"&featureref1=we+recommend";return this.useRecs&&(n+="+pers"),i+n}.bind(this),this.getPriceText=function(e){return e.current.text},this.getDiscountedPriceText=function(e){return this.isPriceDiscounted(e)?e.isOutletPrice?this.state.resources.pdp_price_rrp+e.rrp.text:e.previous.text:""},this.discountText=function(t){var i=e.observable(""),n=t.isOutletPrice?t.rrp.value:t.previous.value;return d.getDiscountText(i,t.current.value,n),i},this.isPriceDiscounted=function(e){return e.isMarkedDown||e.isOutletPrice},this.formatTitle=function(e){var t=e;return t.length>50&&(t=t.substring(0,48),t+="..."),t},this.getAuthorizationHeader=function(){return c.getIdentity().then(function(e){return e.customer.customerGuid().then(function(e){return"Bearer "+(e||"null")},function(){return"Bearer null"})})},this.getRecommendations=function(e,t){return this.ajax.execute({url:e,apiName:"Presentation",callerContext:"YMAL",storeParams:{store:r.storeCode,country:r.countryCode,currency:r.currency,lang:r.language,sizeSchema:r.sizeSchema,keyStoreDataversion:r.keyStoreDataversion},authorization:t,successCallback:this.bindCarouselResponse.bind(this)})},this.update=function(e){return this.getAuthorizationHeader().then(this.getRecommendations.bind(this,e),this.getRecommendations.bind(this,e)).then(this.bindCarouselResponse.bind(this))},this.bindCarouselResponse=function(e){this.carousel.setData(e.recommendations),this.state.submodulesCompleted.recommendations(this.carousel.items().length>0?this.state.CAROUSEL_LOADING_STATE.HAS_DATA:this.state.CAROUSEL_LOADING_STATE.NO_DATA)},u.on("updateMightLike",function(e,t){this.carousel.items([]),this.update(t+"&ctx_productids="+i.id)}.bind(this)),u.on("setMightLikeData",function(e,t){this.useRecs=!0,this.bindCarouselResponse(t.recData)}.bind(this)),this.update(this.serviceUrl)}return{viewModel:h,template:i}}),define("text!Components/buy-the-look/buy-the-look.html",[],function(){return'<section data-bind="visible: isVisible" class="buy-the-look">\r\n    <div class="layout-width">\r\n        <div class="layout-module">\r\n            <h2 class="btl-title" data-bind="text: state.resources.pdp_carousel_buy_the_look_title"></h2>\r\n            <div class="carousel">\r\n                <div class="row">\r\n                    <div class="arrows">\r\n                        <a class="arrow left-arrow" data-bind="click:carousel.moveLeft, css: {active : carousel.hasPreviousPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                    <div class="window" data-bind="swipe">\r\n                        <ul data-bind="foreach: {data: carousel.visibleItems, afterRender: renderedHandler}, style: { height: uniformHeight, width: carousel.width(), marginLeft:carousel.slidePosition()},css: { suppressSlide : !carousel.animate() }, afterRender: postRender ">\r\n                            <li data-bind="style: { width: $parent.carousel.itemWidth() }, css : { \'out-of-stock\' : !isInStock, \'in-stock\' : isInStock}">\r\n                                <div class="item card-container">\r\n                                    <div class="card" data-bind="css : { \'flipped\' : state.showAddToBagError() }">\r\n                                        <div class="front">\r\n                                            <div class="btl-product-details">\r\n                                                <a data-bind="attr: { href: $parent.getProductLink(product, $index()) }">\r\n                                                    <div class="product-image" data-bind=\'component: {\r\n                                                        name: "product-image",\r\n                                                        params: {\r\n                                                            imgUrl: imgUrl,\r\n                                                            state: state,\r\n                                                            productId: product.id,\r\n                                                            context: "buythelook",\r\n                                                            productData: { name: product.name }\r\n                                                        }\r\n                                                    }\'></div>\r\n                                                    <div class="product-title" data-bind="text:$parent.formatTitle(product.name)"></div>\r\n                                                </a>\r\n                                            </div>\r\n                                            <div class="btl-options">\r\n                                                <div class="product-price" data-bind=\'component: { name: "product-price", params: {state: state, hideDeliveryLink: true, showGermanVatMessage: showGermanVatMessage}}\'></div>\r\n                                                <div class="separator"></div>\r\n                                                <div data-bind=\'component:{\r\n                                        name: "product-colour",\r\n                                        params: {\r\n                                            hideLabels: true,\r\n                                            useShortSelectColourLabel: true,\r\n                                            state: state,\r\n                                            data: product,\r\n                                            context: "btl",\r\n                                            selectorIndex: $index()}\r\n                                        }\'></div>\r\n\r\n                                                <div class="separator"></div>\r\n                                                <div data-bind=\'component:{\r\n                                        name: "product-size",\r\n                                        params: {\r\n                                            hideLabels: true,\r\n                                            hideLowInStock: true,\r\n                                            state: state,\r\n                                            data: product,\r\n                                            context: "btl",\r\n                                            selectorIndex: $index()}\r\n                                        }\'></div>\r\n                                                <!-- ko if: isInStock -->\r\n                                                <div class="add-status">\r\n                                                    <div data-component-id="add-item" data-bind=\'component: { name: "add-item",\r\n                                             params:{\r\n                                                 productId: product.id,\r\n                                                 showTryAgain: false,\r\n                                                 productImage : product.images[0].url,\r\n                                                 state: state,\r\n                                                 initiator : "buyTheLook"\r\n                                             }}\'></div>\r\n                                                </div>\r\n                                                <!-- /ko -->\r\n                                                <div class="out-of-stock-button" data-bind="visible: !isInStock">\r\n                                                    <span data-bind="text: state.resources.pdp_carousel_buy_the_look_out_of_stock"></span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class="back">\r\n                                            <div class="btl-product-details">\r\n                                                <a data-bind="attr: { href: $parent.getProductLink(product, $index()) }">\r\n                                                    <img class="product-image" data-bind="attr: { src: imgUrl }" alt="" />\r\n                                                </a>\r\n                                            </div>\r\n                                            <div class="add-failed">\r\n                                                <div class="add-to-bag-error" data-bind="html: state.addToBagErrorMessage"></div>\r\n                                                <div class="retry-add">\r\n                                                    <a class="failed" data-bind="click: $parent.tryAgain($index())">\r\n                                                        <span data-bind="text: state.resources.pdp_status_error_add_item_try_again"></span>\r\n                                                    </a>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="arrows">\r\n                        <a class="arrow right-arrow" data-bind="click:carousel.moveRight, css: {active : carousel.hasNextPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <ul class="nav" data-bind="foreach: carousel.panels, visible: carousel.hasOtherPanels">\r\n            <li data-bind="click: $parent.carousel.currentPanel.bind($data)">\r\n                <a data-bind="css:{active:$parent.carousel.currentPanel() == $data}" href="#"></a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</section>\r\n'}),define("ProductUtils/BuyTheLook",["ProductUtils/Ajax","ProductUtils/UrlUtils","Product.Config","PageConfig"],function(e,t,i,n){return function(){this.productArray=[],this.callbacks=[],this.ajax=new e;var r=new t;this.getBuyTheLook=function(e,t){this.ajax.execute({storeParams:{store:n.storeCode,currency:n.currency,lang:n.language,sizeSchema:n.sizeSchema,keyStoreDataversion:n.keyStoreDataversion},url:i.buyTheLookApiUrl+e,apiName:"Product Catalogue",callerContext:"BuyTheLook",successCallback:this.success.bind(this),retryCount:5,callbackArgs:{callback:t}})},this.success=function(e,t){var i=e.products;i.sort(function(e,t){return e.order-t.order});for(var n=0;n<i.length;n++){var s=i[n].product;s.sizeGuide=r.formatUrl(s.sizeGuide);for(var o=0;o<s.images.length;o++)s.images[o].url=r.formatUrl(s.images[o].url);for(var a=0;a<s.variants.length;a++){var c=s.variants[a];c.size=c.brandSize,c.variantId=c.id,c.sizeDescription&&(c.size+=" - "+c.sizeDescription)}}t.callback(i)}}}),define("Components/buy-the-look/buy-the-look",["ko","text!./buy-the-look.html","Models/CarouselControl","Models/VariantDecorator","PageConfig","$","ProductUtils/BuyTheLook","ProductUtils/UrlUtils"],function(e,t,i,n,r,s,o,a){function c(t){this.state=t.state,this.product=t.data,this.carousel=new i,this.buyTheLook=new o,this.render=t.render,this.uniformHeight=e.observable(),this.expectedCarouselLength=e.observable(0),this.renderedCount=e.observable(0),this.urlUtils=new a,this.adjustCarouselHeight=function(){var e=s(".buy-the-look .item"),t=[];e.each(function(e){var i=20,n=s(this).find(".btl-product-details").outerHeight(),r=s(this).find(".btl-options").outerHeight(),o=r+n+i;t.push(e),t[e]=o});var i=Math.max.apply(Math,t);this.uniformHeight(i+"px")}.bind(this),this.renderedHandler=function(){this.renderedCount(this.renderedCount()+1),this.expectedCarouselLength()>0&&this.renderedCount()===this.carousel.visibleItems().length&&setTimeout(this.adjustCarouselHeight,1)}.bind(this),this.carousel.events.on("resize",function(){this.adjustCarouselHeight()}.bind(this)),this.isVisible=e.computed(function(){return null!==e.utils.arrayFirst(this.carousel.items(),function(e){return e.isInStock})}.bind(this)),this.formatTitle=function(e){var t=e;return t.length>32&&(t=t.substring(0,29),t+="..."),t},this.getProductLink=function(e,t){var i=this.urlUtils.getProductUrl(e.name,e.brandName,e.id),n="?CTAref=Complete+the+Look+Carousel_"+(t+1)+"&featureref1=complete+the+look";return i+n},this.tryAgain=function(e){this.carousel.items()[e].state.showAddToBagError(!1)},this.product.buyTheLookId?this.buyTheLook.getBuyTheLook(this.product.buyTheLookId,function(i){if(!i)return void this.state.submodulesCompleted.buyTheLook(this.state.CAROUSEL_LOADING_STATE.NO_DATA);var s=[];this.expectedCarouselLength(i.length);for(var o=0;o<i.length;o++){var a=i[o].product,c=a.variants.filter(function(e){return e.isInStock}),l=c.length>0,d={productData:(new n).getData(a,!l),selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),resources:t.state.resources},u={state:d,product:a,showGermanVatMessage:t.showGermanVatMessage},h=a.images.filter(function(e){return e.isPrimary===!0?e.url:""});u.isInStock=l,u.imgUrl=h.length>0?h[0].url:a.images[0].url,u.imgUrl=u.imgUrl+"?$L$&wid=190&fit=constrain",s.push(u)}s.sort(function(e,t){return e.isInStock===t.isInStock?0:e.isInStock?-1:1}),i.length>0&&(this.carousel.itemsInView(4),this.carousel.setData(s.slice(0,6)),this.carousel.resize(r.platform,window,3.7,1.7)),this.state.submodulesCompleted.buyTheLook(this.isVisible()?this.state.CAROUSEL_LOADING_STATE.HAS_DATA:this.state.CAROUSEL_LOADING_STATE.NO_DATA)}.bind(this)):this.state.submodulesCompleted.buyTheLook(this.state.CAROUSEL_LOADING_STATE.NO_DATA)}return{viewModel:c,template:t}}),define("text!Components/product-gallery/product-gallery.html",[],function(){return'<!-- ko if: !isMobile-->\r\n    <div class="gallery-aside-wrapper">\r\n        <ul class="thumbnails" role="region" data-bind="attr: { \'aria-label\': galleryText.thumbnailLabel }">\r\n            <!-- ko foreach: galleryItems-->\r\n            <!-- ko if: $index() > 0  -->\r\n            <li class="image-thumbnail" data-bind="css: { active: $parent.thumbIndex() === $index() }, attr: { \'aria-current\': $parent.thumbIndex() === $index() }">\r\n                <button data-bind="click: $parent.selectThumbnail.bind($data, $index())">\r\n                    <!-- ko if: $index() === 1 -->\r\n                    <img data-bind="attr: { src: $parent.colourOptionImage().url + \'?$S$&wid=40&fit=constrain\', alt: $parent.getThumbnailAlt($index())}"/>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: $index() > 1 -->\r\n                    <img data-bind="attr: { src: url + \'?$S$&wid=40&fit=constrain\', alt: $parent.getThumbnailAlt($index())}" />\r\n                    <!-- /ko -->\r\n                </button>\r\n            </li>\r\n            <!-- /ko -->\r\n            <!-- /ko -->\r\n        </ul>\r\n\r\n        <!-- ko if : isInStock -->\r\n            <div class="interactives">\r\n            <!-- ko if : isSmallViewport -->\r\n            <button class="zeekit-back" data-bind="click: closeZeekitCarouselIframe, visible: zeekitCarouselIframeVisible, attr: { \'aria-label\': state.resources.zeekit_back_button }">\r\n                <span class="interactive-icon product-returns"></span>\r\n                <span class="interactive-text" data-bind="text: state.resources.zeekit_back_button"></span>\r\n            </button>\r\n            <!-- /ko -->\r\n            <div class="zeekit-container" data-bind="visible: isZeekitEnabled">\r\n                <div class="zeekit-onboarding-wrapper" data-bind="visible: zeekitOnboardingMessage">\r\n                    <p class="onboarding-text" id="zeekit-models-description" data-bind="text: state.resources.zeekit_button_hint"></p>\r\n                    <button class="onboarding-close" data-bind="click: closeOnboardingMessage, attr: { \'aria-label\': state.resources.pdp_misc_close }">\r\n                        <div class="product-closesmall"></div>\r\n                    </button>\r\n                </div>\r\n                <button id="zeekit-models-button" class="zeekit" aria-describedby="zeekit-model-description" data-bind="click: openZeekitModelsIframe, visible: isZeekitEnabled, attr: { \'aria-current\': zeekitCarouselIframeVisible, \'aria-pressed\': zeekitCarouselIframeVisible, \'aria-label\': zeekitButtonText() }">\r\n                    <span class="zeekit-promo-dot" data-bind="visible: zeekitOnboardingVisible"></span>\r\n                    <span class="interactive-icon product-zeekit-models"></span>\r\n                    <span class="interactive-text" data-bind="css: { \'active\': zeekitCarouselIframeVisible }, text: zeekitButtonText()"></span>\r\n                </button>\r\n                <p class="aria-description" aria-hidden="true" id="zeekit-model-description" data-bind="text: zeekitAriaDescription()"></p>\r\n            </div>\r\n            <button class="catwalk" data-bind="visible: isVideoButtonVisible(), click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\r\n                <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\r\n                <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\r\n            </button>\r\n            <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\r\n                <!-- ko if: !isMobile -->\r\n                <span class="interactive-icon product-360" data-bind="css: { \'product-360-selected\': isSpinViewerVisible }"></span>\r\n                <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: state.resources[\'pdp_misc_spinset\']"></span>\r\n                <!-- /ko -->\r\n                <!-- ko if: isMobile -->\r\n                <span class="interactive-icon product-360" data-bind="css: { \'product-returns\': isSpinViewerVisible }"></span>\r\n                <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: spinViewerLabelText"></span>\r\n                <!-- /ko -->\r\n            </button>\r\n        </div>\r\n        <!--/ko -->\r\n\r\n        <!-- ko if : product && isInStock -->\r\n            <div class="social-share social-share-gallery" id="social-share" data-bind=\'component: { name: "social-share", params: { state: state, data: product } }\'></div>\r\n        <!-- /ko -->\r\n    </div>\r\n<!-- /ko -->\r\n\r\n<div class="product-carousel" tabindex="-1" id="product-gallery" role="region" data-bind="attr: { \'aria-label\': galleryText.carouselLabel }">\r\n    <div class="window" data-bind="swipe">\r\n        <div class="selling-fast" data-bind="visible: showSellingFastLabel">\r\n            <span class="selling-fast__label" data-bind="text: state.resources.pdp_misc_selling_fast"></span>\r\n        </div>\r\n        <div class="gallery-images" data-bind="foreach: galleryItems, css: { animate : animate() }, style: { width : galleryWidth, marginLeft : galleryPosition }">\r\n            <div class="image-container" tabindex="-1" data-bind="style: { width : $parent.itemWidth}, css: { \'zoomable\': $parent.imageData() }, attr: { \'data-gallery-index\': $index, \'aria-hidden\': $parent.thumbIndex() !== $index() }">\r\n                <div class="asos-media spinset imageviewer" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: $parent.playerParams.scene7, viewer: { showCloseButton: false, zoomFactors: $parent.zoomFactors, baseJpgQlt: 80, zoomJpgQlt: 90, handleLoadingErrors: false, showHint: false }, api: $parent.imageViewerApis()[$index()], messages: $parent.playerParams.messages } }, visible: $parent.imageViewersVisibility()[$index()]\'></div>\r\n                <!-- ko if: $index() === 1 -->\r\n                <img class="gallery-image" data-bind="attr: { src: $parent.colourOptionImage().url + \'?$XXL$&wid=513&fit=constrain\', alt: $parent.getImageAlt($index()) }, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}" />\r\n                <!-- /ko -->\r\n                <!-- ko if: $index() !== 1 -->\r\n                <img class="gallery-image" data-bind="attr: { src: url + \'?$XXL$&wid=513&fit=constrain\', alt: $parent.getImageAlt($index()) }, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}" />\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n        <button class="arrow-button arrow-button-right" aria-controls="product-gallery" data-bind="click:moveRight, markAndMeasure: \'pdp:gallery_swiping_right_interactive\', attr: { \'aria-label\': state.resources.pdp_media_gallery_carousel_next }">\r\n            <div class="product-chevron-right-large"></div>\r\n        </button>\r\n        <button class="arrow-button arrow-button-left" aria-controls="product-gallery" data-bind="click:moveLeft, markAndMeasure: \'pdp:gallery_swiping_left_interactive\', attr: { \'aria-label\': state.resources.pdp_media_gallery_carousel_previous }">\r\n            <div class="product-chevron-left-large"></div>\r\n        </button>\r\n        <!-- ko if: isMobile-->\r\n        <div class="carousel-bullets">\r\n            <ul id="mobile-gallery-bullets" data-bind="foreach: galleryItems, attr: { \'aria-label\': selectImageAlt }">\r\n                <!-- ko if: $index() > 0 -->\r\n                <li data-bind="css: { active: $parent.thumbIndex() === $index() }">\r\n                    <button aria-describedby="mobile-gallery-bullets" data-bind="click: $parent.selectThumbnail.bind($data, $index()), attr: { \'aria-current\': ($parent.thumbIndex() === $index()).toString() }"></button>\r\n                </li>\r\n                <!-- /ko -->\r\n            </ul>\r\n        </div>\r\n        <!-- /ko -->\r\n    </div>\r\n    <div class="asos-media catwalk" style="display: none" data-bind=\'component: { name: "asos-video-player-prod", params: { scene7: playerParams.scene7, player: { startInFullScreen: startVideoInFullScreen, closeOnFullScreenExited: closeVideoOnFullScreenExited, initialLoopCount: 2 }, api: videoPlayerApi, messages: playerParams.messages } }, visible: isVideoVisible\'></div>\r\n    <div class="asos-media spinset spinviewer" style="display: none" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: playerParams.scene7, viewer: { spinSpeed: spinSpeed, showCloseButton: showSpinViewerCloseButton, zoomFactors: zoomFactors, reverseVerticalDirection: false, reverseHorizontalDirection: false, baseJpgQlt: 80, zoomJpgQlt: 90, showHint: showSpinViewerContainerHint, useInitialAnimation: true, animationIntervalStart: 100, animationIntervalPeak: 100, animationFramesCount: 5, preloadingTimeout: 30000 }, api: spinViewerApi, messages: playerParams.messages } }, visible: isSpinViewerVisible, css: { "zoomable": isSpinViewerLoadedWithoutErrors }\'></div>\r\n    <div class="asos-media" data-bind=\'style: { visibility: zeekitCarouselIframeVisible() ? "" : "hidden" }\'>\r\n        <!-- ko if : isZeekitEnabled -->\r\n        <iframe id="zeekit-carousel-iframe" frameborder="0" seamless="seamless" data-bind="attr: { src: zeekitCarouselUrl }"></iframe>\r\n        <!-- /ko -->\r\n    </div>\r\n</div>\r\n\r\n<!-- ko if: isMobile-->\r\n    <div class="gallery-aside-wrapper">\r\n    <!-- ko if : isInStock -->\r\n        <div class="interactives">\r\n        <!-- ko if : isSmallViewport -->\r\n        <button class="zeekit-back" data-bind="click: closeZeekitCarouselIframe, visible: zeekitCarouselIframeVisible, attr: { \'aria-label\': state.resources.zeekit_back_button }">\r\n            <span class="interactive-icon product-returns"></span>\r\n            <span class="interactive-text" data-bind="text: state.resources.zeekit_back_button"></span>\r\n        </button>\r\n        <!-- /ko -->\r\n        <div class="zeekit-container" data-bind="visible: isZeekitEnabled">\r\n            <div class="zeekit-onboarding-wrapper" data-bind="visible: zeekitOnboardingMessage">\r\n                <p class="onboarding-text" id="zeekit-models-description" data-bind="text: state.resources.zeekit_button_hint"></p>\r\n                <button class="onboarding-close" data-bind="click: closeOnboardingMessage, attr: { \'aria-label\': state.resources.pdp_misc_close }">\r\n                    <div class="product-closesmall"></div>\r\n                </button>\r\n            </div>\r\n            <button id="zeekit-models-button" class="zeekit" aria-describedby="zeekit-model-description" data-bind="click: openZeekitModelsIframe, visible: isZeekitEnabled, attr: { \'aria-current\': zeekitCarouselIframeVisible, \'aria-pressed\': zeekitCarouselIframeVisible, \'aria-label\': zeekitButtonText() }">\r\n                <span class="zeekit-promo-dot" data-bind="visible: zeekitOnboardingVisible"></span>\r\n                <span class="interactive-icon product-zeekit-models"></span>\r\n                <span class="interactive-text" data-bind="css: { \'active\': zeekitCarouselIframeVisible }, text: zeekitButtonText()"></span>\r\n            </button>\r\n            <p class="aria-description" aria-hidden="true" id="zeekit-model-description" data-bind="text: zeekitAriaDescription()"></p>\r\n        </div>\r\n        <button class="catwalk" data-bind="visible: isVideoButtonVisible(), click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\r\n            <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\r\n            <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\r\n        </button>\r\n        <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\r\n            <!-- ko if: !isMobile -->\r\n            <span class="interactive-icon product-360" data-bind="css: { \'product-360-selected\': isSpinViewerVisible }"></span>\r\n            <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: state.resources[\'pdp_misc_spinset\']"></span>\r\n            <!-- /ko -->\r\n            <!-- ko if: isMobile -->\r\n            <span class="interactive-icon product-360" data-bind="css: { \'product-returns\': isSpinViewerVisible }"></span>\r\n            <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: spinViewerLabelText"></span>\r\n            <!-- /ko -->\r\n        </button>\r\n    </div>\r\n    <!--/ko -->\r\n\r\n    <!-- ko if : product && isInStock -->\r\n        <div class="social-share social-share-gallery" id="social-share" data-bind=\'component: { name: "social-share", params: { state: state, data: product } }\'></div>\r\n    <!-- /ko -->\r\n</div>\r\n<!-- /ko -->\r\n\r\n<div class="zeekit-models-modal" data-bind="component: { name: \'side-modal\', params: { showModal: zeekitModelsIframeVisible, data: { zeekitIframe: zeekitModelsUrl, zeekitModelsIframeInitialised: zeekitModelsIframeInitialised } } }">\r\n    <!-- ko if : zeekitModelsIframeInitialised -->\r\n    <iframe id="zeekit-models-iframe" frameborder="0" seamless="seamless" data-bind="attr: { src: zeekitIframe }"></iframe>\r\n    <!-- /ko -->\r\n</div>\r\n';
}),define("ProductUtils/Zeekit",["Promise","PageConfig","ProductUtils/NewRelicLogger","ProductUtils/Window"],function(e,t,i,n){function r(e,t,i){e&&t&&i({displayUrl:e,modelsUrl:t})}function s(e){var t=["uk","us"];return e&&t.indexOf(e.toLowerCase())>-1?!1:!0}function o(){return Boolean(t.zeekitQaMode)||n.location.href.toLowerCase().indexOf("zeekitqamode=true")>-1}var a,c,l=!1;return function(n,d,u,h){return new e(function(e){if(l)r(a,c,e);else{l=!0;var p=document.createElement("script");p.setAttribute("id","zeekit-script"),p.type="text/javascript",p.src=t.zeekitClientScript,p.onload=function(){try{window.Zeekit.init({asosProductCode:n,lang:t.language,sizeSchema:t.sizeSchema,metrics:s(t.sizeSchema),debugMode:!1,qaMode:o(),onModelsUrl:function(t){c=t,r(a,c,e)},onDisplayUrl:function(t){a=t,r(a,c,e)},closeModelsFrame:d,modelsSelected:u,frameReady:h})}catch(l){i.logError(new Error(i.ERROR_TYPE.ParseError),{action:"ZeekitInit",message:"Zeekit failed to initialise"})}},document.head.appendChild(p)}})}}),define("ProductUtils/Browser",["ko","ProductUtils/Window"],function(e,t){function i(){u(d.large.matches?a:d.medium.matches?o:s)}function n(){return t.navigator?t.navigator.onLine:!0}function r(t){return e.computed(function(){var e=!1;switch(t){case s:e=u()===s;break;case o:e=[s,o].indexOf(u())>-1;break;case a:e=[s,o,a].indexOf(u())>-1}return e})}var s="SMALL_VIEWPORT",o="MEDIUM_VIEWPORT",a="LARGE_VIEWPORT",c="(min-width: 720px)",l="(min-width: 1024px)",d={medium:t.matchMedia(c),large:t.matchMedia(l)},u=e.observable();return d.medium.addListener(i),d.large.addListener(i),i(),{isOnline:n,viewportSize:u,isUpToViewport:r,viewports:{SMALL_VIEWPORT:s,MEDIUM_VIEWPORT:o,LARGE_VIEWPORT:a}}}),define("Components/product-gallery/product-gallery",["ko","$","text!./product-gallery.html","Models/CarouselControl","PageConfig","hammer","Asos.Utils.MediaPlayers","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/Zeekit","ProductUtils/Browser","Providers/SdkProvider"],function(e,t,i,n,r,s,o,a,c,l,d,u){function h(t){function i(e){for(var t=-1,i=0;i<m.length;i++)if(m[i].colourWayId===e){t=i;break}return t}function n(){p.errorBanner.message(p.resources.zeekit_no_internet_copy),p.errorBanner.displayError(!0)}function h(){p.errorBanner.message(""),p.errorBanner.displayError(!1)}var p=t.state;this.product=t.data.product;var m=t.data.images;this.defaultProductId=t.data.defaultProductId,this.galleryItems=e.observableArray(),this.galleryWidth=e.observable(),this.itemWidth=e.observable(),this.itemWidthValue=e.observable(),this.galleryPosition=e.observable(),this.galleryIndex=e.observable(0),this.animate=e.observable(!1),this.thumbIndex=e.observable(0),this.isInStock=e.observable(!1),this.isMobile="mobile"===r.platform,this.isSmallViewport=d.isUpToViewport(d.viewports.SMALL_VIEWPORT);var f=new c,v={imageChanged:!1,thumbnailClick:!1,imageViewerZoomIn:!1,spinViewerInit:!1,spinViewerSpin:!1,spinViewerZoomIn:!1,videoPlayerInit:!1,videoProgress:{50:!1,100:!1}};this.checkIfInStockAndSetFlag=function(){this.isInStock(p.productData?p.productData.isInStock:!0)},this.getVisibleImages=function(t){var i=t.filter(function(e){return e.isVisible===!0});if(!i[0].colourWayId||null===i[0].colourWayId){var n=e.utils.arrayFirst(t,function(e){return e.isPrimary});if(n||(n=e.utils.arrayFirst(t,function(e){return e.colourWayId&&null!==e.colourWayId})),n){var r=i.indexOf(n);r>=0&&i.splice(r,1),i.splice(0,0,n)}}return i};var g=this.getVisibleImages(m);this.getThumbnailAlt=function(e){return p.resources.pdp_media_gallery_thumbnail_count.replace("%{index}",e).replace("%{total}",g.length-1)}.bind(this),this.getImageAlt=function(e){return p.resources.pdp_misc_count.replace("%{index}",e).replace("%{total}",g.length-1)}.bind(this),this.selectImageAlt=p.resources.pdp_media_gallery_select_image,p.mainImage=this.colourOptionImage=e.observable(g[0]),this.init=function(){this.galleryItems(this.shuffleLastImage(g)),this.galleryWidth(this.getGalleryWidth()),this.itemWidth(this.getItemWidth()),this.setSwipe(),this.setImageViewers(),this.setGalleryPosition(1),this.defaultProductId>0?this.trySetProductImage(this.defaultProductId):p.selectedColour()&&p.selectedColour().colourWayId!==this.colourOptionImage().colourWayId&&this.trySetColour(p.selectedColour().colourWayId)},this.setGalleryPosition=function(e){this.galleryIndex(e),0===e?this.thumbIndex(this.galleryItems().length-1):this.thumbIndex(e),this.galleryPosition("-"+100*Math.abs(this.galleryIndex())+"%")},this.getItemWidth=function(){return 100/this.galleryItems().length+"%"},this.getGalleryWidth=function(){return 100*this.galleryItems().length+"%"},this.shuffleLastImage=function(e){var t=e,i=e[e.length-1];return t.unshift(i),t},this.moveLeft=function(){return this.resetImageViewer(),0===this.galleryIndex()?(this.animate(!1),this.setGalleryPosition(this.galleryItems().length-1),setTimeout(function(){this.animate(!0),this.setGalleryPosition(this.galleryItems().length-2),v.imageChanged||(a.firePageInteraction({context:"chevronClick",productIID:t.data.id}),v.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()-1),v.imageChanged||(a.firePageInteraction({context:"chevronClick",productIID:t.data.id}),v.imageChanged=!0),!1)},this.moveRight=function(){return this.resetImageViewer(),this.galleryIndex()===this.galleryItems().length-1?(this.animate(!1),this.setGalleryPosition(0),setTimeout(function(){this.animate(!0),this.setGalleryPosition(1),v.imageChanged||(a.firePageInteraction({context:"chevronClick",productIID:t.data.id}),v.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()+1),v.imageChanged||(a.firePageInteraction({context:"chevronClick",productIID:t.data.id}),v.imageChanged=!0),!1)},this.selectThumbnail=function(e,i){this.exitVideo(),this.exitSpinViewer(),this.closeZeekitCarouselIframe(),this.resetImageViewer(),this.animate(!1),this.setGalleryPosition(e),i===!0||v.thumbnailClick||(a.firePageInteraction({context:"thumbnailClick",productIID:t.data.id}),v.thumbnailClick=!0)}.bind(this),this.trySetColour=function(e){var t=i(e);if(-1!==t){var n=1;this.colourOptionImage(m[t]),this.exitVideo(),this.exitSpinViewer(),this.setGalleryPosition(n),this.imageViewersVisibility()[n]&&this.initImageViewer(n)}},this.trySetProductImage=function(e){for(var t=1,i=0;i<m.length;i++)if(m[i].productId===e){t=i+1;break}this.setGalleryPosition(t)},p.selectedColour.subscribe(function(e){void 0===e||null===e?(this.colourOptionImage(m[0]),this.initImageViewer(1)):e.colourWayId&&this.trySetColour(e.colourWayId)}.bind(this)),this.videoPlayerApi=e.observable(),this.exitVideo=function(){if(this.isVideoVisible(!1),this.videoPlayerApi()&&this.videoPlayerApi().stop)try{this.videoPlayerApi().stop()}catch(e){console.warn("could not stop video: "+e)}},this.keydownEventListener=function(){var e;document.addEventListener("keydown",(e=function(t){("Escape"===t.key||27===t.keyCode)&&(this.exitVideo(),document.removeEventListener("keydown",e))}).bind(this))},this.keydownEventListener(),document.body.addEventListener("modalClosed",function(){this.exitVideo()}.bind(this)),this.startVideoInFullScreen=this.isMobile,this.closeVideoOnFullScreenExited=this.isMobile,this.canDisplayVideoButton=e.observable(!1),this.isVideoVisible=e.observable(!1),this.playerParams=t.data.playerParams,this.isVideoButtonVisible=e.computed(function(){return this.canDisplayVideoButton()&&this.isInStock()?!(this.isSmallViewport()&&this.zeekitCarouselIframeVisible()):!1}.bind(this)),this.playerParams.messages={errorHeaderText:p.resources.pdp_media_video_player_error_header,errorMessageText:p.resources.pdp_media_video_player_error_message,spinsetErrorMessageText:p.resources.pdp_media_spinset_error_message,refreshButtonText:p.resources.pdp_media_video_player_refresh_button,unsupportedHeaderText:p.resources.pdp_media_video_player_unsupported_header,unsupportedMessageText:p.resources.pdp_media_video_player_unsupported_message,closeButtonText:p.resources.pdp_media_video_player_close_button,hintDragText:p.resources.pdp_media_spinset_hint_drag,hintTapText:p.resources.pdp_media_spinset_hint_tap},this.onVideoButtonActivated=function(){v.videoFirstPlaybackCompleted=!1,this.isVideoVisible()||(this.resetImageViewer(),this.isVideoVisible(!0),this.exitSpinViewer(),this.closeZeekitCarouselIframe(),this.videoPlayerApi().start(b),v.videoPlayerInit||(a.firePageInteraction({context:"video",productIID:t.data.id,videoEvent:"start"}),v.videoPlayerInit=!0))};var b;this.videoPlayerApi.subscribe(function(e){e.events.on("playerExitRequested allLoopsEnded",function(){this.exitVideo()}.bind(this)),e.events.on("progress",function(e,i){if(i.detail.value)for(var n in v.videoProgress){var r=parseInt(n,10);!v.videoProgress[n]&&i.detail.value>=r&&(v.videoProgress[n]=!0,a.firePageInteraction({context:"video",productIID:t.data.id,videoEvent:n}))}});var i={formats:["m3u8","mp4","ogg"],preferredFPS:this.isMobile?25:50,preferredBitrates:{720:1200}};if(t.data.useProductIdForVideos)return void e.loadAssets(t.data.id,i,function(){this.canDisplayVideoButton(!0),this.checkIfInStockAndSetFlag()}.bind(this));if(t.data.media&&t.data.media.catwalkUrl){var n=o.getVideoPlayerAssetsProvider(t.data.playerParams.scene7.videoServer);n.getAssets(f.formatUrl(t.data.media.catwalkUrl),i).then(function(e){b=e,this.canDisplayVideoButton(!0),this.checkIfInStockAndSetFlag()}.bind(this))}}.bind(this)),this.spinViewerApi=e.observable(),this.exitSpinViewer=function(){this.spinViewerApi()&&this.spinViewerApi().zoomReset(),this.isSpinViewerVisible(!1)},this.spinSpeed=this.isMobile?1.5:3,this.showSpinViewerCloseButton=this.isMobile,this.showSpinViewerContainerHint=!this.isMobile,this.zoomFactors=[.5,1],this.isSpinViewerButtonVisible=e.observable(!1),this.isSpinViewerVisible=e.observable(!1),this.isSpinViewerPressed=e.computed(function(){return this.isMobile?this.isSpinViewerVisible().toString():void 0}.bind(this)),this.isSpinViewerLoadedWithoutErrors=e.observable(!1),this.spinViewerLabelText=e.observable(p.resources.pdp_misc_spinset),this.onSpinViewerButtonActivated=function(){this.spinViewerLabelText(p.resources.pdp_misc_gallery),this.isSpinViewerVisible()?this.isMobile&&(this.spinViewerLabelText(p.resources.pdp_misc_spinset),this.exitSpinViewer()):(this.resetImageViewer(),this.exitVideo(),this.closeZeekitCarouselIframe(),this.isSpinViewerVisible(!0),this.spinViewerApi().init(),v.spinViewerInit||(a.firePageInteraction({context:"360Launch",productIID:t.data.id}),v.spinViewerInit=!0))},this.spinViewerApi.subscribe(function(e){e.events.on("zoomedIn",function(){v.spinViewerZoomIn||(a.firePageInteraction({context:"360Zoom",productIID:t.data.id}),v.spinViewerZoomIn=!0)}),e.events.on("allImagesLoaded",function(e,t){t&&this.isSpinViewerLoadedWithoutErrors(t)}.bind(this));var i=t.data.id;e.loadAssets(i,function(){this.isSpinViewerButtonVisible(p.productData?p.productData.isInStock:!0)}.bind(this))}.bind(this)),this.zeekitModelsUrl=e.observable(),this.zeekitCarouselUrl=e.observable(),this.isZeekitEnabled=e.observable(!1),this.zeekitModelsIframeInitialised=e.observable(!1),this.zeekitModelsIframeVisible=e.observable(!1),this.zeekitCarouselIframeVisible=e.observable(!1),this.zeekitPreSelectedModels=e.observable(!1),this.zeekitOnboardingVisible=e.observable(!1),this.zeekitOnboardingMessage=e.observable(!1);var y="asos-pdp-zeekit-hasBeenViewed",S="asos-pdp-zeekit-onboardingDismissed";this.zeekitButtonText=e.computed(function(){return this.zeekitCarouselIframeVisible()?p.resources.zeekit_button_editmode:p.resources.zeekit_button}.bind(this)),this.zeekitAriaDescription=e.computed(function(){return this.zeekitCarouselIframeVisible()?p.resources.zeekit_button_editmode_accessibility:p.resources.zeekit_button_accessibility}.bind(this)),this.openZeekitModelsIframe=function(){return d.isOnline()?(h(),this.zeekitOnboardingVisible(!1),this.closeOnboardingMessage(),window.localStorage.setItem(y,"true"),!this.zeekitCarouselIframeVisible()&&this.zeekitPreSelectedModels()?(this.openZeekitCarouselIframe(),void this.zeekitModelsIframeInitialised(!0)):(this.exitVideo(),this.zeekitModelsIframeInitialised(!0),this.zeekitModelsIframeVisible(!0),setTimeout(function(){document.getElementById("zeekit-models-iframe").focus()},100),void a.firePageInteraction({context:"zeekitOpened"}))):void n()}.bind(this),this.closeZeekitModelsIframe=function(){this.zeekitModelsIframeVisible(!1),setTimeout(function(){document.getElementById("zeekit-models-button").focus()},100),h()}.bind(this),this.zeekitModelsIframeVisible.subscribe(function(e){e||(h(),document.getElementById("zeekit-models-iframe").contentWindow.postMessage("zeekit-modelsClosed","*"))}),this.openZeekitCarouselIframe=function(){return d.isOnline()?(h(),this.zeekitModelsIframeVisible(!1),this.zeekitCarouselIframeVisible(!0),this.zeekitPreSelectedModels(!0),this.exitVideo(),this.exitSpinViewer(),document.getElementById("zeekit-carousel-iframe").contentWindow.postMessage("Zeekit-displayFrameOpen","*"),void setTimeout(function(){document.getElementById("zeekit-carousel-iframe").focus()},100)):void n()}.bind(this),this.closeZeekitCarouselIframe=function(){this.zeekitCarouselIframeVisible(!1)}.bind(this),this.closeOnboardingMessage=function(){this.zeekitOnboardingMessage(!1),window.localStorage.setItem(S,"true")}.bind(this),this.zeekitFrameReady=function(e){e>0?this.zeekitPreSelectedModels(!0):this.zeekitModelsIframeInitialised(!0)}.bind(this),this.product&&this.product.zeekit&&this.product.zeekit.enabled&&(u.getFeatures().then(function(e){e.ifActive("emf-64-web-zeekit-v2",!0).then(function(e){e&&e.isActive&&l(this.product.productCode,this.closeZeekitModelsIframe,this.openZeekitCarouselIframe,this.zeekitFrameReady).then(function(e){this.isZeekitEnabled(!0),this.zeekitModelsUrl(e.modelsUrl),this.zeekitCarouselUrl(e.displayUrl)}.bind(this))}.bind(this))}.bind(this)),"true"!==window.localStorage.getItem(y)&&this.zeekitOnboardingVisible(!0),"true"!==window.localStorage.getItem(S)&&this.zeekitOnboardingMessage(!0)),this.imageData=e.observable(),this.imageViewerApis=e.observableArray([]),this.imageViewersVisibility=e.observableArray([]),this.areAllImageViewerApisReady=function(){for(var e=0;e<this.imageViewerApis().length;e++)if(!this.imageViewerApis()[e]())return!1;return!0},this.initImageViewer=function(e){var i=this.imageViewersVisibility(),n=this.imageData(),r=this.imageViewerApis()[e](),s=t.data.rootElement.querySelector('.image-container[data-gallery-index="'+e+'"] img.gallery-image');if(!s.complete)return void(s.onload=this.initImageViewer.bind(this,e));if(s.complete&&r&&n){i[e]=!0,this.imageViewersVisibility(i);var o=s.cloneNode();o.style.visibility="visible",r.setAssets(n[this.getImageIndexFromGalleryIndex(e)]),r.init(null,o),s.style.visibility="hidden"}},this.loadImagesMetadata=function(e){var i=o.getSpinViewerAssetsProvider(t.data.playerParams.scene7.imageServer);i.getAssets(e,function(e){this.imageData(e),this.checkIfInStockAndSetFlag()}.bind(this))},this.imageData.subscribe(function(e){if(e)for(var t=0;t<this.imageViewerApis().length;t++)this.initImageViewer(t)}.bind(this)),this.onImageViewerApiReady=function(e){var i=t.data.rootElement.querySelector('[data-gallery-index="'+e+'"]'),n=this.imageData();n&&this.initImageViewer(e,i)},this.getImageIndexFromGalleryIndex=function(t){var i=1===t?this.colourOptionImage():this.galleryItems()[t],n=e.utils.arrayFirst(m,function(e){return e.url===i.url});return m.indexOf(n)},this.setImageViewers=function(){for(var t,i=this.galleryItems(),n=[],r=0;r<m.length;r++)n.push(m[r].url);for(r=0;r<i.length;r++)t=e.observable(),this.imageViewerApis.push(t),this.imageViewersVisibility.push(!1),t.subscribe(this.onImageViewerApiReady.bind(this,r));this.loadImagesMetadata(n)},this.resetImageViewer=function(){var e=this.imageViewerApis()[this.galleryIndex()]&&this.imageViewerApis()[this.galleryIndex()]();e&&e.zoomReset()},this.setSwipe=function(){if(window.addEventListener){var e=document.querySelector(".product-gallery .window"),t=new s(e,{inputClass:s.TouchInput});t.on("swipeleft",function(){this.moveRight()}.bind(this)),t.on("swiperight",function(){this.moveLeft()}.bind(this))}},this.showSellingFastLabel=e.computed(function(){var e=!this.isVideoVisible()&&!this.isSpinViewerVisible();return this.isInStock()&&t.state.sellingFast&&e}.bind(this)),this.galleryText={thumbnailLabel:p.resources.pdp_media_gallery_thumbnail_label,carouselLabel:p.resources.pdp_media_gallery_carousel_label},this.init()}return{viewModel:h,template:i}}),define("text!Components/product-colour/product-colour.html",[],function(){return'<!-- ko if: render -->\r\n<section>\r\n    <div class="colour-size colour-component">\r\n        <div class="grid-row colour-section">\r\n            <label for="colourSelect" class="disabled" data-bind="text: colourLabel, visible: !hideLabels"></label>\r\n            <span class="product-colour" data-bind="visible: colourLabelVisible(), text: selectedColourLabel(), css: { disabled: isDisabled }"></span>\r\n            <div class="colour-size-select" data-bind="visible: colourDropdownVisible()">\r\n                <select id="colourSelect"\r\n                        data-id="colourSelect"\r\n                        data-bind="optionsCaption: selectColourText,\r\n                        disable: isDisabled,\r\n                        options: data,\r\n                        optionsAfterRender: setColourOptionText,\r\n                        value: colour,\r\n                        css:{ required : noColourSelected()},\r\n                        attr: {\r\n                            \'id\': colourSelectorId,\r\n                            \'aria-describedby\': noColourSelected() ? \'selectColourError\' : null,\r\n                            \'aria-invalid\': noColourSelected() ? true : null\r\n                        }"></select>\r\n                <!-- ko if: noColourSelected() -->\r\n                <span id="selectColourError" class="error basic-error-box" data-bind="text:selectColourPrompt"></span>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>\r\n<!-- /ko -->'}),define("Components/product-colour/product-colour",["ko","text!./product-colour.html","PageConfig"],function(e,t,i){function n(t){var n=t.state,r="undefined"!==t.hideOnOutOfStock?t.hideOnOutOfStock:!1;this.render=r&&!n.productData.isInStock?!1:!0,this.noColourSelected=t.state.showNoColourSelectedWarning,this.data=e.observableArray(),this.colour=n.selectedColour,this.hideLabels=t.hideLabels,this.useShortSelectColourLabel=t.useShortSelectColourLabel,this.selectColourPrompt=n.resources.pdp_select_colour_message,this.colourLabel=n.resources.pdp_misc_colour+":",this.isMobile="mobile"===i.platform,this.notAvailableText=n.resources.pdp_status_not_available,this.selectorIndex=t.selectorIndex,this.context=t.context,this.colourSelectorId=this.context+"-colour-select-"+this.selectorIndex,this.useShortSelectColourLabel?this.selectColourText=n.resources.pdp_select_colour_label:this.selectColourText=n.resources.pdp_select_colour_from_label,this.lowInStockText=n.resources.pdp_status_low_in_stock;var s=t.state.productData;this.isDisabled=!t.state.productData.isInStock;var o=s.colours;this.noColourSelected.subscribe(function(e){if(e){var t=document.getElementById(this.colourSelectorId);t.focus()}}.bind(this)),this.data(o),this.selectColourText=this.selectColourText.replace("%{count}",this.data().length),this.colourDropdownVisible=e.computed(function(){return this.data().length>1}.bind(this)),this.colourLabelVisible=e.computed(function(){return!this.colourDropdownVisible()}.bind(this)),this.setColourOptionText=function(e,t){t&&(s.hasDifferentPrices?e.text=t.colour+" "+t.price.text:e.text=t.colour)},this.selectedColourLabel=e.computed(function(){return this.colour()?this.colour().colour:""}.bind(this)),this.setDefaultColour=function(){1===this.data().length&&this.colour(this.data()[0])},this.setDefaultColour(),this.setVariantColour=function(e,t){for(var i=0;i<e.length;i++)if(e[i].colourWayId===t){this.colour(e[i]);break}},t.state.defaultVariant&&this.setVariantColour(this.data(),t.state.defaultVariant.colourWayId)}return{viewModel:n,template:t}}),define("text!Components/product-size/product-size.html",[],function(){return'<!-- ko if: render -->\r\n<section>\r\n    <div class="colour-size size-component">\r\n        <div class="size-section" data-bind="visible: sizeSectionVisible()">\r\n            <div style="display: table; width: 100%">\r\n                <label for="sizeSelect" style="display: table-cell; vertical-align: bottom" data-bind="text: sizeLabel, visible: !hideLabels, disable: isDisabled"></label>\r\n                <div style="display: table-cell; vertical-align: top; width: 100%">\r\n                    <!-- ko if: isOneSize -->\r\n                    <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: !showFitAnalyticsSection() -->\r\n                    <div id="size-guide" class="size-guide" style="float: right;" data-bind=\'component: { name: "size-guide", params: {dictionary: sizeGuideDictionary , url: sizeGuideLink, visible: state.showSizeGuide, id:id}}\'></div>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: showFitAnalyticsSection() -->\r\n                    <div class="fit-analytics upper" style="line-height: 1.57; letter-spacing: 0.4px;" data-bind="style: { float: fitAnalyticsViewModel.recommendation() === fitAnalyticsViewModel.RecommendationType.None ? \'right\' : \'none\' }">\r\n                        <div class="table">\r\n                            <div class="cell" data-bind="click: fitAnalyticsOpen, visible: fitAnalyticsViewModel.recommendation() === fitAnalyticsViewModel.RecommendationType.None">\r\n                                <div class="circle" style="float: left">\r\n                                    <span class="no-recommendation"></span>\r\n                                </div>\r\n                            </div>\r\n                            <div class="cell">\r\n                                <a href="" data-bind="click: fitAnalyticsOpen, text: fitAnalyticsLinkText"></a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                </div>\r\n            </div>\r\n            <!-- ko if: !isOneSize -->\r\n            <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\r\n            <!-- /ko -->\r\n            <div class="colour-size-select" data-bind="visible: sizeDropdownVisible(), markAndMeasure: \'pdp:size_selector_interactive\'">\r\n                <select\r\n                        data-id="sizeSelect"\r\n                        data-bind="options: variants,\r\n                            optionsAfterRender: disableSizeIfOutOfStock,\r\n                            optionsText: \'Size\',\r\n                            optionsCaption: selectSizeText,\r\n                            value: size,\r\n                            disable: isDisabled || sizeDropdownDisabled(),\r\n                            css:{ required : noSizeSelected() && !isDesktopMixMatch},\r\n                            attr: {\r\n                                \'id\': sizeSelectorId,\r\n                                \'aria-describedby\': noSizeSelected() ? isDesktopMixMatch ? \'selectSizesError\' : \'selectSizeError\' : null,\r\n                                \'aria-invalid\': noSizeSelected() && !isDesktopMixMatch ? true : null\r\n                            }"></select>\r\n                <!-- ko if: noSizeSelected() && !isDesktopMixMatch -->\r\n                <span id="selectSizeError" class="error basic-error-box" data-bind="text:selectSizePrompt"></span>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n        <div class="grid-row low-in-stock" data-bind="visible: isLowInStock() && !hideLowInStock">\r\n            <span class="clock"></span><span data-bind="text:lowInStockText"></span>\r\n        </div>\r\n    </div>\r\n</section>\r\n<!-- /ko -->\r\n'}),define("Components/product-size/product-size",["ko","text!./product-size.html"],function(e,t){function i(t){var i=t.data,n=t.state,r="undefined"!==t.hideOnOutOfStock?t.hideOnOutOfStock:!1;this.state=n,this.render=r&&!n.productData.isInStock?!1:!0,this.noSizeSelected=t.state.showNoSizeSelectedWarning,this.sizeGuideDictionary=t.state.resources,this.sizeGuideLink=i.sizeGuide,this.colour=n.selectedColour,this.size=n.selectedSize,this.alwaysDisplaySizeLabel=!1,this.isLowInStock=e.observable(!1),this.hideLabels=t.hideLabels,this.hideLowInStock=t.hideLowInStock,this.displayOnlyAsDropDown=t.displayOnlyAsDropDown||!1,this.doNotSelectDefaultSize=t.doNotSelectDefaultSize||this.displayOnlyAsDropDown,this.id=i.id,this.isOneSize=i.isOneSize,this.size.subscribe(function(){var e=void 0===this.size()?!1:this.size().isLowInStock===!0;this.isLowInStock(e)}.bind(this)),this.isDesktopMixMatch=t.isMixMatch&&!t.isMobile,this.selectorIndex=t.selectorIndex,this.context=t.context,this.sizeSelectorId=this.context+"-size-select-"+this.selectorIndex,this.variants=e.computed(function(){return void 0===this.colour()?[]:this.colour().variants}.bind(this)),n.showSizeGuide||(n.showSizeGuide=e.observable(!1)),n.showSizeGuide(t.showSizeGuide===!0&&i.sizeGuideVisible),this.selectSizePrompt=n.resources.pdp_select_colour_size_message,this.sizeLabel=n.resources.pdp_misc_size+":",this.outOfStockText=n.resources.pdp_status_out_of_stock,this.notAvailableText=n.resources.pdp_status_not_available,this.selectSizeText=n.resources.pdp_select_size_label,this.lowInStockText=n.resources.pdp_status_low_in_stock;var s=t.state.productData;this.isDisabled=!t.state.productData.isInStock;for(var o=s.colours,a=0,c=o.length-1;c>=0;c--){var l=o[c];l.variants.length>a&&(a=l.variants.length)}this.noSizeSelected.subscribe(function(e){var t=document.getElementById(this.sizeSelectorId);e&&t.focus()}.bind(this)),!this.displayOnlyAsDropDown&&!i.isNoSize&&o.length>1&&1===a&&(this.alwaysDisplaySizeLabel=!0),this.colour.subscribe(function(e){void 0===e||1!==this.colour().variants.length||this.displayOnlyAsDropDown?this.setDefaultSize():this.size(this.colour().variants[0])}.bind(this)),this.sizeDropdownVisible=e.computed(function(){if(this.alwaysDisplaySizeLabel)return!1;if(this.displayOnlyAsDropDown)return!0;if(i.isNoSize)return!1;var e=void 0===this.colour(),t=e?0:this.colour().variants.length;return e||t>1}.bind(this)),this.sizeLabelVisible=e.computed(function(){return this.alwaysDisplaySizeLabel?!0:!this.displayOnlyAsDropDown&&!i.isNoSize&&!this.sizeDropdownVisible()}.bind(this)),this.sizeSectionVisible=e.computed(function(){return this.sizeLabelVisible()||this.sizeDropdownVisible()}.bind(this)),this.disableSizeIfOutOfStock=function(t,i){void 0!==i&&null!==i&&(t.text=i.isInStock?i.size:i.size+" - "+this.notAvailableText,e.applyBindingsToNode(t,{enable:i.isInStock},i))}.bind(this),this.sizeDropdownDisabled=e.computed(function(){return void 0===this.colour()}.bind(this)),this.selectedSizeLabel=e.computed(function(){return this.alwaysDisplaySizeLabel?o[0].variants[0].size:this.size()?this.size().size:""}.bind(this)),this.setDefaultSize=function(){if(!this.doNotSelectDefaultSize&&void 0!==s&&void 0!==this.variants()&&1===s.colours.length){for(var e,t=s.colours[0],i=t.variants.length-1;i>=0;i--)if(t.variants[i].isInStock){if(void 0!==e){e=void 0;break}e=this.variants()[i]}void 0!==e&&this.size(e)}},this.setVariantSize=function(e,t){for(var i=0;i<e.length;i++)if(e[i].variantId===t){if(!e[i].isInStock){this.size(void 0);break}this.size(e[i]);break}},t.useFitAnalytics&&t.state.fitAnalyticsViewModel()?this.fitAnalyticsViewModel=t.state.fitAnalyticsViewModel():this.fitAnalyticsViewModel={isLoaded:e.observable(!1)},this.showFitAnalyticsSection=e.computed(function(){return this.fitAnalyticsViewModel.isLoaded()&&this.fitAnalyticsViewModel.recommendation?void 0!==this.fitAnalyticsViewModel.recommendation():!1}.bind(this)),this.getFitAnalyticsText=function(){if(this.fitAnalyticsViewModel.recommendation){var e;switch(this.fitAnalyticsViewModel.recommendation()){case this.fitAnalyticsViewModel.RecommendationType.Partial:e=n.resources.pdp_fit_analytics_recommendation_profile_partial;break;case this.fitAnalyticsViewModel.RecommendationType.Complete:e=n.resources.pdp_fit_analytics_recommendation_profile_complete;break;case this.fitAnalyticsViewModel.RecommendationType.OOS:e=n.resources.pdp_fit_analytics_recommendation_oos;break;default:e=n.resources.pdp_fit_analytics_recommendation_profile_none}if(e)return e.replace("%{size}",this.fitAnalyticsViewModel.recommendedSize())}},this.fitAnalyticsLinkText=e.computed(function(){return this.getFitAnalyticsText()}.bind(this)),this.fitAnalyticsOpen=function(){this.fitAnalyticsViewModel.openRecommendations&&this.fitAnalyticsViewModel.openRecommendations()}.bind(this),this.setDefaultSize(),t.state.defaultVariant&&this.setVariantSize(this.variants(),t.state.defaultVariant.variantId)}return{viewModel:i,template:t}}),define("text!Components/delivery-and-returns/delivery-and-returns.html",[],function(){return'<!-- ko if : !hideDeliveryLink-->\r\n<!-- ko if : features.deliveryAndReturnsModalEnabled -->\r\n<span><button class="link product-delivery" data-bind="text: deliveryReturnsLink, click: deliveryAndReturnsClicked"></button></span>\r\n<!-- /ko -->\r\n<!-- ko if : !features.deliveryAndReturnsModalEnabled -->\r\n<span><a href="#" class="product-delivery" target="_blank" data-bind="text: deliveryReturnsLink, attr : {href : url }"></a></span>\r\n<!-- /ko -->\r\n<!-- /ko -->\r\n'}),define("ProductUtils/SpinnerLoader",[],function(){return function(e){this.loader=null,e&&e.selector?this.loader=document.querySelector(e.selector):this.loader=document.querySelector(".loader"),this.show=function(){null!==this.loader&&(this.loader.style.display="block")},this.hide=function(){null!==this.loader&&(this.loader.style.display="none")}}}),define("ProductUtils/ModalWindow",["ko","PageConfig","ProductUtils/ComponentLoader","ProductUtils/SpinnerLoader"],function(e,t,i,n){return function(){this.components=new i,this.body=document.body,this.html=document.querySelector("html"),this.container=document.querySelector("#modal"),this.titleText=e.observable(""),this.lockBodyScroll=!0,this.title=this.container.querySelector(".modal-title h1"),this.content=this.container.querySelector(".modal-content"),this.closeArrow=this.container.querySelector(".modal-close"),this.modalScroll=this.container.querySelector(".modal-scroll"),this.modalWindow=this.container.querySelector(".modal-window"),this.modalCloseButton=this.container.querySelector(".modal-window .modal-close button.link"),this.customClasses=[],this.config=t;var r="mobile"===this.config.platform?".loader.mobile":".loader.fullwidth";this.loader=new n({selector:r}),this.componentName=null,this.hasLoaded=!1,this.open=function(e){e.showSpinner&&!this.hasLoaded&&this.loader.show(),this.setup(e),this.bindClose(),this.modalCloseButton.focus()},this.close=function(){this.tearDown()}.bind(this),this.setClass=function(e){this.customClasses.push(e),this.container.classList.add(e)},this.setAriaLabel=function(e){void 0!==e?this.modalWindow.setAttribute("aria-label",e):this.modalWindow.removeAttribute("aria-label")},this.setTitle=function(e){this.titleText(e),this.title.innerHTML=e},this.addContent=function(e){this.content.innerHTML=e,this.modalScroll.style.display=""},this.componentLoaded=function(){this.hasLoaded=!0,this.loader.hide()},this.addComponent=function(e,t,i){this.componentName=e;var n="modal-"+this.componentName,r='<div id="'+n+'"></div>';this.addContent(r),t.loadedCallback=this.componentLoaded.bind(this),this.components.register({type:this.componentName,name:this.componentName,elementId:n,
useComponentTemplate:!0},t,i)},this.setup=function(e){this.body.classList.add("lockScroll"),this.html.classList.add("lockScroll"),this.setClass("open"),this.params=e},this.tearDown=function(){this.components.unregister(this.componentName),this.setTitle(""),this.setAriaLabel(),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.trapFocus),this.title.removeEventListener("click",this.stopEventPropagation),this.content.removeEventListener("click",this.stopEventPropagation),this.closeArrow.removeEventListener("click",this.onArrowClick),this.container.removeEventListener("click",this.close),this.content.style.height="";for(var e=0;e<this.customClasses.length;e++)this.container.classList.remove(this.customClasses[e]);this.body.classList.remove("lockScroll"),this.html.classList.remove("lockScroll");var t=document.createEvent("CustomEvent");t.initCustomEvent("modalClosed",!1,!1,{}),this.body.dispatchEvent(t),this.params&&this.params.openerElement&&this.params.openerElement.focus()},this.checkEscapeKey=function(e){return 27===e.keyCode?!0:!1},this.onKeyUp=function(e){this.checkEscapeKey(e)&&this.close()}.bind(this),this.stopEventPropagation=function(e){e.stopPropagation()},this.onArrowClick=function(e){this.close(),e.preventDefault(),e.stopPropagation()}.bind(this),this.trapFocus=function(e){var t=this.container.querySelectorAll('a[href], button, input[type="text"]'),i=t[0],n=t[t.length-1];("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===i&&(n.focus(),e.preventDefault()):document.activeElement===n&&(i.focus(),e.preventDefault()))}.bind(this),this.bindClose=function(){document.addEventListener("keyup",this.onKeyUp),this.title.addEventListener("click",this.stopEventPropagation),this.content.addEventListener("click",this.stopEventPropagation),this.closeArrow.addEventListener("click",this.onArrowClick),this.container.addEventListener("click",this.close),document.addEventListener("keydown",this.trapFocus)}}}),define("Models/LocalStorageWrapper",[],function(){return function(){var e=window.localStorage;return this.isStorageAvailable=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(i){return!1}},this.addItem=function(t,i,n){this.isStorageAvailable()&&e.setItem(t,JSON.stringify({item:i,expiry:n}))},this.getItem=function(t){if(this.isStorageAvailable()){var i=e.getItem(t);if(i){var n=JSON.parse(i);return new Date(n.expiry)<new Date?void e.removeItem(t):n.item}}},this}}),define("Components/delivery-and-returns/delivery-and-returns",["ko","text!./delivery-and-returns.html","ProductUtils/Ajax","Product.Config","PageConfig","ProductUtils/ModalWindow","ProductUtils/Analytics","Models/LocalStorageWrapper","Providers/SdkProvider"],function(e,t,i,n,r,s,o,a,c){function l(t){this.state=t.state,this.isCssTagAdded=!1,this.resources=t.state.resources,this.features=t.state.features,this.deliveryReturnsLink=t.state.resources.pdp_delivery_and_returns_button,this.apiUrl=n.deliveryApiEndpoint,this.hideDeliveryLink=t.hideDeliveryLink,this.modalWindow=new s,this.currentDeliveryAndReturnsData=null,this.isPremierUser=e.observable(null),this.ajax=new i;var l=new a,d={GB:!0,IE:!0,NL:!0,BE:!0,LU:!0,SE:!0,DK:!0,AT:!0,FI:!0,GR:!0,BG:!0,CY:!0,RO:!0,EE:!0,PL:!0,PT:!0,CZ:!0,LV:!0,LT:!0,SK:!0,SI:!0,HU:!0,HR:!0,MT:!0,HK:!0,SG:!0,NZ:!0};if(this.getExpiryDate=function(){var e=new Date;return e.setSeconds(0),e.setMilliseconds(0),e.setDate(e.getDate()+1),e},this.getDeliveryAndReturnsCountryCode=function(){var e=l.getItem("DeliveryAndReturnsCountryCode");return e?e:null}.bind(this),this.error=function(e){var t="";if(e.responseJSON&&Array.isArray(e.responseJSON)){var i=e.responseJSON[0];i.errorCode&&"DNR_"===i.errorCode.substring(0,4)&&(t=i.errorMessage)}t||(t=this.resources.pdp_status_error_technical_difficulties);var n={content:t};this.showModal("error-container",this.resources.pdp_delivery_and_returns_error_technical_difficulties_title,n)}.bind(this),this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry=function(e){d[e]||(this.deliveryReturnsLink=t.state.resources.pdp_delivery_and_returns_shipping_only_button)},this.setIsPremierUser=function(){var e=function(e){var t=e.length>0&&e.indexOf(r.countryCode)>=0?"true":"false";this.isPremierUser(t)}.bind(this);return c.getIdentity().then(function(t){return t.customer.subscriptions().then(e,e.bind(this,[]))}.bind(this))},"COM"===r.storeCode){var u=l.getItem("CountryCode");u?this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry(u):r.geoCountryCode&&(this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry(r.geoCountryCode),l.addItem("CountryCode",r.geoCountryCode,this.getExpiryDate()))}this.setDeliveryAndReturnsContent=function(e){var i={content:e.result,showCountrySelectionCallback:this.requestCountriesContent,closeModalCallback:this.modalWindow.close};this.currentDeliveryAndReturnsData=e,this.showModal("delivery-and-returns-content",i.content.title,i,t.state.resources.pdp_delivery_and_returns_content_aria_label)}.bind(this),this.setCountriesContent=function(e){var i={content:e.result.countries,currentDestination:this.currentDeliveryAndReturnsData.result.destination,countrySelectionCallback:this.newCountrySelected,cancelCallback:this.cancelCountrySelectionCallback};this.showModal("delivery-and-returns-countries",t.state.resources.pdp_delivery_and_returns_select_country_title,i,t.state.resources.pdp_delivery_and_returns_select_country_aria_label)}.bind(this),this.showModal=function(e,i,n,r){this.modalWindow.close(),this.modalWindow.addComponent(e,n,t.state),this.modalWindow.setTitle(i),this.modalWindow.setClass("modal-"+e),this.modalWindow.setAriaLabel(r),this.modalWindow.open({openerElement:document.querySelector("button.link.product-delivery")})}.bind(this),this.requestDeliveryAndReturnsContent=function(e){var t="";e&&(t="&deliverycountry="+e);var i={url:this.apiUrl+"?api=1"+t+"&userispremiercustomer="+this.isPremierUser(),callerContext:"DeliveryAndReturns.MainContent",successCallback:this.setDeliveryAndReturnsContent,errorCallback:this.error,apiName:"DeliveryAndReturns"};this.ajax.execute(i)}.bind(this),this.requestCountriesContent=function(){var e={url:this.apiUrl+this.DELIVERY_COUNTRIES_URL_PATH,callerContext:"DeliveryAndReturns.CountriesList",successCallback:this.setCountriesContent,errorCallback:this.error,apiName:"DeliveryAndReturns"};this.ajax.execute(e)}.bind(this),this.addCssTag=function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",r.flagsCssPath),document.querySelector("head").appendChild(e),this.isCssTagAdded=!0},this.deliveryAndReturnsClicked=function(){this.isCssTagAdded||this.addCssTag();var e=function(){var e=void 0!==t.state.productData?t.state.productData.productId:null;o.firePageInteraction({context:"freeDeliveryAndReturns",productIID:e});var i=this.getDeliveryAndReturnsCountryCode();this.requestDeliveryAndReturnsContent(i)}.bind(this);this.setIsPremierUser().then(e,e)}.bind(this),this.cancelCountrySelectionCallback=function(){this.setDeliveryAndReturnsContent(this.currentDeliveryAndReturnsData)}.bind(this),this.newCountrySelected=function(e){l.addItem("DeliveryAndReturnsCountryCode",e,this.getExpiryDate()),this.requestDeliveryAndReturnsContent(e)}.bind(this)}return l.prototype.DELIVERY_COUNTRIES_URL_PATH="countries/?api=1",{viewModel:l,template:t}}),define("text!Components/shipping-restrictions/shipping-restrictions.html",[],function(){return'<div class="shipping-restrictions" data-bind="visible: showShippingRestrictions">\r\n    <span><a id="shippingRestrictionsLink" href="#" data-bind="text:shippingRestrictionsLabel, click:openShippingRestrictions"></a></span>\r\n</div>'}),define("ProductUtils/FullProductApiClient",["ProductUtils/Ajax","Product.Config","ProductUtils/UrlUtils","PageConfig"],function(e,t,i,n){return function(){this.productArray=[],this.callbacks=[],this.ajax=new e;var r=new i,s=function(e){return void 0!==e&&null!==e?!0:!1};this.getFullProduct=function(e,t,i){return null!==e&&void 0!==e?this.requestData(e,t,i):void 0},this.requestData=function(e,i,r){var s=t.fullProductUrl,o=i?"shippingrestrictions":void 0;return this.ajax.execute({storeParams:{store:n.storeCode,currency:n.currency,lang:n.language,sizeSchema:n.sizeSchema,keyStoreDataversion:n.keyStoreDataversion,expand:o},url:s+e,apiName:"Product Catalogue",callerContext:r,errorCallback:this.error}).done(this.productRetrieved.bind(this))}.bind(this),this.prependSiteDomain=function(e){return e.split('href="').join('href="'+n.siteDomain)}.bind(this),this.productRetrieved=function(e){e.description=this.prependSiteDomain(e.description),e.media.images=this.sortProductImages(e.media.images),e.media.catwalkUrl=this.getSingleCatwalkUrl(e);for(var t=0;t<e.media.images.length;t++){var i=e.media.images[t];i.isVisible=i.isPrimary||!s(i.colourWayId),i.url=r.formatUrl(i.url)}for(var n=0;n<e.variants.length;n++)e.variants[n].size=e.variants[n].brandSize,e.variants[n].sizeDescription&&(e.variants[n].size+=" - "+e.variants[n].sizeDescription);return e}.bind(this),this.sortProductImages=function(e){return e.sort(function(e,t){var i=t.isPrimary.toLocaleString().localeCompare(e.isPrimary.toLocaleString());if(0!==i)return i;if(void 0===e.colour||""===e.colour){if(void 0===t.colour||null===t.colour||""===t.colour)return e.type.toLocaleString().localeCompare(t.type.toLocaleString());if(t.colour&&t.colour.length>0)return 1}if(void 0===t.colour||null===t.colour||""===t.colour)return-1;var n=e.colour.toLocaleString().localeCompare(t.colour.toLocaleString());return n}),e}.bind(this),this.getSingleCatwalkUrl=function(e){return e&&e.media&&e.media.catwalk&&Array.isArray(e.media.catwalk)&&e.media.catwalk.length?e.media.catwalk[0].url:void 0},this.error=function(){}.bind(this)}}),define("Components/shipping-restrictions/shipping-restrictions",["ko","Promise","text!./shipping-restrictions.html","ProductUtils/Ajax","ProductUtils/ModalWindow","ProductUtils/Analytics","ProductUtils/FullProductApiClient","PageConfig","Product.Config"],function(e,t,i,n,r,s,o,a,c){function l(i){var l=new o;this.state=i.state,this.isInStock=this.state.productData.isInStock,this.ajax=new n;var d=i.data.shippingRestrictions;this.modalWindow=new r,this.showShippingRestrictions=e.computed(function(){return this.isInStock&&d.shippingRestrictionsVisible}.bind(this)),this.shippingRestrictionsLabel=d.shippingRestrictionsLabel,this.getIncludedCountries=function(e,t){return t.filter(function(t){return e.includedCountryCodes.indexOf(t.code)>-1}).map(function(e){return e.name})},this.openShippingRestrictions=function(){var e=i.data?i.data.productId:null;s.firePageInteraction({context:"shippingRestrictions",productIID:e});var n=l.getFullProduct(i.data.productId,!0,"ShippingRestrictions"),r=this.ajax.execute({storeParams:{lang:a.language,store:a.storeCode},url:c.deliveryOptionsApiEndpoint,callerContext:"ShippingRestrictions"});return t.all([n,r]).then(function(e){var t=e[0].shippingRestriction,i=this.getIncludedCountries(t,e[1].countries);this.showModalContent("shipping-restrictions-content",this.state.resources.pdp_shipping_restrictions_title,{ShippableCountries:i,Description:this.state.resources.pdp_shipping_restrictions_only_ships_message})}.bind(this))["catch"](function(){this.showModalContent("error-container",this.state.resources.pdp_shipping_restrictions_title,{content:this.state.resources.pdp_status_error_technical_difficulties})}.bind(this)),!1},this.showModalContent=function(e,t,i){this.modalWindow.close(),this.modalWindow.addComponent(e,i,this.state),this.modalWindow.setTitle(t),this.modalWindow.setClass("modal-"+e),this.modalWindow.open({showSpinner:!1,openerElement:document.querySelector("#shippingRestrictionsLink")})}}return{viewModel:l,template:i}}),define("text!Components/stock-price-retry/stock-price-retry.html",[],function(){return'<!-- ko if : state.showStockPriceRetry -->\r\n<div class="container">\r\n    <h1 data-bind="text: resources.pdp_status_error_stock_price_retry_title"></h1>\r\n    <div data-bind="text: resources.pdp_status_error_stock_price_retry_message"></div>\r\n\r\n    <a>\r\n        <span data-bind="click: retry, text: resources.pdp_status_error_stock_price_retry_button"></span>\r\n    </a>\r\n</div>\r\n\r\n<!-- /ko -->'}),define("Components/stock-price-retry/stock-price-retry",["ko","text!./stock-price-retry.html"],function(e,t){function i(e){this.resources=e.state.resources,this.retry=function(){e.state.retryCallback()}}return{viewModel:i,template:t}}),define("text!Components/save-button/save-button.html",[],function(){return'<div class="save-button-wrapper" data-bind="click: componentClicked">\r\n    <button class="save-button" aria-live="polite" data-bind="\r\n        click:saveProduct,\r\n        clickBubble:false,\r\n        css: {\r\n            \'animate\' : isSaved,\r\n            \'active\': active,\r\n            \'out-of-stock-save-button\': !inStock\r\n        },\r\n        markAndMeasure: \'pdp:save_for_later_interactive\',\r\n        attr: {\r\n            \'aria-label\': isSaving ? saveForLaterActiveLabel() : saveForLaterLabel(),\r\n            \'disabled\' : isSaved\r\n        }\r\n    ">\r\n        <span class="heartPrimary"></span>\r\n        <span data-bind="attr: {class : heartSecondaryClasses}">\r\n            <span class="celebrationAnimation">\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n            </span>\r\n        </span>\r\n    </button>\r\n    <span aria-live="polite" class="toolTip" data-bind="html:message,visible:displayMessage,css: { \'fade\' : fade , \'error\':isError , \'nonError\':!isError()}"></span>\r\n</div>'}),define("Models/SavedItem",[],function(){return function(e,t,i,n,r,s){this.productId="",this.variantId="",this.sizeId="-1",this.imageUrl="",this.colour="",this.sellingFast=!1,this.init=function(){void 0!==e&&this.setProductId(e),void 0!==t&&this.setVariantId(t),void 0!==i&&this.setSizeId(i),void 0!==n&&this.setImageUrl(n),void 0!==r&&this.setColour(r),void 0!==s&&this.setSellingFast(s)},this.setProductId=function(e){var t=parseInt(e);t&&(this.productId=t)},this.setVariantId=function(e){var t=parseInt(e);t&&(this.variantId=t)},this.setSizeId=function(e){var t=parseInt(e);t&&(this.sizeId=t)},this.setImageUrl=function(e){"string"==typeof e&&(this.imageUrl=e)},this.setColour=function(e){"string"==typeof e&&(this.colour=e)},this.setSellingFast=function(e){"boolean"==typeof e&&(this.sellingFast=e)},this.setValuesViaState=function(e){e&&(e.selectedColour&&void 0!==e.selectedColour()&&this.setColour(e.selectedColour().colourName),e.selectedSize&&void 0!==e.selectedSize()&&(this.setVariantId(e.selectedSize().variantId),this.setSizeId(e.selectedSize().sizeId)),void 0!==e.sellingFast&&this.setSellingFast(e.sellingFast))},this.getObject=function(){return"-1"===this.sizeId&&this.setColour(""),{productId:this.productId,variantId:this.variantId,sizeId:this.sizeId,imageUrl:this.imageUrl,colour:this.colour,sellingFast:this.sellingFast}},this.init()}}),define("Components/save-button/save-button",["ko","text!./save-button.html","Models/SavedItem","featureSwitches","PageConfig","ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider"],function(e,t,i,n,r,s,o,a){function c(t){function i(){return!t.context}function n(){return"buythelook"===t.context}function r(){return i()||n()}function c(e,i){t.state&&t.state.toast&&(i&&t.state.toast.message(i),t.state.toast.displayMessage(e))}function l(){this.isSaved(!1),this.active(!1),this.displayMessage(!1),c(!1),clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer)}function d(e){e&&(e.selectedSize.subscribe(function(){l.call(this)}.bind(this)),e.selectedColour.subscribe(function(){l.call(this)}.bind(this)))}function u(e){return e.map(function(e){var i={productId:t.productId?t.productId:e.productData.productId};return r()&&p(e)?i.variantId=p(e):h(e)&&(i.colourWayId=h(e)),i})}function h(e){return t.colourWayId?t.colourWayId:e.selectedSize()&&e.selectedSize().colourWayId?e.selectedSize().colourWayId:e.selectedColour()&&e.selectedColour().colourWayId?e.selectedColour().colourWayId:"function"==typeof e.mainImage?e.mainImage().colourWayId:e.productData.colours?e.productData.colours[0].colourWayId:void 0}function p(e){return e?e.selectedSize()&&e.selectedSize().variantId?e.selectedSize().variantId:e.selectedColour()&&e.selectedColour().variantId?e.selectedColour().variantId:void 0:!1}if(this.active=e.observable(!1),this.fade=e.observable(!0),this.displayMessage=e.observable(!1),this.message=e.observable(),this.isSaving=!1,this.isSaved=e.observable(!1),this.heartSecondaryClasses=e.observable("heartSecondary"),this.isError=e.observable(!1),this.isMixMatch=t.isMixMatch!==!0?!1:!0,this.hasSizeSelected=!1,this.fadeTimer=null,this.hideTimer=null,this.isMixMatch)for(var m=0;m<t.state.length;m++)d.call(this,t.state[m]);else d.call(this,t.state);this.saveForLaterLabel=function(){var e="";if(t.state){var i=this.isMixMatch?t.state[0].resources:t.state.resources;e=i.pdp_cta_save_for_later}return e}.bind(this),this.saveForLaterActiveLabel=function(){var e="";if(t.state){var i=this.isMixMatch?t.state[0].resources:t.state.resources;e=i.pdp_cta_save_for_later_active,this.getProductName()&&(e=e+" "+this.getProductName())}return e}.bind(this),this.getProductName=function(){return this.isMixMatch?t.productName:this.isMixMatch?void 0:t.productData.name}.bind(this),this.updateHeartSecondaryClassesForActiveCelebration=function(){a.getFeatures().then(function(e){var t=e.getFeaturesState()["web-event-icon"];if("object"==typeof t){var i=Object.keys(t);if(i.length)for(var n=0;n<i.length;n++){var r=i[n];if(t[r]){this.heartSecondaryClasses(this.heartSecondaryClasses()+" "+r);break}}}}.bind(this))}.bind(this),this.inStock=!0,this.isInStock=function(e){return!r()||e.length>0?!0:e.productData.isInStock},this.inStock=this.isInStock(t.state),this.saveProduct=function(){return this.active(!0),!this.inStock||this.isSaving||this.isSaved()?!1:void a.getSavedItems().then(function(e){var i=u(this.isMixMatch?t.state:[t.state]),n=e.addItems({items:i});s.saveVariants(i,t.state,t.context),this.watchPromise(n,i)}.bind(this))}.bind(this),this.watchPromise=function(e,i){var n=(Array.isArray(t.state)?t.state[0]:t.state)||{},r=n.resources||{};this.isSaving=!0,e.then(function(){this.isSaved(!0),this.isSaving=!1}.bind(this),function(){o.logError(new Error(o.ERROR_TYPE.UserActionFailed),{action:"SaveForLater",additionalData:JSON.stringify(i)}),this.active(!1),this.isSaving=!1,this.showMessage(r.pdp_status_error_not_saved,!0)}.bind(this))},this.componentClicked=function(){return this.displayMessage(!1),c(!1),!0}.bind(this),this.showMessage=function(e,t){this.isError(t),this.message(e),this.displayMessage(!0),c(!0,e),this.fade(!1),this.isSaved(!1),this.runTimer()},this.runTimer=function(){this.fadeTimer=setTimeout(function(){this.fade(!0),this.hideTimer=setTimeout(function(){this.displayMessage(!1)}.bind(this),1e3)}.bind(this),4500)},this.updateHeartSecondaryClassesForActiveCelebration()}return{viewModel:c,template:t}}),define("text!Components/add-item/add-item.html",[],function(){return'<div class="add-item" data-bind="visible: isVisible">\r\n    <div class="is-add-item-saving" data-bind="visible: isBusy"></div>\r\n    <span class="aria-live" aria-role="status" aria-live="polite" data-bind="{ text: ariaLiveText, attr: { \'aria-label\': ariaLiveText }}"></span>\r\n    <a href="#" class="add-button" data-bind="click: addToBag, css : buttonCss, attr: { \'aria-label\': resources.pdp_cta_add_to_bag }, markAndMeasure: \'pdp:add_to_bag_interactive\'">\r\n        <span class="product-tick" data-bind="visible: showProductTick, text: iconText"></span>\r\n        <span data-bind="text: buttonText"></span>\r\n    </a>\r\n</div>'}),define("ProductUtils/ScrollTo",["$","ko"],function(e,t){return this.scrollToElement=function(t,i){var n=e(t);n.length>0&&e("html, body").animate({scrollTop:n.offset().top+i+"px"},"fast")},this.scrollToTop=function(){e("html, body").animate({scrollTop:"0px"},"fast")},t.bindingHandlers.scrollTo={init:function(i,n){var r=n(),s=t.unwrap(r),o=s,a=0;"object"==typeof s&&(o=s.selector,s.topPadding&&(a=s.topPadding)),e(i).click(function(){this.scrollToElement(o,a)}.bind(this))}},t.bindingHandlers.scrollToTop={init:function(t){e(t).click(function(){this.scrollToTop()}.bind(this))}},this}),define("Components/add-item/add-item",["$","ko","text!./add-item.html","ProductUtils/Bag","ProductUtils/ScrollTo","PageConfig"],function(e,t,i,n,r,s){function o(e){function i(t,i){e.state&&e.state.toast&&(i&&e.state.toast.message(i),e.state.toast.displayMessage(t))}this.isVisible=e.state.productData.isInStock,this.imgUrl=e.productImage,this.scrollToTop=e.scrollToTop,this.url=e.url,this.productId=e.state.productData.productId,this.resources=e.state.resources,this.selectedColour=e.state.selectedColour,this.selectedSize=e.state.selectedSize,this.noColourSelected=e.state.showNoColourSelectedWarning,this.noSizeSelected=e.state.showNoSizeSelectedWarning,this.addedToBag=t.observable(!1),this.showProductTick=t.observable(!1),this.failedToAdd=e.state.showAddToBagError,this.failedToAddMessage=e.state.addToBagErrorMessage,this.showTryAgain=t.observable(e.showTryAgain?e.showTryAgain:!1),this.buttonText=t.observable(this.resources.pdp_cta_add_to_bag),this.isBusy=t.observable(!1),this.ariaLiveText=t.computed(function(){var e=this.failedToAddMessage();return e?e:this.addedToBag()?this.resources.pdp_status_add_to_bag_success:""},this),this.buttonCss=t.computed(function(){return this.failedToAdd()&&this.showTryAgain()?"failed":this.isBusy()?"is-disabled":""}.bind(this)),this.iconText=t.computed(function(){return this.addedToBag()?"added to basket":"add to basket"}.bind(this)),this.selectedSize.subscribe(function(e){void 0!==e&&this.noSizeSelected()&&this.noSizeSelected(!1)}.bind(this)),this.selectedColour.subscribe(function(e){void 0!==e&&this.noColourSelected()&&this.noColourSelected(!1)}.bind(this));var o=new n(e,e.initiator);this.addToBag=function(){this.isBusy()||(this.revertState(),i(!1),void 0===this.selectedColour()?this.noColourSelected(!0):void 0===this.selectedSize()?this.noSizeSelected(!0):(this.isBusy(!0),o.addItems(this.selectedSize(),this.addToBagResult)))};var a;this.addToBagResult=function(t){this.isBusy(!1),t.success?(this.addedToBag(!0),"buyTheLook"!==e.initiator&&this.showProductTick(!0),this.buttonText(this.resources.pdp_status_add_to_bag_success),this.scrollToTop&&"mobile"!==s.platform&&r.scrollToTop(),a&&clearTimeout(a),this.showMessage(this.resources.pdp_status_add_to_bag_toast),a=setTimeout(this.revertState,5e3)):(this.showTryAgain()&&this.buttonText(this.resources.pdp_status_error_add_item_try_again),this.failedToAdd(!0),this.failedToAddMessage(t.error||this.resources.pdp_status_add_to_bag_failure))}.bind(this),this.revertState=function(){this.buttonText(this.resources.pdp_cta_add_to_bag),this.addedToBag(!1),this.showProductTick(!1),this.failedToAdd(!1),this.failedToAddMessage(""),this.isBusy(!1)}.bind(this),this.showMessage=function(e){"mobile"===s.platform&&i(!0,e)}}return{viewModel:o,template:i}}),define("text!Components/payment-promo/payment-promo.html",[],function(){return'<!-- ko if : isValidTransactionAmount -->\r\n<div data-bind="attr: { class: paymentPromoWrapperClass }">\r\n    <!-- ko if : isLowerLocation -->\r\n        <h2 data-bind="text: mobilePaymentPromoTitle"></h2>\r\n    <!-- /ko -->\r\n    <!-- ko if : isDoublePromo -->\r\n        <p class="payment-promo-component" data-bind="html: paymentPromoMessaging"></p>\r\n    <!-- /ko -->\r\n    <!-- ko if : !isDoublePromo -->\r\n    <a data-bind="attr: { href: informationLinkUrl }" target="_blank" class="payment-promo-component">\r\n        <p data-bind="html: paymentPromoMessaging"></p>\r\n        <span class="payment-promo-information">\r\n        <span data-bind=\'attr: { "aria-label": logoLabel, class: logoClass }\'></span>\r\n        <span class="product-information-light" data-bind=\'attr: { "aria-label": moreInfoLabel }\'></span>\r\n    </span>\r\n    </a>\r\n    <!-- /ko -->\r\n</div>\r\n<!-- /ko -->\r\n'}),define("Asos.Web.Currency.Formatter",["exports"],function(e){"use strict";function t(e){return Math.round(e)===e}var i={"default":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"ar-AE":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-KW":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-QA":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-SA":{currencyFormatting:{"default":"4"},numberFormat:"1"},"cs-CZ":{currencyFormatting:{"default":"4"},numberFormat:"3"},"de-DE":{currencyFormatting:{"default":"4"},numberFormat:"2"},"da-DK":{currencyFormatting:{"default":"4"},numberFormat:"2"},"en-AU":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"en-GB":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"en-US":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-AR":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-CL":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-ES":{currencyFormatting:{"default":"4"},numberFormat:"2"},"es-MX":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"fa-IR":{currencyFormatting:{"default":"4"},numberFormat:"1"},"fr-FR":{currencyFormatting:{"default":"4"},numberFormat:"3"},"he-IL":{currencyFormatting:{"default":"4"},numberFormat:"1"},"hi-IN":{currencyFormatting:{"default":"4"},numberFormat:"1"},"it-IT":{currencyFormatting:{"default":"4"},numberFormat:"2"},"ja-JP":{currencyFormatting:{"default":"2"},numberFormat:"1"},"ko-KR":{currencyFormatting:{"default":"2"},numberFormat:"1"},"ms-MY":{currencyFormatting:{"default":"2"},numberFormat:"1"},"nl-NL":{currencyFormatting:{"default":"2"},numberFormat:"2"},"pl-PL":{currencyFormatting:{"default":"4"},numberFormat:"3"},"ru-RU":{currencyFormatting:{"default":"4"},numberFormat:"3"},"sv-SE":{currencyFormatting:{"default":"4"},numberFormat:"2"},"tr-TR":{currencyFormatting:{"default":"4"},numberFormat:"1"},"uk-UA":{currencyFormatting:{"default":"4"},numberFormat:"4"}},n={1:{negative:"-{C}{N}",positive:"{C}{N}"},2:{negative:"-{C} {N}",positive:"{C} {N}"},3:{negative:"-{N}{C}",positive:"{N}{C}"},4:{negative:"-{N} {C}",positive:"{N} {C}"}},r={AED:{"default":"AED"},AUD:{"default":"$"},CAD:{"default":"C$"},CHF:{"default":"CHF"},CNY:{"default":"¥"},CZK:{"default":"Kč"},DKK:{"default":"DKK","da-DK":"kr."},EUR:{"default":"€"},GBP:{"default":"£"},HKD:{"default":"HKD$"},ILS:{"default":"ILS"},INR:{"default":"INR"},IRR:{"default":"IRR"},JPY:{"default":"JPY"},KRW:{"default":"KRW"},KWD:{"default":"KWD"},MYR:{"default":"RM"},NOK:{"default":"NOK"},NZD:{"default":"NZD$"},PLN:{"default":"PLN","pl-PL":"zł."},QAR:{"default":"QAR"},RUB:{"default":"руб."},SAR:{"default":"SAR"},SEK:{"default":"SEK"},SGD:{"default":"SGD$"},TRY:{"default":"TRY"},TWD:{"default":"NT$"},UAH:{"default":"UAH"},USD:{"default":"$"}},s={1:"###,###.##",2:"###.###,##",3:"### ###,##",4:"### ###.##"},o={cultures:i,currencyFormats:n,currencySymbols:r,numberFormats:s},a=new RegExp(/(#+)([^#])(#+)([^#]|$)(#+|$)/g),c="-",l=function(e){var t=e.split(a).filter(function(e){return""!==e});if(!(t.length<3))return{digitGroupingLength:t[0].length,digitGroupingSymbol:t[1],digitsBeforeDecimal:t[2].length,decimalSeparator:t[3],decimalPlaces:t[4]?t[4].length:0}},d=function(e){return e.split("").reverse().join("")},u=function(e,t,i){var n=i.digitGroupingSymbol,r=i.digitGroupingLength,s=i.digitsBeforeDecimal,o=i.decimalSeparator,a=i.decimalPlaces,l=!!o&&!t,u=t?Math.abs(e).toString():Math.abs(e).toFixed(a),h=d(u).split(""),p=l?a+1+s:s,m=h.reduce(function(e,t,i){if(!l&&i===s)return"".concat(t).concat(n).concat(e);if(l&&i===a)return"".concat(o).concat(e);var c=i>=p,d=(i-p)%r===0;return c&&d?"".concat(t).concat(n).concat(e):"".concat(t).concat(e)});return 0>e?"".concat(c).concat(m):m},h=function(e,i){if(i&&!t(e))throw new Error("Value must be an integer when formatAsInteger is set to true, else numeric precision will be lost")},p=function(e,t,i){var n=Number(e);if(isNaN(n)||!isFinite(n))return e;h(n,i);var r=o.cultures[t]||o.cultures["default"],s=o.numberFormats[r.numberFormat],a=l(s);return a?u(n,i,a):e},m="{N}",f="{C}",v=function(e,t){var i=o.currencySymbols[e];if(!i)return"";var n=i[t]||i["default"];return n},g=function(e,t,i,n){var r=Number(e);if(!b(r))return e;var s=v(i,t),o=y(t,i);if(!s)return e;var a=p(Math.abs(r),t,n),c=0>r?o.negative:o.positive,l=c.replace(f,s);return l=l.replace(m,a)},b=function(e){return!isNaN(e)&&isFinite(e)},y=function(e,t){var i=o.cultures[e]||o.cultures["default"],n=i.currencyFormatting[t]||i.currencyFormatting["default"];return o.currencyFormats[n]};e.formatPrice=g,e.formatValue=p,e.getCurrencySymbol=v,Object.defineProperty(e,"__esModule",{value:!0})}),define("asos-web-payment-provider-instalments",[],function(){"use strict";var e=function(e,t){return i(e,t)[0]},t=function(e,t){return n(e,t)[0]},i=function(e,t){r(e,t);for(var i=t/e,n=Math.floor(100*i)/100,s=e-1,o=t-n*s,a=parseFloat(o.toFixed(2)),c=[],l=0;s>l;l++)c.push(n);return c.push(a),c},n=function(e,t){r(e,t);var i=Math.round(100*t),n=e-1,s=Math.ceil(i/e),o=i-n*s;return[s/100,s/100,s/100,Math.floor(o)/100]},r=function(e,t){if(!t||!e)throw"Incorrect number of arguments.  This function requires two numeric arguments, numberOfInstalments and totalValue.";if("number"!=typeof t||"number"!=typeof e)throw"Wrong type of argument passed in.  Both totalValue and numberOfInstalments should be numeric values."},s={getSummaryLargestLast:e,getSummarySmallestLast:t,getInstalmentsLargestLast:i,getInstalmentsSmallestLast:n};return s}),define("Components/payment-promo/payment-promo",["ko","text!./payment-promo.html","PageConfig","Asos.Web.Currency.Formatter","asos-web-payment-provider-instalments"],function(e,t,i,n,r){function s(t){function s(e,t,n){var r=i.currency.toLowerCase();if(Object.keys(e).length>1){var s=t.split(","),o=[];return s.forEach(function(t){o.push(e[t][n][r])}),o}return e[t][n][r]}function o(e){var t=void 0,i=void 0;return e.forEach(function(e){t=e.minimumTransactionAmount<t?t:e.minimumTransactionAmount,i=e.maximumTransactionAmount>i?i:e.maximumTransactionAmount}),{minimumTransactionAmount:t,maximumTransactionAmount:i}}function a(e,t){var r=e.instalmentSummary(e.instalmentCount,t);return n.formatPrice(r,i.language,i.currency)}function c(e){var t="<a href='%{informationLinkUrl}' target='_blank' rel='no-opener no-referrer'><span aria-label='%{logoLabel}' class='%{spriteClass}'></span></a>";return t.replace("%{informationLinkUrl}",e.informationLinkUrl).replace("%{logoLabel}",e.logoLabel).replace("%{spriteClass}",e.logoClass)}var l=i.countryCode.toLowerCase(),d=t.state.paymentPromotions;this.isDoublePromo=Object.keys(d).length>1;var u=Object.keys(d).toString();this.getPaymentProviderConfig=function(e,n,o){return"afterpay"===e?{moreInfoLabel:t.state.resources.pdp_misc_more_information,instalmentCount:4,messageText:t.state.resources.pdp_payment_provider_afterpay_instalments,logoLabel:t.state.resources.pdp_payment_provider_afterpay_name,logoClass:"afterpay-logo",informationLinkUrl:i.siteDomain+"/customer-service/customer-care/afterpay/?WT.oss=afterpay&ctaref=product%20page",transactionAmounts:s(n,e,o),instalmentSummary:r.getSummarySmallestLast}:"klarnaPI4"===e?{moreInfoLabel:t.state.resources.pdp_misc_more_information,instalmentCount:4,messageText:t.state.resources.pdp_payment_provider_klarna_instalments,logoLabel:t.state.resources.pdp_payment_provider_klarna_name,logoClass:"klarna-logo",informationLinkUrl:i.siteDomain+"/customer-service/customer-care/klarna",transactionAmounts:s(n,e,o),instalmentSummary:r.getSummaryLargestLast}:this.isDoublePromo&&(e.indexOf("clearpay")>=0||e.indexOf("klarnaPI3")>=0)?{klarnaPI3:{instalmentCount:3,messageText:t.state.resources.pdp_payment_provider_clearpay_klarna_instalments,
logoLabel:t.state.resources.pdp_payment_provider_klarna_name,logoClass:"klarna-logo",informationLinkUrl:i.siteDomain+"/payments-and-deliveries/klarna/",transactionAmounts:s(n,e,o),instalmentSummary:r.getSummaryLargestLast},clearpay:{instalmentCount:4,messageText:t.state.resources.pdp_payment_provider_clearpay_klarna_instalments,logoLabel:t.state.resources.pdp_payment_provider_clearpay_name,logoClass:"clearpay-logo",informationLinkUrl:i.siteDomain+"/payments-and-deliveries/clearpay/",transactionAmounts:s(n,e,o),instalmentSummary:r.getSummaryLargestLast}}:void 0}.bind(this);var h=this.getPaymentProviderConfig(u,d,l);if(this.price=t.data.price,this.isLowerLocation=t.data.isLowerLocation,this.paymentPromoWrapperClass=this.isLowerLocation?"payment-promo-wrapper-lower":"payment-promo-wrapper",this.mobilePaymentPromoTitle=this.isLowerLocation?t.state.resources.pdp_payment_provider_generic_title:"",this.isDoublePromo){if(this.isDoublePromo){var p=h[Object.keys(h)[0]];this.transactionAmounts=p.transactionAmounts}}else this.moreInfoLabel=h.moreInfoLabel,this.logoLabel=h.logoLabel,this.logoClass=h.logoClass,this.informationLinkUrl=h.informationLinkUrl,this.transactionAmounts=h.transactionAmounts;this.isValidTransactionAmount=e.computed(function(){if(r&&this.transactionAmounts){var e=this.isDoublePromo?o(this.transactionAmounts):this.transactionAmounts;return this.price()>=e.minimumTransactionAmount&&this.price()<=e.maximumTransactionAmount}}.bind(this)),this.paymentPromoMessaging=e.computed(function(){return this.price()>0&&!this.isDoublePromo?h.messageText.replace("%{instalmentCount}",h.instalmentCount).replace("%{price}",a(h,this.price())):this.price()>0&&this.isDoublePromo?p.messageText.replace("%{klarnaPrice}",a(h.klarnaPI3,this.price())).replace("%{clearpayPrice}",a(h.clearpay,this.price())).replace("%{klarnaCta}",c(h.klarnaPI3)).replace("%{clearpayCta}",c(h.clearpay)):void 0}.bind(this))}return{viewModel:s,template:t}}),define("text!Components/side-modal/side-modal.html",[],function(){return'<div class="side-modal-overlay" data-bind="click: closeModal, css: openState"></div>\r\n<div class="side-modal" data-bind="css: openState, attr: {\'aria-label\': data.ariaLabel}" role="region">\r\n    <!-- ko template: { nodes: $componentTemplateNodes, data: data } --><!-- /ko -->\r\n</div>\r\n    '}),define("Components/side-modal/side-modal",["ko","text!./side-modal.html"],function(e,t){function i(t){this.sideModalVisible=t.showModal,this.data=t.data,this.openState=e.observable(""),this.sideModalVisible.subscribe(function(e){e?(window.addEventListener("keyup",this.handleKeyUp),document.body.style.overflow="hidden",this.openState("open")):(window.removeEventListener("keyup",this.handleKeyUp),document.body.style.overflow="",this.openState(""))}.bind(this)),this.closeModal=function(){this.sideModalVisible(!1)},this.handleKeyUp=function(e){("Escape"===e.key||27===e.keyCode)&&this.closeModal()}.bind(this)}return{viewModel:i,template:t}}),define("text!Components/fit-analytics/fit-analytics.html",[],function(){return'<div id="product-size" data-bind=\'component:{\r\n    name: "product-size",\r\n    params: {\r\n        hideLabels: false,\r\n        hideLowInStock: false,\r\n        showSizeGuide: true,\r\n        state: state,\r\n        data: product,\r\n        useFitAnalytics: true,\r\n        hideOnOutOfStock : true,\r\n        context: "main",\r\n        selectorIndex: 0}\r\n    }\'></div>\r\n<div class="aside-action">\r\n    <div id="product-add" data-bind=\'component:{name: "add-item",\r\n                     params:{\r\n                         productId: product.id,\r\n                         productImage : product.images[0].url,\r\n                         scrollToTop: true,\r\n                         state: state,\r\n                         initiator : "main"\r\n                     }}\'></div>\r\n    <div id="product-save" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         productData : product,\r\n                         productId: product.id,\r\n                         productImage : product.images[0].url,\r\n                         state: state\r\n                     }\r\n                     }\'></div>\r\n    <div class="add-item-error error-message" data-bind="visible: state.showAddToBagError, html: state.addToBagErrorMessage" style="display: none">\r\n    </div>\r\n</div>\r\n<!-- ko if: showLowerSection -->\r\n<div class="fit-analytics lower">\r\n    <div class="size-guide-wrapper">\r\n        <label data-bind="text: lowerHeader"></label>\r\n        <span data-bind="text: lowerPreLinkText"></span>\r\n        <a href="" data-bind="click: openRecommendations, text: lowerLinkText"></a>\r\n        <span data-bind="text: lowerPostLinkText"></span>\r\n        <div id="size-guide" class="size-guide" data-bind=\'component: { name: "size-guide", params: {dictionary: sizeGuideDictionary , url: product.sizeGuide, visible: state.showSizeGuide, id: product.id}}\'></div>\r\n        <span data-bind="text: lowerPostSizeGuideText"></span>\r\n    </div>\r\n</div>\r\n<!-- /ko -->\r\n'}),define("Components/fit-analytics/fit-analytics",["ko","text!./fit-analytics.html","$","PageConfig","ProductUtils/Analytics","Providers/SdkProvider","ProductUtils/NewRelicLogger"],function(e,t,i,n,r,s,o){function a(t){function a(){return this.resources.pdp_fit_analytics_sizing_help_intro}function c(e){return e&&e.split("%{splitPoint}")[0]}function l(e){return e&&e.split("%{splitPoint}")[1].split("%{link}")[0]}function d(e){return e&&e.split("%{link}")[1].split("%{linkEnd}")[0]}function u(e){return e&&e.split("%{linkEnd}")[1]}function h(){switch(n.storeCode){case"COM":return"GB";case"ROW":return"ASOS_ROW";case"ROE":return"ASOS_ROE";default:return n.storeCode}}var p=this;this.enabled=!1,this.visible=e.observable(!1),this.viewData=t.data,this.state=t.state,this.product=t.data,this.widget=void 0,this.resources=t.state.resources,this.isRecognised=e.observable(!1),this.fitAssistantLogFeatureValue=e.observable(0),this.features=t.state.features,this.state.fitAnalyticsViewModel(this);var m=[],f=!1;this.analyticsContext={analyticsLoadEventFired:!1,hasPreviousPurchases:!1,bodyPart:void 0},this.RecommendationType={None:1,Partial:2,Complete:3,OOS:4},this.recommendation=e.observable(void 0),this.recommendedSize=e.observable(),this.recommendedDisplaySize=e.observable(),this.recommendationText=e.observable(),this.userInfoLevel=e.observable(),this.displayLinkText=e.computed(function(){return-1!==[this.RecommendationType.None,this.RecommendationType.Complete,this.RecommendationType.Partial,this.RecommendationType.OOS].indexOf(this.recommendation())},this),this.recommendedSize.subscribe(function(e){this.recommendedDisplaySize(this.trimRecommendationSize(e))}.bind(this)),this.init=function(){var e=this.isMobileDevice(n.platform);this.isEnabled(this.viewData.isInStock,e,n.storeCode,this.features)&&(s.getIdentity().then(function(t){t.customer.customerId().then(function(i){t.customer.isRecognised().then(function(t){this.isRecognised(t);var n=this.createFitData(this.viewData,i,this.state,e);this.createWidget(n)}.bind(this))}.bind(this))}.bind(this)),s.getFeatures().then(function(e){var t=e.ifActive("pdp-fit-assistant-logging");this.fitAssistantLogFeatureValue(t.probability)}.bind(this)))},this.createFitData=function(e,t,i,r){t||(t="");var s={productId:"asos-"+e.productCode,thumbnail:i.mainImage().url,userId:t,showMobile:r,prefetch:!0,shopCountry:h(),language:n.languageShort,shopSizingSystem:n.sizeSchema,manufacturedSizes:this.getSizes(e.variants)};return s},this.isMobileDevice=function(e){return"mobile"===e},this.isEnabled=function(e,t,i,n){return e&&this._hasMoreThanOneSize()?t?n.fitAnalyticsEnabledStoresMobile.indexOf(i.toLowerCase())>-1:n.fitAnalyticsEnabledStores.indexOf(i.toLowerCase())>-1:!1},this.getSizes=function(e){for(var t={},i=0;i<e.length;i++){var n=this.formatSizes(e[i].size);t[n]=e[i].isInStock}return t},this._hasMoreThanOneSize=function(){return!this.product.isNoSize&&!this.product.isOneSize}.bind(this),this.formatSizes=function(e){var t=e.split("-"),i=t[0].replace(/\s+$/,"");return i};var v=function(){var e={recommendationType:p.recommendation(),hasPreviousPurchaseData:p.analyticsContext.hasPreviousPurchases,userSignedIn:p.isRecognised(),recommendedSize:p.recommendedSize()};return p.analyticsContext.bodyPart&&(e.bodyCategory=p.analyticsContext.bodyPart),t.state.fitAnalyticsContext=e,e};this.fireAnalyticsLoadEvent=function(){if(this.visible()&&!this.analyticsContext.analyticsLoadEventFired){var e=v();r.fireFitAnalyticsLoadEvent(e),this.analyticsContext.analyticsLoadEventFired=!0}},this.fireAnalyticsOutOfScaleEvent=function(){var e=v();r.fireFitAnalyticsOutOfScaleEvent(e)},this.trimRecommendationSize=function(e){return e?e.replace(/(in|cm|UK|EU|Chest)/g,"").split("-")[0].trim():e},this.onRecommendationReceived=function(e,t){if(this.visible(!0),t&&void 0!==t.hasPastPurchases&&(this.analyticsContext.hasPreviousPurchases=t.hasPastPurchases),this.recommendation(this.RecommendationType.None),this.recommendedSize(void 0),this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_none),"new user"===e)return void this.fireAnalyticsLoadEvent(v());if(t){if(this.userInfoLevel(t.userInfoLevel),t.outOfScale)return void this.fireAnalyticsOutOfScaleEvent();if(e&&this.recommendedSize(e),t.outOfStock)return this.recommendationText(this.resources.pdp_fit_analytics_recommendation_oos.replace("%{size}",e)),this.recommendation(this.RecommendationType.OOS),void this.fireAnalyticsLoadEvent(v());1===t.userInfoLevel?(this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_partial.replace("%{size}",e)),this.recommendation(this.RecommendationType.Partial)):2===t.userInfoLevel&&(this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_complete.replace("%{size}",e)),this.recommendation(this.RecommendationType.Complete)),this.lastRecommendationDetails=t,this.fireAnalyticsLoadEvent(v())}},this.onLoadReceived=function(e){e&&e.garment&&(this.analyticsContext.bodyPart=e.garment.category),this.isLoaded(!0),this.fireAnalyticsLoadEvent(v())},this.openRecommendations=function(){if(this.widget){this.widget.open();var e=v();r.fireFitAnalyticsOpenWidgetEvent(e)}},this.onWidgetOpened=function(){f=!0},this.onWidgetClosed=function(){var e=v();e.widgetScreenEvents=m.slice(0),r.fireFitAnalyticsCloseWidgetEvent(e),f=!1,m.length=0},this.onMetricEventReceived=function(e,t){f&&m.push({event:e,value:t})},this.isLoaded=e.observable(!1),this.executeByProbability=function(e,t){var i=Math.round(100*Math.random());t>=i&&e()},this.createWidget=function(e){window._fitAnalytics=function(){p.widget=new FitAnalyticsWidget({productId:e.productId,thumb:e.thumbnail,manufacturedSizes:e.manufacturedSizes,userId:e.userId,language:e.language,showMobile:e.showMobile,shopCountry:e.shopCountry,shopSizingSystem:e.shopSizingSystem,prefetch:e.prefetch,close:function(e,t,i){p.onRecommendationReceived(t,i),p.onWidgetClosed()},open:function(){p.onWidgetOpened()},metricEvent:function(e,t,i){p.onMetricEventReceived(e,t,i)},error:function(e,t){t&&"product_not_published"!==t.code&&"product_not_found"!==t.code&&p.executeByProbability(function(){var i=new Error(o.ERROR_TYPE.FitAssistantError);o.logError(i,{productSerial:e,errorCode:t.code,errorMessage:t.message})},p.fitAssistantLogFeatureValue())},recommend:function(e,t,i){p.onRecommendationReceived(t,i)},load:function(e,t){p.onLoadReceived(t),p.widget.getRecommendation(),i("#existing-size-chart").hide()}})};var t=document.createElement("script");t.id="fitAnalyticsScript",t.src="//widget.fitanalytics.com/widget.js",t.crossOrigin="anonymous",document.body.appendChild(t)},this.showLowerSection=e.computed(function(){return this.isLoaded()?2!==this.userInfoLevel()?!0:this.state.showSizeGuide():!1}.bind(this)),this.getLowerText=function(e){if(this.recommendation()===this.RecommendationType.None)return e(this.resources.pdp_fit_analytics_sizing_help_profile_none);switch(this.userInfoLevel()){case 1:return e(this.resources.pdp_fit_analytics_sizing_help_profile_partial);case 2:return e(this.resources.pdp_fit_analytics_sizing_help_profile_complete);default:return e(this.resources.pdp_fit_analytics_sizing_help_profile_none)}},this.lowerHeader=this.resources.pdp_fit_analytics_sizing_help_title,this.lowerPreLinkText=e.computed(function(){return a.call(this)}.bind(this)),this.lowerPostLinkText=e.computed(function(){return this.state.showSizeGuide()?this.getLowerText(l):void 0}.bind(this)),this.lowerPostSizeGuideText=e.computed(function(){var e=this.getLowerText(u);if(e&&!(e.length<=1))return e}.bind(this)),this.lowerLinkText=e.computed(function(){var e=this.getLowerText(c);if(this.lowerPostLinkText())return e;var t=this.getLowerText(u);return!t||t.length>1?e:e+t}.bind(this)),this.sizeGuideDictionary={pdp_size_guide_link:e.computed(function(){if(this.state.showSizeGuide()){var e=this.getLowerText(d),t=this.getLowerText(u);return!t||t.length>1?e:e+t}}.bind(this)),pdp_misc_close:this.resources.pdp_misc_close,pdp_size_guide_aria_label:this.resources.pdp_size_guide_aria_label},this.init()}return{viewModel:a,template:t}}),define("text!Components/toast/toast.html",[],function(){return'<span class="toast" data-bind="html: message, visible: displayMessage, css: { \'fade\': fade }"></span>'}),define("Components/toast/toast",["ko","text!./toast.html"],function(e,t){function i(t){this.fade=e.observable(!1),this.displayMessage=t.state.toast.displayMessage,this.message=t.state.toast.message,this.fadeTimer=null,this.hideTimer=null,this.message.subscribe(function(e){clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer),e&&(this.fade(!1),this.runTimer())}.bind(this)),this.displayMessage.subscribe(function(e){clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer),e&&(this.fade(!1),this.runTimer())}.bind(this)),this.runTimer=function(){this.fadeTimer=setTimeout(function(){this.fade(!0),this.hideTimer=setTimeout(function(){this.displayMessage(!1)}.bind(this),1e3)}.bind(this),4500)}}return{viewModel:i,template:t}}),define("ProductUtils/OutOfStockAnimator",[],function(){function e(){function e(){return window.innerWidth<720}function t(){var e=_.filter(function(e){return y.submodulesCompleted[e]()===y.CAROUSEL_LOADING_STATE.NOT_LOADED});return 0!==e.length}function i(){var e=_.filter(function(e){return y.submodulesCompleted[e]()===y.CAROUSEL_LOADING_STATE.HAS_DATA});return 0!==e.length}function n(){if(I===w.ANIMATION_STATUS.UP){for(var e in k)k[e].dispose();g.removeEventListener("click",n,!0),w.animateDown()}}function r(){setTimeout(function(){g.addEventListener("click",n,!0)},w.ANIMATION_DURATION)}function s(){if(I===w.ANIMATION_STATUS.INITIAL&&y&&!t()&&i()){if(o(),!b)return setTimeout(s,w.DOM_CHECK_INTERVAL);w.animateUp(),r()}}function o(){h=document.querySelector("#asos-product"),v=document.querySelector("#lower-content"),p=document.querySelector(".product-gallery"),g=document.querySelector("#asos-product > #core-product"),b=document.querySelector(".product-code"),m=document.querySelector(".layout-aside"),f=m.innerHTML}function a(e){return e.getBoundingClientRect().top+document.documentElement.scrollTop}function c(e){return e.getBoundingClientRect().bottom+document.documentElement.scrollTop}function l(){m.style.display="none",m.innerHTML="";var e=document.createElement("div");e.id="newAsideContainer",e.classList.add("layout-aside"),e.innerHTML=f,v.insertBefore(e,v.firstChild)}function d(){var e=document.getElementById("newAsideContainer");m.innerHTML=e.innerHTML,m.style.display="block",v.removeChild(e)}function u(){e()&&(I===w.ANIMATION_STATUS.INITIAL&&l(),I===w.ANIMATION_STATUS.SEQUENCE_COMPLETED&&d())}var h,p,m,f,v,g,b,y,S,w=this,k=[],_=["buyTheLook","recommendations"],I=w.ANIMATION_STATUS.INITIAL;this.isClickTargetHigherThanLowerContent=function(e){return e.getBoundingClientRect().top<v.getBoundingClientRect().top},this.subscribeToLoadingState=function(e){y=e,k.push(y.submodulesCompleted.buyTheLook.subscribe(s)),k.push(y.submodulesCompleted.recommendations.subscribe(s))},this.getAnimationTopPosition=function(){return e()?w.ANIMATION_TOP_POSITION.MOBILE:c(b)-a(p)+w.ANIMATION_TOP_POSITION.DESKTOP},this.animateUp=function(){o(),u(),I=w.ANIMATION_STATUS.MOVING_UP,S=p.getBoundingClientRect().height,p.style.maxHeight=S+"px",setTimeout(function(){p.style.maxHeight=w.getAnimationTopPosition()+"px",p.style.marginBottom="0px",h.classList.add("animated-up"),setTimeout(function(){I=w.ANIMATION_STATUS.UP},w.ANIMATION_DURATION)},w.ANIMATION_TIMEOUT_DELAY)},this.animateDown=function(){o(),I=w.ANIMATION_STATUS.MOVING_DOWN,p.style.maxHeight=S+"px",h.classList.add("animating-down"),setTimeout(function(){p.style.marginBottom="",p.removeAttribute("style"),h.classList.remove("animated-up"),h.classList.remove("animating-down"),I=w.ANIMATION_STATUS.SEQUENCE_COMPLETED,u()},w.ANIMATION_DURATION)}}var t=e.prototype;return t.ANIMATION_DURATION=2e3,t.DOM_CHECK_INTERVAL=250,t.ANIMATION_TOP_POSITION={MOBILE:190,DESKTOP:60},t.ANIMATION_TIMEOUT_DELAY=20,t.ANIMATION_STATUS={INITIAL:0,MOVING_UP:1,UP:2,MOVING_DOWN:3,SEQUENCE_COMPLETED:4},new e}),define("ProductUtils/EnhanceNewRelicPageView",["PageConfig","ProductUtils/Window"],function(e,t){return function(){"object"==typeof t.NREUM&&"function"==typeof t.NREUM.setCustomAttribute&&(t.NREUM.setCustomAttribute("version",e.version),t.NREUM.setCustomAttribute("storeId",e.storeCode),t.NREUM.setCustomAttribute("platform",e.platform),t.NREUM.setCustomAttribute("keyStoreDataversion",e.keyStoreDataversion),t.NREUM.setCustomAttribute("browseCountry",e.countryCode),t.NREUM.setCustomAttribute("browseCurrency",e.currency),t.NREUM.setCustomAttribute("browseLanguage",e.language),t.NREUM.setCustomAttribute("browseSizeSchema",e.sizeSchema),t.NREUM.setCustomAttribute("siteChromeTemplateVersion",e.siteChromeTemplateVersion),t.NREUM.setCustomAttribute("siteChromeTemplateBuild",e.siteChromeTemplateBuild),t.NREUM.setCustomAttribute("userAgent",t.navigator.userAgent))}}),define("text!Components/delivery-and-returns-content-table/delivery-and-returns-content-table.html",[],function(){return'<div class="delivery-options">\r\n    <!-- ko if : !isMobile-->\r\n    <hr />\r\n    <!-- ko foreach: content.deliveryGroups -->\r\n    <table>\r\n        <thead>\r\n            <tr class="delivery-and-returns-group-name">\r\n                <th scope="colgroup" colspan="3">\r\n                    <h2 data-bind="text: name"></h2>\r\n                </th>\r\n            </tr>\r\n            <!-- ko if:$index()===0 -->\r\n            <tr class="delivery-and-returns-headings">\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.type"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.when"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.howMuch"></th>\r\n            </tr>\r\n            <!-- /ko -->\r\n        </thead>\r\n        <tbody data-bind="foreach: options">\r\n            <tr>\r\n                <th scope="row" class="delivery-type" data-bind="html: type"></th>\r\n                <td class="delivery-when" data-bind="html: when"></td>\r\n                <td class="delivery-how-much" data-bind="with: $parents[1].formatHowMuch(howMuch)">\r\n                    <span class="delivery-cost" data-bind="html: price"></span>\r\n                    <span class="delivery-free-condition" data-bind="html: freeCondition"></span>\r\n                    <span class="delivery-premier-qualifier" data-bind="html: premierQualifier"></span>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n    <hr />\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- ko if : isMobile-->\r\n    <!-- ko foreach: content.deliveryGroups -->\r\n    <table>\r\n        <thead>\r\n            <tr class="delivery-and-returns-group-name">\r\n                <th scope="colgroup" colspan="2">\r\n                    <h2 data-bind="text: name"></h2>\r\n                </th>\r\n            </tr>\r\n            <!-- ko if:$index()===0 -->\r\n            <tr class="delivery-and-returns-headings">\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.type"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.howMuch"></th>\r\n            </tr>\r\n            <!-- /ko -->\r\n        </thead>\r\n        <tbody data-bind="foreach: options">\r\n            <tr>\r\n                <td>\r\n                    <span class="delivery-type" data-bind="html: type"></span>\r\n                    <span class="delivery-when" data-bind="html: when"></span>\r\n                </td>\r\n                <td class="delivery-how-much" data-bind="with: $parents[1].formatHowMuch(howMuch)">\r\n                    <span class="delivery-cost" data-bind="html: price"></span>\r\n                    <span class="delivery-free-condition" data-bind="html: freeCondition"></span>\r\n                    <span class="delivery-premier-qualifier" data-bind="html: premierQualifier"></span>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n    <hr />\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: content.deliveryGroups.length === 0 -->\r\n    <div class="delivery-messaging">\r\n        <div class="delivery-error">\r\n            <div class="information-icon sprite product-information"></div>\r\n            <div class="information-text">\r\n                <span data-bind="text: resources.pdp_delivery_and_returns_options_error_message"></span>\r\n            </div>\r\n        </div>\r\n        <div class="delivery-text">\r\n            <p data-bind="text: resources.pdp_delivery_and_returns_options_unavailable"></p>\r\n            <p data-bind="text: resources.pdp_delivery_and_returns_options_additional_messaging"></p>\r\n        </div>\r\n        <button class="preferences" data-bind="text: resources.pdp_delivery_and_returns_options_preferences_button, click: openCountrySelector"></button>\r\n    </div>\r\n    <!-- /ko -->\r\n    <!-- ko if: content.deliveryGroups.length > 0  -->\r\n    <span class="delivery-terms" data-bind="text: content.terms"></span>\r\n\r\n    <!-- /ko -->\r\n</div>'}),define("Components/delivery-and-returns-content-table/delivery-and-returns-content-table",["ko","text!./delivery-and-returns-content-table.html","PageConfig"],function(e,t,i){function n(e){this.content=e.data.content,this.closeModalCallback=e.data.closeModalCallback,this.isMobile="mobile"===i.platform,this.state=e.state,this.resources=this.state.resources,this.formatHowMuch=function(e){var t=e[0],i=null,n=null;return e.length>1&&(i=e[1],e.length>2&&(n=e[2])),{price:t,freeCondition:i,premierQualifier:n}}.bind(this),this.openCountrySelector=function(){this.closeModalCallback(),window.asos.siteChrome.openCountrySelector()}.bind(this)}return{viewModel:n,template:t}}),define("text!Components/delivery-and-returns-content-link/delivery-and-returns-content-link.html",[],function(){return'<div class="delivery-and-returns-content-link">\r\n    <p class="delivery-and-returns-link-title" data-bind="text: resources.pdp_delivery_and_returns_usa_link_title"></p>\r\n    <p class="delivery-and-returns-link-message" data-bind="text: resources.pdp_delivery_and_returns_usa_link_message"></p>\r\n    <a class="button" href="#" data-bind="attr: {href: deliveryUrl}" target="_blank">\r\n        <span data-bind="text: resources.pdp_delivery_and_returns_delivery_info_link_text"></span>\r\n        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">\r\n            <path fill="#FFFFFF" fill-rule="evenodd" d="M14 12h2V2H6v2h8v8zm0 2v4H0V4h4V0h14v14h-4zM4 6H2v10h10V6H4z"/>\r\n        </svg>\r\n    </a>\r\n</div>'}),define("Components/delivery-and-returns-content-link/delivery-and-returns-content-link",["ko","text!./delivery-and-returns-content-link.html","PageConfig","Product.Config"],function(e,t,i,n){function r(e){this.content=e.data.content,this.countryCode=e.data.countryCode,this.isMobile="mobile"===i.platform,this.resources=e.state.resources,this.deliveryUrl=n.deliveryApiEndpoint+"?country="+this.countryCode}return{viewModel:r,template:t}}),define("ProductUtils/SchemaOrgTemplate",["ProductUtils/NewRelicLogger"],function(e){return new function(){this.mergeJsons=function(e,t){var i=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(t));for(var r in n)i[r]=n[r];return i},this.createAndInsertInToPage=function(t,i){try{var n=this.dataMapper(t,i),r=this.rootTemplate(n),s=document.createElement("script");s.id="structured-data",s.type="application/ld+json",s.textContent=r,document.body.appendChild(s)}catch(o){e.logError(o,{action:"RenderingStructuredDataToPage",message:"Error while generating/adding structured data"})}},this.dataMapper=function(e,t){var i=function(){var e=document.querySelectorAll("#product-details .product-description p, #product-details .product-description span, #product-details .product-description li"),t=Array.prototype.slice.call(e);if(t.length){var i=t.reduce(function(e,t){return e+"\n"+t.textContent},"");return i.replace(/\s+/g," ").trim()}return""}(),n=function(){var i="undefined";if("function"==typeof e.mainImage){var n=e.mainImage();n.url&&(i=n.url)}else{var r=t.images.filter(function(e){return e.isPrimary===!0});r&&r.length&&r[0].url&&(i=r[0].url)}return i},r=function(i){var n="undefined";if("function"==typeof e.mainImage){var r=e.mainImage();r.url&&(n=r.url)}else{var s=t.images.filter(function(e){return e.colourWayId===i.colourWayId});s&&s.length&&s[0].url&&(n=s[0].url)}return n},s={name:t.name,productId:t.productId,image:n(),brand:{name:t.brandName},sku:t.productCode,color:1===e.productData.colours.length?e.productData.colours[0].colourName:void 0,url:document.querySelector("link[rel=canonical]").href,description:i,aggregateOffer:{lowPrice:e.productData.minPrice.value,highPrice:t.variants.reduce(function(e,t){return Math.max(e,t.price.current.value)},!1),currency:t.productPrice.currency,isInStock:e.productData.isInStock,offers:t.variants.map(function(e){return{price:e.price.current.value,currency:e.price.currency,isInStock:e.isInStock,product:{name:t.name,sku:e.sku,color:e.colourName,image:r(e),brand:{name:t.brandName},description:i}}})}};return s},this.rootTemplate=function(e){var t=this.productTemplate(e),i={"@context":"http://schema.org/",brand:this.brandTemplate(e.brand),offers:this.aggregateOfferTemplate(e.aggregateOffer),productID:e.productId,url:e.url};return JSON.stringify(this.mergeJsons(t,i))},this.productTemplate=function(e){return{"@type":"Product",name:e.name,sku:e.sku,color:e.color,image:e.image,brand:this.brandTemplate(e.brand),description:e.description}},this.brandTemplate=function(e){return{"@type":"Brand",name:e.name}},this.sellerTemplate=function(){return{"@type":"Organization",name:"ASOS"}},this.aggregateOfferTemplate=function(e){var t=this;return{"@type":"AggregateOffer",lowPrice:e.lowPrice,highPrice:e.highPrice,priceCurrency:e.currency,availability:e.isInStock?"http://schema.org/InStock":"http://schema.org/OutOfStock",offerCount:e.offers.length,offers:e.offers.map(function(e){return t.offerTemplate(e)})}},this.offerTemplate=function(e){return{"@type":"Offer",price:e.price,priceCurrency:e.currency,itemOffered:this.productTemplate(e.product),seller:this.sellerTemplate(),availability:e.isInStock?"http://schema.org/InStock":"http://schema.org/OutOfStock",itemCondition:"http://schema.org/NewCondition"}}}}),define("text!Components/error-banner/error-banner.html",[],function(){return'<div class="error-banner" data-bind="css: { open: displayError }">\r\n    <span class="information-icon sprite product-information"></span>\r\n    <button class="product-close" data-bind="click: closeMessage, attr: { \'aria-label\': state.resources.pdp_misc_close }"></button>\r\n    <p class="error-banner-message" data-bind="text: errorMessage"></p>\r\n</div>\r\n<div aria-live="polite" aria-relevant="all" role="status" class="error-banner-aria-message" data-bind="text: state.errorBanner.message"></div>'}),define("Components/error-banner/error-banner",["ko","text!./error-banner.html"],function(e,t){function i(e){this.displayError=e.state.errorBanner.displayError,this.errorMessage=e.state.errorBanner.message,this.closeMessage=function(){this.displayError(!1),setTimeout(function(){this.errorMessage("")}.bind(this),n)}.bind(this)}var n=400;return{viewModel:i,template:t}}),define("text!Components/shipping-restrictions-content/shipping-restrictions-content.html",[],function(){return'<div class="shipping-restrictions-content">\r\n    <div class="shipping-restriction-filter">\r\n        <label for="shippable-countries-input" data-bind="text: countryFilterLabel"></label>\r\n        <input id="shippable-countries-input" type="text" data-bind="textInput: countryFilter" />\r\n    </div>\r\n    <div class="shippable-countries" data-bind="visible: shippableCountriesVisible">\r\n        <span class="shipping-restriction-description" data-bind="text: description"></span>\r\n        <ul data-bind="foreach:filteredShippableCountriesGroupOne">\r\n            <li>\r\n                <span data-bind="text: $data"></span>\r\n            </li>\r\n        </ul>\r\n        <ul data-bind="visible: shippableCountriesGroupTwoVisible, foreach:filteredShippableCountriesGroupTwo">\r\n            <li>\r\n                <span data-bind="text: $data"></span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="shipping-restrictions-no-matches" data-bind="visible: noMatchesVisible">\r\n        <span data-bind="text: noMatches"></span>\r\n    </div>\r\n</div>'}),define("Components/shipping-restrictions-content/shipping-restrictions-content",["ko","text!./shipping-restrictions-content.html"],function(e,t){function i(t){this.resources=t.state.resources,this.countryFilterLabel=this.resources.pdp_shipping_restrictions_filter_countries_label,this.noMatches=this.resources.pdp_shipping_restrictions_error_no_matching_countries_message,this.description=t.data.Description,this.shippableCountries=e.observableArray(t.data.ShippableCountries),this.countryFilter=e.observable(""),this.filteredShippableCountries=e.computed(function(){return this.countryFilter||this.countryFilter()?e.utils.arrayFilter(this.shippableCountries(),function(e){return e.toLowerCase().indexOf(this.countryFilter().toLowerCase())>=0}.bind(this)):this.shippableCountries()}.bind(this)),this.filteredShippableCountriesGroupOne=e.computed(function(){if(this.filteredShippableCountries){var e=Math.ceil(this.filteredShippableCountries().length/2);return this.filteredShippableCountries().slice(0,e)}return[]}.bind(this)),this.filteredShippableCountriesGroupTwo=e.computed(function(){if(this.filteredShippableCountries){var e=Math.ceil(this.filteredShippableCountries().length/2);return this.filteredShippableCountries().slice(e)}return[]}.bind(this)),this.shippableCountriesVisible=e.computed(function(){return this.filteredShippableCountriesGroupOne&&this.filteredShippableCountriesGroupOne().length>0}.bind(this)),this.shippableCountriesGroupTwoVisible=e.computed(function(){return this.filteredShippableCountriesGroupTwo&&this.filteredShippableCountriesGroupTwo().length>0}.bind(this)),this.noMatchesVisible=e.computed(function(){return!this.shippableCountriesVisible()}.bind(this))}return{viewModel:i,template:t}}),define("text!Components/delivery-and-returns-content/delivery-and-returns-content.html",[],function(){return'<div class="delivery-and-returns-content">\r\n    <div class="deliver-to">\r\n        <!-- ko if : !isMobile-->\r\n        <div class="current-country" data-bind="attr: { \'aria-label\': content.destination.label + \' \' + content.destination.selected.name }">\r\n            <span aria-hidden="true" class="country-label" data-bind="text: content.destination.label"></span>\r\n            <span aria-hidden="true" class="country-name dr-flag" data-bind="css: getCountryCode(), text: content.destination.selected.name"></span>\r\n        </div>\r\n        <div class="country-selection">\r\n            <div class="text-overlay"></div>\r\n            <button class="link" data-bind="click: countrySelectionClicked">\r\n                <span data-bind="text: content.destination.changeCountry"></span>\r\n            </button>\r\n        </div>\r\n        <!-- /ko -->\r\n        <!-- ko if : isMobile-->\r\n        <button class="link" data-bind="click: countrySelectionClicked">\r\n            <div class="current-country">\r\n                <span class="country-label" data-bind="text: content.destination.label"></span>\r\n                <span class="country-name dr-flag" data-bind="css: getCountryCode(), text: content.destination.selected.name"></span>\r\n            </div>\r\n            <div class="country-selection">\r\n                <div class="text-overlay"></div>\r\n                <span class="product-chevron" data-bind="text: content.destination.changeCountry"></span>\r\n            </div>\r\n        </button>\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n    <!-- ko if: isUsa() -->\r\n    <div data-bind="component: { name: \'delivery-and-returns-content-link\', params: { data: { content: content, countryCode: getCountryCode() }, state: state } }"></div>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: !isUsa() -->\r\n    <div data-bind="component: { name: \'delivery-and-returns-content-table\', params: { data: { content: content, closeModalCallback: closeModalCallback }, state: state } }"></div>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: showPremier-->\r\n    <div class="premier-delivery">\r\n        <div class="premier-image">\r\n            <img data-bind="attr: { src: content.premier.image }" alt=""/>\r\n        </div>\r\n        <div class="premier-text">\r\n            <h2 data-bind="text: content.premier.title"></h2>\r\n            <span data-bind="text: content.premier.text"></span>\r\n            <a class="premier-link" data-bind="text: content.premier.linkText, attr : {href: content.premier.link}" target="_blank"></a>\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n    <div class="returns">\r\n        <div class="information-icon sprite product-information"></div>\r\n        <div class="information-text">\r\n            <h2 data-bind="text: content.returns.title"></h2>\r\n            <span data-bind="html: buildReturnsParagraph()"></span>\r\n        </div>\r\n    </div>\r\n</div>';
}),define("Components/delivery-and-returns-content/delivery-and-returns-content",["ko","text!./delivery-and-returns-content.html","PageConfig"],function(e,t,i){function n(e){this.content=e.data.content,this.countrySelectedCallback=e.data.showCountrySelectionCallback,this.closeModalCallback=e.data.closeModalCallback,this.showPremier=null!==this.content.premier,this.isMobile="mobile"===i.platform,this.state=e.state,this.resources=this.state.resources,this.countrySelectionClicked=function(){this.countrySelectedCallback()},this.getCountryCode=function(){return this.content.destination.selected["2-iso"].toLowerCase()}.bind(this),this.isUsa=function(e){return"us"===this.getCountryCode(e)}.bind(this),this.getReturnRedirectLink=function(){return this.content.returns.link+"?country="+this.getCountryCode()}.bind(this),this.buildReturnsParagraph=function(){return this.resources.pdp_delivery_and_returns_returns_info_link_text.replace("%{link}",'<a href="'+this.getReturnRedirectLink()+'" target="_blank">').replace("%{linkEnd}",'</a><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#2D2D2D" fill-rule="evenodd" d="M14 12h2V2H6v2h8v8zm0 2v4H0V4h4V0h14v14h-4zM4 6H2v10h10V6H4z"/></svg>')}.bind(this)}return{viewModel:n,template:t}}),define("text!Components/delivery-and-returns-countries/delivery-and-returns-countries.html",[],function(){return'<div class="delivery-and-returns-countries">\r\n    <!-- ko if : !isMobile -->\r\n    <div class="current-country-cancel">\r\n        <div class="current-country" data-bind="attr: { \'aria-label\': destination.label + \' \' + destination.selected.name }">\r\n            <span aria-hidden="true" class="country-label" data-bind="text: destination.label"></span>\r\n            <span aria-hidden="true" class="country-name dr-flag" data-bind="css: getFlagCountryCode(destination.selected[\'2-iso\']), text: destination.selected.name"></span>\r\n        </div>\r\n        <div class="cancel-country-selection">\r\n            <div class="text-overlay"></div>\r\n            <button class="link" data-bind="click: cancelClicked"><span data-bind="text: cancelLabel"></span></button>\r\n        </div>\r\n    </div>\r\n    <hr aria-hidden="true" />\r\n    <!-- /ko -->\r\n    <!-- ko if : isMobile-->\r\n    <div class="cancel-country-selection-container">\r\n        <div class="cancel-country-selection">\r\n            <button class="link" data-bind="click: cancelClicked"><span data-bind="text: cancelLabel"></span></button>\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n    <div class="countries-filter">\r\n        <label for="countries-input" data-bind="text: countryFilterLabel"></label>\r\n        <div class="country-filter-input">\r\n            <input id="countries-input" type="text" data-bind="textInput: countryFilter" />\r\n            <button class="link" data-bind="visible: clearButtonVisible, text: clearCountryFilterLabel, click: clearCountryFilter"></button>\r\n        </div>\r\n    </div>\r\n    <div class="matching-countries" data-bind="visible: countriesVisible">\r\n        <ul data-bind="foreach: filteredCountries">\r\n            <li>\r\n                <button class="link dr-flag" data-bind="css: $parent.getFlagCountryCode(Code), text: Name, click: $parent.countryClicked.bind($data)"></button>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="no-matches" data-bind="visible: noMatchesVisible">\r\n        <span data-bind="text: noMatches"></span>\r\n    </div>\r\n</div>'}),define("Components/delivery-and-returns-countries/delivery-and-returns-countries",["ko","text!./delivery-and-returns-countries.html","PageConfig"],function(e,t,i){function n(t){this.isMobile="mobile"===i.platform,this.resources=t.state.resources,this.countrySelectedCallback=t.data.countrySelectionCallback,this.cancelCallback=t.data.cancelCallback,this.cancelLabel=this.resources.pdp_delivery_and_returns_cancel_button,this.clearCountryFilterLabel=this.resources.pdp_delivery_and_returns_clear_button,this.countryFilterLabel=this.resources.pdp_delivery_and_returns_filter_countries_label,this.noMatches=this.resources.pdp_delivery_and_returns_error_no_matching_countries_message;var n=t.data.content;n.sort(function(e,t){var i=e.Name,n=t.Name;return n>i?-1:i>n?1:0}),this.countries=e.observableArray(n),this.destination=t.data.currentDestination,this.countryFilter=e.observable(""),this.clearButtonVisible=e.computed(function(){return this.countryFilter().length>0}.bind(this)),this.getFlagCountryCode=function(e){return e.toLowerCase()}.bind(this),this.countryClicked=function(e){this.countrySelectedCallback(e.Code)}.bind(this),this.cancelClicked=function(){this.cancelCallback()}.bind(this),this.clearCountryFilter=function(){this.countryFilter("")}.bind(this),this.filteredCountries=e.computed(function(){return this.countryFilter||this.countryFilter()?e.utils.arrayFilter(this.countries(),function(e){return e.Name.toLowerCase().indexOf(this.countryFilter().toLowerCase())>=0}.bind(this)):this.countries()}.bind(this)),this.countriesVisible=e.computed(function(){return this.filteredCountries().length>0}.bind(this)),this.noMatchesVisible=e.computed(function(){return!this.countriesVisible()}.bind(this))}return{viewModel:n,template:t}}),define("text!Components/error-container/error-container.html",[],function(){return'<div class="error-container">\r\n    <span class="product-information">Info</span>\r\n    <span class="error" data-bind="html: error"></span>\r\n</div>'}),define("Components/error-container/error-container",["ko","text!./error-container.html"],function(e,t){function i(e){this.error=e.data.content}return{viewModel:i,template:t}}),define("Components/product-details/product-details",["ko","ProductUtils/Analytics","ProductUtils/Window","ProductUtils/debouncer","Providers/SdkProvider"],function(e,t,i,n,r){function s(s){this.isOpen=e.observable(!1),this.id=void 0!==s.data?s.data.id:null,this.containerHeight=e.observable(),this.overflowContainer=i.document.getElementById("product-details-container"),this.setupDetailsContainer=function(){this.productDetailsMaxHeightOpen=this.overflowContainer.scrollHeight+"px"},this.setupDetailsContainer(),this.toggle=function(){this.isOpen()?this.close():this.open()},this.open=function(){t.firePageInteraction({context:"showMore",productIID:this.id}),this.containerHeight(this.productDetailsMaxHeightOpen),this.isOpen(!0)},this.close=function(){t.firePageInteraction({context:"showLess",productIID:this.id}),this.containerHeight(null),this.isOpen(!1)},i.addEventListener("resize",n.debounce(this.setupDetailsContainer.bind(this),200)),r.getFeatures().then(function(e){e.ifActive("emf-109-pdp-expanded-details",!0).then(function(e){e&&e.isActive&&(this.isOpen(!0),this.containerHeight(this.productDetailsMaxHeightOpen))}.bind(this))}.bind(this))}return{viewModel:s}}),define("ProductUtils/OnElementInView",["$","ko"],function(e,t){return this.currentlyInView=null,this.target=null,this.sourceElement=null,this.callback=null,this.timer=null,this.cumulativeOffset=function(e){var t=0,i=0;do t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent;while(e);return{top:t,left:i}},this.checkScrollPosition=function(){var t=!1,i=e(this.sourceElement).outerHeight()+this.target.outerHeight()/2,n=window.innerHeight,r=this.cumulativeOffset(this.target[0]).top+i;(document.body.scrollTop+n>r||document.documentElement.scrollTop+n>r)&&(t=!0),(null===this.currentlyInView||t!==this.currentlyInView)&&(this.currentlyInView=t,this.callback({isInView:t}))},this.onScroll=function(){this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.checkScrollPosition.bind(this),100)},t.bindingHandlers.onElementInView={update:function(i,n){var r=n(),s=t.unwrap(r);this.target=e(s.targetSelector),this.sourceElement=i,this.callback=s.callback;var o=s.enabled;o?(this.checkScrollPosition(),window.addEventListener("scroll",this.onScroll,!1),window.addEventListener("resize",this.onScroll,!1)):(window.removeEventListener("scroll",this.onScroll,!1),window.removeEventListener("resize",this.onScroll,!1))}},this}),define("ProductUtils/Performance",["ko"],function(e){e.bindingHandlers.markAndMeasure={init:function(t,i){var n=e.unwrap(i());window.asos.performance.markAndMeasure(n)}}}),define("Pages/FullProduct",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Utils","Components/product-image/product-image","Components/product-price/product-price","Components/social-share/social-share","Components/content/content","Components/out-of-stock/out-of-stock","Components/size-guide/size-guide","Components/might-like/might-like","Components/buy-the-look/buy-the-look","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/delivery-and-returns/delivery-and-returns","Components/shipping-restrictions/shipping-restrictions","Components/stock-price-retry/stock-price-retry","Components/save-button/save-button","Components/add-item/add-item","Components/payment-promo/payment-promo","Components/side-modal/side-modal","ProductUtils/UrlUtils","ProductUtils/Analytics","Components/fit-analytics/fit-analytics","Components/toast/toast","PageConfig","ProductUtils/OutOfStockAnimator","ProductUtils/NewRelicLogger","ProductUtils/EnhanceNewRelicPageView","Components/delivery-and-returns-content-table/delivery-and-returns-content-table","Components/delivery-and-returns-content-link/delivery-and-returns-content-link","ProductUtils/SchemaOrgTemplate","Components/error-banner/error-banner","Providers/SdkProvider","Components/shipping-restrictions-content/shipping-restrictions-content","Components/delivery-and-returns-content/delivery-and-returns-content","Components/delivery-and-returns-countries/delivery-and-returns-countries","Components/error-container/error-container","Components/product-gallery/product-gallery","Components/product-details/product-details","ProductUtils/ScrollTo","ProductUtils/OnElementInView","ProductUtils/Performance"],function(e,t,i,n,r,s,o,a,c,l,d,u,h,p,m,f,v,g,b,y,S,w,k,_,I,C,P,x,T,A,z,E,M,L,V,D,R){return this.init=function(l){function O(){function t(){T.forEach(function(e){e.style.display="none"})}function n(){A.subscribeToLoadingState(this.state)}function s(e){var t=e?"pg-in-stock":"pg-out-of-stock",i=document.getElementById("asos-product");i.classList.add(t)}function l(){$.register({type:"content",name:"oos-label",elementId:"oos-label",useComponentTemplate:!1},N,this.state);var e=document.getElementById("oos-label");e.style.display="block"}function I(){t(),Z.showStockPriceRetry(!1),s(!1),Z.productData={isInStock:!1},$.register({type:"content",name:"aside-content-oos",elementId:"aside-content-oos",useComponentTemplate:!1},N,this.state),l(),n()}if(!j){var T=[document.getElementById("size-select-skeleton"),document.getElementById("add-to-bag-skeleton"),document.getElementById("save-for-later-skeleton"),document.getElementById("price-skeleton")];if(N.isDeadProduct)I();else{var z=function R(){return B.getStockPrice(N,function(e){s(e.isInStock),Z.productData=(new r).getData(e,!e.isInStock),window.asos.performance.markAndMeasure("pdp:stock_api_returned"),$.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},e,Z),$.register({type:"content",name:"content2",elementId:"lower-content",useComponentTemplate:!1},e,Z),e.hasPaymentPromotionAvailable&&$.register({type:"content",name:"payment-promo-mobile-container",elementId:"payment-promo",useComponentTemplate:!1},e,Z),E(),C.fireProductLoadEvent(e,Z),Z.showStockPriceRetry(!1),Z.productData.isInStock||(n(),l()),V.createAndInsertInToPage(Z,e)}.bind(this),function(e){t(),404!==e.status||N.price&&N.price.currency?Z.showStockPriceRetry(!0):I()}),R}();this.state.retryCallback=z}$.register({type:"content",name:"aside-content-retry",elementId:"aside-content-retry",useComponentTemplate:!1},N,this.state),$.register({type:"product-details",name:"product-details",elementId:"product-details",useComponentTemplate:!1},N,this.state),$.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},N,this.state),e.components.register("product-gallery",m),e.components.register("size-guide",u),e.components.register("product-image",o),e.components.register("shipping-restrictions",b),e.components.register("product-price",a),e.components.register("out-of-stock",d),e.components.register("might-like",h),e.components.register("social-share",c),e.components.register("buy-the-look",p),e.components.register("stock-price-retry",y),e.components.register("product-colour",f),e.components.register("product-size",v),e.components.register("delivery-and-returns",g),e.components.register("delivery-and-returns-content-table",M),e.components.register("delivery-and-returns-content-link",L),e.components.register("asos-video-player-prod",i.videoPlayer),e.components.register("asos-spin-viewer-prod",i.spinViewer),e.components.register("save-button",S),e.components.register("add-item",w),e.components.register("fit-analytics",P),e.components.register("toast",x),e.components.register("payment-promo",k),e.components.register("side-modal",_),e.components.register("error-banner",D),j=!0}}z.init(z.PAGE_TYPE.PRD);var U=window.asos.pdp.config.product,F=window.asos.pdp.config.translations,N="string"==typeof U?JSON.parse(U):U,B=new n,$=new t,W=s.QueryString.getValue("colourWayId")&&parseInt(decodeURIComponent(s.QueryString.getValue("colourWayId")).trim(),10);N||z.logError(new Error(z.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var G=new I,q=G.getVariantFromUrl(window.location.href,N.variants);if(!q&&W&&U.totalNumberOfColours>1&&(U.isOneSize||U.isNoSize))for(var H=0;H<N.variants.length;H++)if(N.variants[H].colourWayId===W){q=N.variants[H];break}this.state={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),resources:F,features:l,gender:N.gender,isInStock:e.observable(!0),showStockPriceRetry:e.observable(!1),defaultVariant:q,showSizeGuide:e.observable(!1),fitAnalyticsViewModel:e.observable(),sellingFast:N.sellingFast,zeekitEnabled:N.zeekit&&N.zeekit.enabled,displayPrice:e.observable(0),CAROUSEL_LOADING_STATE:{NOT_LOADED:0,NO_DATA:1,HAS_DATA:2},submodulesCompleted:{buyTheLook:e.observable(0),recommendations:e.observable(0)},toast:{displayMessage:e.observable(!1),message:e.observable()},errorBanner:{displayError:e.observable(!1),message:e.observable("")},paymentPromotions:N.paymentPromotions,hasPaymentPromotionAvailable:N.hasPaymentPromotionAvailable},this.isMobile="mobile"===T.platform;var j=!1,Z=this.state;this.renderPaymentPromoAbove=e.observable(!1),this.renderPaymentPromoBelow=e.observable(!1),R.getFeatures().then(function(e){N.paymentPromotions.klarnaPI4&&(this.isMobile||e.ifActive("emf-86-web-klarna-us-desktop",!0).then(function(e){e&&"v2-show-promo"===e.variant&&this.renderPaymentPromoAbove(!0)}.bind(this)),this.isMobile&&e.ifActive("emf-56-web-klarna-us-mweb",!0).then(function(e){e&&("v2-show-promo-above"===e.variant?this.renderPaymentPromoAbove(!0):"v3-show-promo-below"===e.variant&&this.renderPaymentPromoBelow(!0))}.bind(this))),(N.paymentPromotions.clearpay||N.paymentPromotions.klarnaPI3)&&(this.isMobile||e.ifActive("emf-85-web-klarna-clearpay-uk-desktop",!0).then(function(e){e&&"v2-show-promo"===e.variant&&this.renderPaymentPromoAbove(!0)}.bind(this)),this.isMobile&&e.ifActive("emf-80-web-klarna-clearpay-uk-mweb",!0).then(function(e){e&&("v2-show-promo-above"===e.variant?this.renderPaymentPromoAbove(!0):"v3-show-promo-below"===e.variant&&this.renderPaymentPromoBelow(!0))}.bind(this)))}.bind(this)),N.paymentPromotions.afterpay&&this.renderPaymentPromoAbove(!0),document.addEventListener("DOMContentLoaded",function(){O.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("lower-content")&&document.getElementById("product-details")&&document.getElementById("gallery-content")&&document.getElementById("oos-label")&&O.call(this)},this.init}),define("text!Components/mix-and-match/mix-and-match.html",[],function(){return'<div class="product-hero">\r\n    <div data-bind=\'component: { name: "delivery-and-returns", params: {state: state, hideDeliveryLink: false}}\'></div>\r\n    <!-- ko if: isMobile -->\r\n        <div class="separator"></div>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<ul>\r\n    <!-- ko foreach: products -->\r\n    <li class="item">\r\n        <a data-bind="click: $parent.isMobile ? $parent.navigateToFullProduct.bind($data, $index()) : $parent.showOverlay.bind($data, $index(), $element)">\r\n            <div class="product-image" data-bind=\'component: {\r\n                name: "product-image",\r\n                params: {\r\n                    imgUrl: productImage.url+"?$S$&wid=75&fit=constrain",\r\n                    hideSaveButton: true\r\n                }\r\n             }\'></div>\r\n        </a>\r\n        <div class="product-info">\r\n            <!--Product title-->\r\n            <a data-bind="click: $parent.isMobile ? $parent.navigateToFullProduct.bind($data, $index()) : $parent.showOverlay.bind($data, $index(), $element)">\r\n                <div class="product-title" data-bind=\'text: name\'></div>\r\n                <div class="product-price" data-bind=\'component: { name: "product-price", params: {state: $parent.getState($index()), hideDeliveryLink: true, showGermanVatMessage: $parent.options.showGermanVatMessage }}\'></div>\r\n            </a>\r\n\r\n            <!-- ko if: $parent.isMobile && state.hasPaymentPromotionAvailable && renderPaymentPromo -->\r\n                <div class="payment-promo mix-and-match-mobile" data-bind=\'component: { name: "payment-promo", params: { state: state, data: { price: ko.observable($parent.getState($index()).productData.minPrice.value) } } }\'></div>\r\n            <!-- /ko -->\r\n\r\n            <!-- ko if: $parent.isMobile -->\r\n            <a data-bind="click: $parent.showOverlay.bind($data, $index(), $element)">\r\n                <div class="product-information"></div>\r\n            </a>\r\n            <!-- /ko -->\r\n            <!-- ko if: $parent.isOutOfStock($index()) -->\r\n            <span class="out-of-stock" data-bind="text: $parent.state.resources.pdp_status_mix_and_match_out_of_stock"></span>\r\n            <!-- /ko -->\r\n            <!-- ko if: !$parent.isOutOfStock($index()) -->\r\n            <div class="product-colour" data-bind=\'component:{\r\n                name: "product-colour",\r\n                params: {\r\n                    hideLabels: false,\r\n                    useShortSelectColourLabel: true,state: $parent.getState($index()),\r\n                    data: $data}\r\n                }\'></div>\r\n            <!-- /ko -->\r\n\r\n        </div>\r\n        <!-- ko if: !$parent.isOutOfStock($index()) -->\r\n        <div data-bind=\'component:{\r\n            name: "product-size",\r\n            params: {\r\n                hideLabels: false,\r\n                hideLowInStock: false,\r\n                hideOnOutOfStock: true,\r\n                showSizeGuide: true,\r\n                isMixMatch: true,\r\n                isMobile: $parent.isMobile,\r\n                doNotSelectDefaultSize: !$parent.isMobile,\r\n                displayOnlyAsDropDown: !$parent.isMobile,\r\n                state: $parent.getState($index()),\r\n                data: $data,\r\n                context: "mixmatch",\r\n                selectorIndex: $index()}\r\n            }\'></div>\r\n        <!-- ko if: $parent.isMobile -->\r\n        <div id="mix-and-match-add-item" data-bind=\'component:{name: "add-item",\r\n                     params:{\r\n                         state: $parent.getState($index()),\r\n                         initiator : "main"\r\n                     }}\'></div>\r\n\r\n        <div id="mix-and-match-save-button" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: [$parent.getState($index())],\r\n                         isMixMatch: true\r\n                     }}\'></div>\r\n        <div class="basic-error-box" data-bind="visible: $parent.getState($index()).showAddToBagError, html: $parent.getState($index()).addToBagErrorMessage" style="display:none">\r\n        </div>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!-- ko if: $parent.isMobile -->\r\n        <div class="separator"></div>\r\n        <!-- /ko -->\r\n\r\n    </li>\r\n    <!-- /ko -->\r\n    <!-- ko if: !isMobile -->\r\n    <li class="item">\r\n        <div class="separator end-of-products"></div>\r\n    </li>\r\n    <li class="total-price-item">\r\n        <div data-bind=\'component: { name: "total-price", params: { variants: variants, state: getState(0), globalState: state } }\'></div>\r\n    </li>\r\n    <li class="item" data-bind="visible : showNoSizesSelectedWarning">\r\n        <div class="error-message" id="selectSizesError" data-bind="html: state.resources.pdp_status_error_mix_and_match_select_product"></div>\r\n    </li>\r\n    <li class="item" data-bind="visible : showAddToBagError">\r\n        <div class="error-message" data-bind="html: addToBagErrorMessage"></div>\r\n    </li>\r\n    <li class="item">\r\n        <div id="mix-and-match-add-items" data-bind=\'component:{name: "add-items",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: state,\r\n                         firstProductState: getState(0),\r\n                         initiator : "main"\r\n                     }}\'></div>\r\n        <div id="mix-and-match-save-button" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: context.States,\r\n                         isMixMatch: true,\r\n                         productName: $parent.product.name\r\n                     }}\'></div>\r\n    </li>\r\n    <!-- /ko -->\r\n</ul>\r\n'}),define("Components/mix-and-match/mix-and-match",["ko","text!./mix-and-match.html","ProductUtils/ModalWindow","ProductUtils/Analytics","ProductUtils/UrlUtils","PageConfig"],function(e,t,i,n,r,s){function o(e){this.context=e.data,this.products=e.data.products,this.state=e.state,this.options=e.options,this.isMobile="mobile"===s.platform,this.showNoSizesSelectedWarning=e.state.showNoSizesSelectedWarning,this.showAddToBagError=e.state.showAddToBagError,this.addToBagErrorMessage=this.state.addToBagErrorMessage,this.variants=[],this.hasPaymentPromotionAvailable=e.data.hasPaymentPromotionAvailable;for(var t=new r,o=this.products.length;o--;)this.variants.push(this.context.States[o].selectedSize);this.getState=function(e){return this.context.States[e]}.bind(this),this.isOutOfStock=function(e){return!this.getState(e).productData.isInStock}.bind(this),this.showOverlay=function(t,r){n.firePageInteraction({context:"openModal",modalType:"mixAndMatch",productIID:this.products[t].id});var s=new i;this.isMobile&&s.setTitle(this.state.resources.pdp_description_product_information_title),s.addComponent("mix-and-match-product",{productId:this.products[t].id,playerParams:e.playerParams},this.state),s.setClass("mix-and-match-overlay"),s.open({showSpinner:!0,openerElement:r})}.bind(this),this.getProductLink=function(e){var i=t.getProductUrl(e.name,this.context.brandName,e.id);return i+this.getQueryString()}.bind(this),this.navigateToFullProduct=function(e){var t=this.getProductLink(this.products[e]);this.navigateTo(t)}.bind(this),this.navigateTo=function(e){window.location=e},this.getQueryString=function(){return document.location.search}}return{viewModel:o,template:t}}),define("text!Components/total-price/total-price.html",[],function(){return'<h4 class="number-of-items" data-bind="text: selectedItemsText"></h4><h4 class="total-price" data-bind="text: totalPrice"></h4>\r\n<!-- ko if : globalState.hasPaymentPromotionAvailable && renderPaymentPromo -->\r\n    <div class="payment-promo mix-and-match-desktop" data-bind=\'component: { name: "payment-promo", params: { state: globalState, data: { price: totalPriceValue } } }\'></div>\r\n<!-- /ko -->'}),define("Components/total-price/total-price",["ko","text!./total-price.html","Asos.Web.Currency.Formatter","PageConfig","Providers/SdkProvider"],function(e,t,i,n,r){function s(t){var s=t.variants;this.state=t.state,this.globalState=t.globalState,this.selectedItemsText=e.observable(""),this.totalPriceValue=e.observable(0),this.totalPrice=e.computed(function(){for(var e=s.length,r=0,o=0;e--;){var a=s[e]();a&&(r+=a.price.current.value,o++)}return this.totalPriceValue(r),this.selectedItemsText(t.state.resources.pdp_status_number_of_selected_items.replace("%{count}",o)),i.formatPrice(this.totalPriceValue().toFixed(2),n.language,n.currency)}.bind(this)),this.renderPaymentPromo=e.observable(!1),r.getFeatures().then(function(e){this.globalState.paymentPromotions.klarnaPI4&&e.ifActive("emf-86-web-klarna-us-desktop",!0).then(function(e){e&&"v2-show-promo"===e.variant&&this.renderPaymentPromo(!0)}.bind(this)),(this.globalState.paymentPromotions.clearpay||this.globalState.paymentPromotions.klarnaPI3)&&e.ifActive("emf-85-web-klarna-clearpay-uk-desktop",!0).then(function(e){e&&"v2-show-promo"===e.variant&&this.renderPaymentPromo(!0)}.bind(this))}.bind(this)),this.globalState.paymentPromotions.afterpay&&this.renderPaymentPromo(!0)}return{viewModel:s,template:t}}),define("text!Components/mix-and-match-product/mix-and-match-product.html",[],function(){return'<!-- ko if: product() != undefined -->\r\n\r\n<div>\r\n\r\n    <section>\r\n        <div class="layout-width">\r\n            <!-- ko if: !isMobile -->\r\n            <div id="gallery-content" data-bind="visible: !isMobile">\r\n                <div class="product-gallery" data-bind=\'component: { name: "product-gallery", params: {state: state,  data: { rootElement: $element, id: product().id, images: product().media.images, map: {}, defaultColour: product().defaultColour, media: product().media, playerParams: playerParams  }}}\'></div>\r\n            </div>\r\n            <!-- /ko -->\r\n\r\n            <div class="layout-aside" id="aside-content">\r\n                <!-- ko if: !state.productData.isInStock -->\r\n                    <h3 class="product-out-of-stock-label" data-bind="text: state.resources.pdp_status_mix_and_match_out_of_stock"></h3>\r\n                <!-- /ko -->\r\n                <!-- ko if: !isMobile -->\r\n                <h1 class="product-hero" data-bind="text: product().name"></h1>\r\n                <div class="product-price" id="product-price" data-bind=\'component: { name: "product-price", params: {state: state}}\'></div>\r\n                <div id="product-colour" data-bind=\'component:{\r\n                            name: "product-colour",\r\n                            params: {\r\n                                hideLabels: false,\r\n                                useShortSelectColourLabel: false,\r\n                                state: state,\r\n                                data: product(),\r\n                                hideOnOutOfStock : true}\r\n                            }\'></div>\r\n                <!-- /ko -->\r\n\r\n                <!-- ko if: state.productData.isInStock -->\r\n                <div class="product-details" id="product-details">\r\n                    <div class="product-description" data-bind="visible: info().productDetailsVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_product_details_title"></h2>\r\n                        <p data-bind="html: info().productDetails"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().sizeAndFitVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_size_and_fit_title"></h2>\r\n                        <p data-bind="html: info().sizeAndFit"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().careInfoVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_care_info_title"></h2>\r\n                        <p data-bind="html: info().careInfo"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().aboutMeVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_about_me_title"></h2>\r\n                        <p data-bind="html: info().aboutMe"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().brandDescriptionVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_brand_title"></h2>\r\n                        <p data-bind="html: info().brandDescription"></p>\r\n                    </div>\r\n                    <div class="product-description">\r\n                        <h2 data-bind="text: state.resources.pdp_description_product_code_title"></h2>\r\n                        <p data-bind="html: info().productCode"></p>\r\n                    </div>\r\n                </div>\r\n                <!-- /ko -->\r\n                <!-- ko if: !state.productData.isInStock -->\r\n                    <p class="product-code">\r\n                        <span class="label" data-bind="text: state.resources.pdp_description_product_code_title"></span>\r\n                        <span data-bind="text:info().productCode"></span>\r\n                    </p>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n    </section>\r\n\r\n    <a class="product-page-button" data-bind="attr: { href: productLink}, text: state.resources.pdp_mix_and_match_modal_go_to_product"></a>\r\n</div>\r\n\r\n<!-- /ko  -->\r\n'}),define("Models/ProductDescription",[],function(){function e(){this.productDetails="",this.productDetailsVisible=!1,this.sizeAndFit="",this.sizeAndFitVisible=!1,this.careInfo="",this.careInfoVisible=!1,this.aboutMe="",this.aboutMeVisible=!1,this.brandDescription="",this.brandDescriptionVisible=!1,this.productCode=""}return function(){this.getProductDescriptionViewModel=function(t){var i=new e;t.description&&(i.productDetails=t.description,i.productDetailsVisible=!0);var n=t.info;return n&&(n.sizeAndFit&&(i.sizeAndFit=n.sizeAndFit,i.sizeAndFitVisible=!0),n.careInfo&&(i.careInfo=n.careInfo,i.careInfoVisible=!0),n.aboutMe&&(i.aboutMe=n.aboutMe,i.aboutMeVisible=!0)),t.brand&&t.brand.description&&(i.brandDescription=t.brand.description,i.brandDescriptionVisible=!0),i.productCode=t.productCode,i}}}),define("Components/mix-and-match-product/mix-and-match-product",["ko","text!./mix-and-match-product.html","ProductUtils/FullProductApiClient","Models/VariantDecorator","Models/ProductDescription","$","PageConfig","ProductUtils/UrlUtils"],function(e,t,i,n,r,s,o,a){function c(t){var s=new i;this.urlUtils=new a,this.product=e.observable(),this.info=e.observable(),this.isMobile="mobile"===o.platform,this.playerParams=t.data.playerParams,this.dataReceived=t.data.loadedCallback,this.productLink=e.observable(),this.state={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),resources:t.state.resources},s.getFullProduct(t.data.productId,!1,"MixAndMatch").done(function(e){this.state.productData=(new n).getData(e,!0);var t=new r;this.info(t.getProductDescriptionViewModel(e)),this.product(e),this.productLink(this.urlUtils.getProductUrl(e.name,e.brand.name,e.id)),this.dataReceived()}.bind(this))}return{viewModel:c,template:t}}),define("text!Components/add-items/add-items.html",[],function(){return'<div class="add-items">\r\n    <div class="is-add-items-saving" data-bind="visible: isBusy"></div>\r\n    <span class="aria-live" aria-live="polite" aria-role="status" data-bind="{ text: ariaLiveText, attr: { \'aria-label\': ariaLiveText }}"></span>\r\n    <a href="#" class="add-button" data-bind="click: addToBag, css : { \'is-disabled\' : isBusy }, attr: { \'aria-label\': resources.pdp_cta_add_to_bag }, markAndMeasure: \'pdp:add_to_bag_interactive\'">\r\n        <span class="product-tick" data-bind="visible: addedToBag, text: iconText"></span>\r\n        <span data-bind="text: buttonText"></span>\r\n    </a>\r\n</div>';
}),define("Components/add-items/add-items",["ko","text!./add-items.html","ProductUtils/Bag","ProductUtils/ScrollTo","$"],function(e,t,i,n,r){function s(t){this.variants=t.variants,this.resources=t.state.resources,this.addedToBag=e.observable(!1),this.productState=t.firstProductState,this.topOfPage=r("#top-of-page"),this.showNoSizesSelectedWarning=t.state.showNoSizesSelectedWarning,this.showAddToBagError=t.state.showAddToBagError,this.addToBagErrorMessage=t.state.addToBagErrorMessage,this.moreThanOneProductSelected=e.observable(!1),this.buttonText=e.observable(""),this.isBusy=e.observable(!1),this.ariaLiveText=e.computed(function(){var e=this.addToBagErrorMessage();return e?e:this.addedToBag()?this.resources.pdp_status_add_to_bag_success:""},this),this.iconText=e.computed(function(){return this.addedToBag()?"added to basket":"add to basket"}.bind(this)),this.setButtonTextAdd=function(){this.moreThanOneProductSelected()?this.buttonText(this.resources.pdp_cta_mix_and_match_add_items):this.buttonText(this.resources.pdp_cta_mix_and_match_add_item)}.bind(this),this.setButtonTextAdded=function(){this.moreThanOneProductSelected()?this.buttonText(this.resources.pdp_status_mix_and_match_add_items_success):this.buttonText(this.resources.pdp_status_mix_and_match_add_item_success)}.bind(this),this.selectedVariants=e.computed(function(){for(var e=this.variants.length,t=[];e--;){var i=this.variants[e]();i&&t.push(i)}return this.showNoSizesSelectedWarning(!1),this.moreThanOneProductSelected(t.length>1),this.setButtonTextAdd(),this.addedToBag(!1),t}.bind(this));var s=new i(t,t.initiator);this.addToBag=function(){return this.isBusy()?!1:(this.revertState(),void(0===this.selectedVariants().length?(this.showNoSizesSelectedWarning(!0),this.productState.showNoSizeSelectedWarning(!0)):(this.isBusy(!0),s.addItems(this.selectedVariants(),this.addToBagResult))))}.bind(this);var o;this.addToBagResult=function(e){this.isBusy(!1),this.addedToBag(e.success),e.success?(this.setButtonTextAdded(),n.scrollToElement(this.topOfPage),o&&window.clearTimeout(o),o=setTimeout(this.revertState,5e3)):(this.showAddToBagError(!0),this.addToBagErrorMessage(e.error))}.bind(this),this.revertState=function(){this.setButtonTextAdd(),this.addedToBag(!1),this.showAddToBagError(!1),this.addToBagErrorMessage(""),this.isBusy(!1)}.bind(this)}return{viewModel:s,template:t}}),define("Pages/MixAndMatch",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Utils","Components/product-image/product-image","Components/product-price/product-price","Components/add-item/add-item","Components/payment-promo/payment-promo","Components/social-share/social-share","Components/content/content","Components/out-of-stock/out-of-stock","Components/size-guide/size-guide","Components/side-modal/side-modal","Components/might-like/might-like","Components/buy-the-look/buy-the-look","Components/mix-and-match/mix-and-match","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/total-price/total-price","Components/delivery-and-returns/delivery-and-returns","Components/delivery-and-returns-content-table/delivery-and-returns-content-table","Components/delivery-and-returns-content-link/delivery-and-returns-content-link","Components/stock-price-retry/stock-price-retry","Components/mix-and-match-product/mix-and-match-product","Components/save-button/save-button","Components/add-items/add-items","Components/add-item/add-item","ProductUtils/Analytics","Components/toast/toast","PageConfig","ProductUtils/NewRelicLogger","ProductUtils/EnhanceNewRelicPageView","Providers/SdkProvider","Components/product-details/product-details","ProductUtils/ScrollTo","ProductUtils/Performance"],function(e,t,i,n,r,s,o,a,c,l,d,u,h,p,m,f,v,g,b,y,S,w,k,_,I,C,P,x,T,A,z,E,M,L,V,D){return this.init=function(c){function u(){if(!N){var t=function n(){return U.getStockPrice(O,function(t){window.asos.performance.markAndMeasure("pdp:stock_api_returned"),V(),z.fireMixMatchLoadEvent(t);for(var i=0;i<t.products.length;i++){var n={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),productImage:t.products[i].productImage.url,resources:v,features:c,session:P.session};n.productData=(new r).getData(t.products[i],!0),F.push(n)}O.States=F,R.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},O,P),R.register({type:"content",name:"content2",elementId:"lower-content",useComponentTemplate:!1},O,P),R.register({type:"content",name:"mix-and-match-name",elementId:"mix-and-match-name",useComponentTemplate:!1},O,P),P.showStockPriceRetry(!1)}.bind(this),function(e){404===e.status?(P.showStockPriceRetry(!1),P.productData={isInStock:!1},O.categories=[],R.register({type:"content",name:"aside-content-oos",elementId:"aside-content-oos",useComponentTemplate:!1},O,P)):P.showStockPriceRetry(!0)}),n}();this.state.retryCallback=t,R.register({type:"content",name:"aside-content-retry",elementId:"aside-content-retry",useComponentTemplate:!1},O,this.state),R.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},O,this.state),e.components.register("out-of-stock",h),e.components.register("stock-price-retry",C),e.components.register("product-gallery",b),e.components.register("size-guide",p),e.components.register("product-image",o),e.components.register("product-colour",y),e.components.register("product-size",S),e.components.register("product-price",a),e.components.register("social-share",d),e.components.register("mix-and-match",g),e.components.register("total-price",w),e.components.register("delivery-and-returns",k),e.components.register("delivery-and-returns-content-table",_),e.components.register("delivery-and-returns-content-link",I),e.components.register("asos-video-player-prod",i.videoPlayer),e.components.register("asos-spin-viewer-prod",i.spinViewer),e.components.register("save-button",x),e.components.register("add-items",T),e.components.register("add-item",A),e.components.register("toast",E),e.components.register("payment-promo",l),e.components.register("side-modal",m),N=!0}}L.init(L.PAGE_TYPE.GRP);var f=window.asos.pdp.config.product,v=window.asos.pdp.config.translations;this.state={resources:v,features:c,selectedColour:e.observable(),showNoSizesSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),showStockPriceRetry:e.observable(!1),toast:{displayMessage:e.observable(!1),message:e.observable()},CAROUSEL_LOADING_STATE:{NOT_LOADED:0,NO_DATA:1,HAS_DATA:2},submodulesCompleted:{buyTheLook:e.observable(0),recommendations:e.observable(0)},paymentPromotions:f.paymentPromotions,hasPaymentPromotionAvailable:f.hasPaymentPromotionAvailable},this.isMobile="mobile"===M.platform,this.useProductIdForVideos=!0;var P=this.state,R=new t,O="string"==typeof f?JSON.parse(f):f;O||L.logError(new Error(L.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var U=new n,F=[];O.defaultProductId=parseInt(s.QueryString.getValue("iid")||0);var N=!1;document.addEventListener("DOMContentLoaded",function(){u.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("lower-content")&&document.getElementById("gallery-content")&&u.call(this),this.renderPaymentPromo=e.observable(!1),D.getFeatures().then(function(e){f.paymentPromotions.klarnaPI4&&this.isMobile&&e.ifActive("emf-56-web-klarna-us-mweb",!0).then(function(e){e&&"v2-show-promo-above"===e.variant&&this.renderPaymentPromo(!0)}.bind(this)),(f.paymentPromotions.clearpay||f.paymentPromotions.klarnaPI3)&&this.isMobile&&e.ifActive("emf-80-web-klarna-clearpay-uk-mweb",!0).then(function(e){e&&"v2-show-promo-above"===e.variant&&this.renderPaymentPromo(!0)}.bind(this))}.bind(this)),f.paymentPromotions.afterpay&&this.renderPaymentPromo(!0)},this.init}),define("main",["Pages/FullProduct","Pages/MixAndMatch"],function(){});
//# sourceMappingURL=Asos.Product.Page.Web.js.map